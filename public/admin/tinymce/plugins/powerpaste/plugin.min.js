/* Tiny PowerPaste plugin
 *
 * Copyright 2010-2019 Tiny Technologies LLC. All rights reserved.
 *
 * Version: 5.0.0-345
 */

!function(l) {
    "use strict";
    var n = function(t) {
        return parseInt(t, 10)
    }
      , r = function(t, e, n) {
        return {
            major: t,
            minor: e,
            patch: n
        }
    }
      , o = function(t) {
        var e = /([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(t);
        return e ? r(n(e[1]), n(e[2]), n(e[3])) : r(0, 0, 0)
    }
      , i = function(t, e) {
        var n = t - e;
        return 0 === n ? 0 : 0 < n ? 1 : -1
    }
      , c = function(t, e) {
        return !!t && -1 === function(t, e) {
            var n = i(t.major, e.major);
            if (0 !== n)
                return n;
            var r = i(t.minor, e.minor);
            if (0 !== r)
                return r;
            var o = i(t.patch, e.patch);
            return 0 !== o ? o : 0
        }(o([(n = t).majorVersion, n.minorVersion].join(".").split(".").slice(0, 3).join(".")), o(e));
        var n
    }
      , t = function(r, o) {
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            var n = r.console;
            n && o in n && n[o].apply(n, arguments)
        }
    }
      , e = {
        log: t(window, "log"),
        error: t(window, "error"),
        warn: t(window, "warm")
    }
      , s = {
        register: function(t, e) {
            t.addCommand("mceTogglePlainTextPaste", e.toggle)
        }
    }
      , f = function(t) {
        return t.getParam("powerpaste_block_drop", !1, "boolean")
    }
      , a = function(t) {
        return void 0 !== t.settings.images_upload_url
    }
      , d = function(t) {
        return t.getParam("paste_as_text", !1)
    }
      , u = function(t, e) {
        t.dom.bind(e, "drop dragstart dragend dragover dragenter dragleave dragdrop draggesture", function(t) {
            t.preventDefault(),
            t.stopImmediatePropagation()
        })
    }
      , m = function(e) {
        e.on("init", function(t) {
            u(e, e.getBody()),
            e.inline || u(e, e.getDoc())
        })
    }
      , L = function() {
        for (var t = [], e = 0; e < arguments.length; e++)
            t[e] = arguments[e]
    }
      , g = function(n, r) {
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return n(r.apply(null, t))
        }
    }
      , v = function(t) {
        return function() {
            return t
        }
    }
      , p = function(t) {
        return t
    };
    function y(r) {
        for (var o = [], t = 1; t < arguments.length; t++)
            o[t - 1] = arguments[t];
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            var n = o.concat(t);
            return r.apply(null, n)
        }
    }
    var h, b, x, T, E, w = function(n) {
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return !n.apply(null, t)
        }
    }, I = function(t) {
        return function() {
            throw new Error(t)
        }
    }, S = v(!1), _ = v(!0), N = S, C = _, O = function() {
        return D
    }, D = (T = {
        fold: function(t, e) {
            return t()
        },
        is: N,
        isSome: N,
        isNone: C,
        getOr: x = function(t) {
            return t
        }
        ,
        getOrThunk: b = function(t) {
            return t()
        }
        ,
        getOrDie: function(t) {
            throw new Error(t || "error: getOrDie called on none.")
        },
        getOrNull: function() {
            return null
        },
        getOrUndefined: function() {},
        or: x,
        orThunk: b,
        map: O,
        ap: O,
        each: function() {},
        bind: O,
        flatten: O,
        exists: N,
        forall: C,
        filter: O,
        equals: h = function(t) {
            return t.isNone()
        }
        ,
        equals_: h,
        toArray: function() {
            return []
        },
        toString: v("none()")
    },
    Object.freeze && Object.freeze(T),
    T), A = function(n) {
        var t = function() {
            return n
        }
          , e = function() {
            return o
        }
          , r = function(t) {
            return t(n)
        }
          , o = {
            fold: function(t, e) {
                return e(n)
            },
            is: function(t) {
                return n === t
            },
            isSome: C,
            isNone: N,
            getOr: t,
            getOrThunk: t,
            getOrDie: t,
            getOrNull: t,
            getOrUndefined: t,
            or: e,
            orThunk: e,
            map: function(t) {
                return A(t(n))
            },
            ap: function(t) {
                return t.fold(O, function(t) {
                    return A(t(n))
                })
            },
            each: function(t) {
                t(n)
            },
            bind: r,
            flatten: t,
            exists: r,
            forall: r,
            filter: function(t) {
                return t(n) ? o : D
            },
            equals: function(t) {
                return t.is(n)
            },
            equals_: function(t, e) {
                return t.fold(N, function(t) {
                    return e(n, t)
                })
            },
            toArray: function() {
                return [n]
            },
            toString: function() {
                return "some(" + n + ")"
            }
        };
        return o
    }, P = {
        some: A,
        none: O,
        from: function(t) {
            return null == t ? D : A(t)
        }
    }, k = function(e) {
        return function(t) {
            return function(t) {
                if (null === t)
                    return "null";
                var e = typeof t;
                return "object" === e && Array.prototype.isPrototypeOf(t) ? "array" : "object" === e && String.prototype.isPrototypeOf(t) ? "string" : e
            }(t) === e
        }
    }, M = k("string"), R = k("object"), F = k("array"), j = k("boolean"), U = k("function"), B = k("number"), Y = void 0 === (E = Array.prototype.indexOf) ? function(t, e) {
        return K(t, e)
    }
    : function(t, e) {
        return E.call(t, e)
    }
    , W = function(t, e) {
        return -1 < Y(t, e)
    }, H = function(t, e) {
        return z(t, e).isSome()
    }, q = function(t, e) {
        for (var n = t.length, r = new Array(n), o = 0; o < n; o++) {
            var i = t[o];
            r[o] = e(i, o, t)
        }
        return r
    }, $ = function(t, e) {
        for (var n = 0, r = t.length; n < r; n++)
            e(t[n], n, t)
    }, V = function(t, e) {
        for (var n = [], r = 0, o = t.length; r < o; r++) {
            var i = t[r];
            e(i, r, t) && n.push(i)
        }
        return n
    }, X = function(t, e, n) {
        return $(t, function(t) {
            n = e(n, t)
        }),
        n
    }, G = function(t, e) {
        for (var n = 0, r = t.length; n < r; n++) {
            var o = t[n];
            if (e(o, n, t))
                return P.some(o)
        }
        return P.none()
    }, z = function(t, e) {
        for (var n = 0, r = t.length; n < r; n++)
            if (e(t[n], n, t))
                return P.some(n);
        return P.none()
    }, K = function(t, e) {
        for (var n = 0, r = t.length; n < r; ++n)
            if (t[n] === e)
                return n;
        return -1
    }, Z = Array.prototype.push, J = function(t) {
        for (var e = [], n = 0, r = t.length; n < r; ++n) {
            if (!Array.prototype.isPrototypeOf(t[n]))
                throw new Error("Arr.flatten item " + n + " was not an array, input: " + t);
            Z.apply(e, t[n])
        }
        return e
    }, Q = function(t, e) {
        var n = q(t, e);
        return J(n)
    }, tt = function(t, e) {
        for (var n = 0, r = t.length; n < r; ++n)
            if (!0 !== e(t[n], n, t))
                return !1;
        return !0
    }, et = Array.prototype.slice, nt = function(t) {
        var e = et.call(t, 0);
        return e.reverse(),
        e
    }, rt = function(t) {
        return 0 === t.length ? P.none() : P.some(t[0])
    }, ot = (U(Array.from) && Array.from,
    Object.keys), it = function(t, e) {
        for (var n = ot(t), r = 0, o = n.length; r < o; r++) {
            var i = n[r];
            e(t[i], i, t)
        }
    }, at = function(t, r) {
        return ut(t, function(t, e, n) {
            return {
                k: e,
                v: r(t, e, n)
            }
        })
    }, ut = function(r, o) {
        var i = {};
        return it(r, function(t, e) {
            var n = o(t, e, r);
            i[n.k] = n.v
        }),
        i
    }, ct = function(t) {
        return n = function(t) {
            return t
        }
        ,
        r = [],
        it(t, function(t, e) {
            r.push(n(t, e))
        }),
        r;
        var n, r
    }, st = function(t) {
        return ot(t).length
    }, ft = function(a) {
        if (!F(a))
            throw new Error("cases must be an array");
        if (0 === a.length)
            throw new Error("there must be at least one case");
        var u = []
          , n = {};
        return $(a, function(t, r) {
            var e = ot(t);
            if (1 !== e.length)
                throw new Error("one and only one name per case");
            var o = e[0]
              , i = t[o];
            if (void 0 !== n[o])
                throw new Error("duplicate key detected:" + o);
            if ("cata" === o)
                throw new Error("cannot have a case named cata (sorry)");
            if (!F(i))
                throw new Error("case arguments must be an array");
            u.push(o),
            n[o] = function() {
                var t = arguments.length;
                if (t !== i.length)
                    throw new Error("Wrong number of arguments to case " + o + ". Expected " + i.length + " (" + i + "), got " + t);
                for (var n = new Array(t), e = 0; e < n.length; e++)
                    n[e] = arguments[e];
                return {
                    fold: function() {
                        if (arguments.length !== a.length)
                            throw new Error("Wrong number of arguments to fold. Expected " + a.length + ", got " + arguments.length);
                        return arguments[r].apply(null, n)
                    },
                    match: function(t) {
                        var e = ot(t);
                        if (u.length !== e.length)
                            throw new Error("Wrong number of arguments to match. Expected: " + u.join(",") + "\nActual: " + e.join(","));
                        if (!tt(u, function(t) {
                            return W(e, t)
                        }))
                            throw new Error("Not all branches were specified when using match. Specified: " + e.join(", ") + "\nRequired: " + u.join(", "));
                        return t[o].apply(null, n)
                    },
                    log: function(t) {
                        l.console.log(t, {
                            constructors: u,
                            constructor: o,
                            params: n
                        })
                    }
                }
            }
        }),
        n
    }, lt = Object.prototype.hasOwnProperty, dt = function(a) {
        return function() {
            for (var t = new Array(arguments.length), e = 0; e < t.length; e++)
                t[e] = arguments[e];
            if (0 === t.length)
                throw new Error("Can't merge zero objects");
            for (var n = {}, r = 0; r < t.length; r++) {
                var o = t[r];
                for (var i in o)
                    lt.call(o, i) && (n[i] = a(n[i], o[i]))
            }
            return n
        }
    }, mt = dt(function(t, e) {
        return R(t) && R(e) ? mt(t, e) : e
    }), pt = dt(function(t, e) {
        return e
    }), gt = ft([{
        blob: ["id", "imageresult", "objurl"]
    }, {
        url: ["id", "url", "raw"]
    }]), vt = pt(gt, {
        cata: function(t, e, n) {
            return t.fold(e, n)
        }
    }), ht = void 0 !== l.window ? l.window : Function("return this;")(), yt = function(t, e) {
        return function(t, e) {
            for (var n = null != e ? e : ht, r = 0; r < t.length && null != n; ++r)
                n = n[t[r]];
            return n
        }(t.split("."), e)
    }, bt = function(t, e) {
        return function(t, e) {
            for (var n, r, o = void 0 !== e ? e : ht, i = 0; i < t.length; ++i)
                n = o,
                r = t[i],
                void 0 !== n[r] && null !== n[r] || (n[r] = {}),
                o = n[r];
            return o
        }(t.split("."), e)
    }, xt = {
        getOrDie: function(t, e) {
            var n = yt(t, e);
            if (null == n)
                throw t + " not available on this browser";
            return n
        }
    };
    function Tt(t, e) {
        return new (xt.getOrDie("Blob"))(t,e)
    }
    function Et() {
        return new (xt.getOrDie("FileReader"))
    }
    function wt(t) {
        return new (xt.getOrDie("Uint8Array"))(t)
    }
    var It = {
        atob: function(t) {
            return xt.getOrDie("atob")(t)
        },
        requestAnimationFrame: function(t) {
            xt.getOrDie("requestAnimationFrame")(t)
        }
    };
    function St(t, e) {
        return n = l.document.createElement("canvas"),
        r = t,
        o = e,
        n.width = r,
        n.height = o,
        n;
        var n, r, o
    }
    function Lt(t) {
        var e = St(t.width, t.height);
        return _t(e).drawImage(t, 0, 0),
        e
    }
    function _t(t) {
        return t.getContext("2d")
    }
    var Nt = window.Promise ? window.Promise : function() {
        var i = function(t) {
            if ("object" != typeof this)
                throw new TypeError("Promises must be constructed via new");
            if ("function" != typeof t)
                throw new TypeError("not a function");
            this._state = null,
            this._value = null,
            this._deferreds = [],
            f(t, n(o, this), n(u, this))
        }
          , t = i.immediateFn || "function" == typeof window.setImmediate && window.setImmediate || function(t) {
            l.setTimeout(t, 1)
        }
        ;
        function n(t, e) {
            return function() {
                return t.apply(e, arguments)
            }
        }
        var r = Array.isArray || function(t) {
            return "[object Array]" === Object.prototype.toString.call(t)
        }
        ;
        function a(n) {
            var r = this;
            null !== this._state ? t(function() {
                var t = r._state ? n.onFulfilled : n.onRejected;
                if (null !== t) {
                    var e;
                    try {
                        e = t(r._value)
                    } catch (t) {
                        return void n.reject(t)
                    }
                    n.resolve(e)
                } else
                    (r._state ? n.resolve : n.reject)(r._value)
            }) : this._deferreds.push(n)
        }
        function o(t) {
            try {
                if (t === this)
                    throw new TypeError("A promise cannot be resolved with itself.");
                if (t && ("object" == typeof t || "function" == typeof t)) {
                    var e = t.then;
                    if ("function" == typeof e)
                        return void f(n(e, t), n(o, this), n(u, this))
                }
                this._state = !0,
                this._value = t,
                c.call(this)
            } catch (t) {
                u.call(this, t)
            }
        }
        function u(t) {
            this._state = !1,
            this._value = t,
            c.call(this)
        }
        function c() {
            for (var t = 0, e = this._deferreds; t < e.length; t++) {
                var n = e[t];
                a.call(this, n)
            }
            this._deferreds = []
        }
        function s(t, e, n, r) {
            this.onFulfilled = "function" == typeof t ? t : null,
            this.onRejected = "function" == typeof e ? e : null,
            this.resolve = n,
            this.reject = r
        }
        function f(t, e, n) {
            var r = !1;
            try {
                t(function(t) {
                    r || (r = !0,
                    e(t))
                }, function(t) {
                    r || (r = !0,
                    n(t))
                })
            } catch (t) {
                if (r)
                    return;
                r = !0,
                n(t)
            }
        }
        return i.prototype.catch = function(t) {
            return this.then(null, t)
        }
        ,
        i.prototype.then = function(n, r) {
            var o = this;
            return new i(function(t, e) {
                a.call(o, new s(n,r,t,e))
            }
            )
        }
        ,
        i.all = function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            var u = Array.prototype.slice.call(1 === t.length && r(t[0]) ? t[0] : t);
            return new i(function(r, o) {
                if (0 === u.length)
                    return r([]);
                var i = u.length;
                function a(e, t) {
                    try {
                        if (t && ("object" == typeof t || "function" == typeof t)) {
                            var n = t.then;
                            if ("function" == typeof n)
                                return void n.call(t, function(t) {
                                    a(e, t)
                                }, o)
                        }
                        u[e] = t,
                        0 == --i && r(u)
                    } catch (t) {
                        o(t)
                    }
                }
                for (var t = 0; t < u.length; t++)
                    a(t, u[t])
            }
            )
        }
        ,
        i.resolve = function(e) {
            return e && "object" == typeof e && e.constructor === i ? e : new i(function(t) {
                t(e)
            }
            )
        }
        ,
        i.reject = function(n) {
            return new i(function(t, e) {
                e(n)
            }
            )
        }
        ,
        i.race = function(o) {
            return new i(function(t, e) {
                for (var n = 0, r = o; n < r.length; n++)
                    r[n].then(t, e)
            }
            )
        }
        ,
        i
    }();
    function Ct(r) {
        return new Nt(function(t, n) {
            var e = new l.XMLHttpRequest;
            e.open("GET", r, !0),
            e.responseType = "blob",
            e.onload = function() {
                200 === this.status && t(this.response)
            }
            ,
            e.onerror = function() {
                var t, e = this;
                n(0 === this.status ? ((t = new Error("No access to download image")).code = 18,
                t.name = "SecurityError",
                t) : new Error("Error " + e.status + " downloading image"))
            }
            ,
            e.send()
        }
        )
    }
    function Ot(t) {
        var e = t.split(",")
          , n = /data:([^;]+)/.exec(e[0]);
        if (!n)
            return P.none();
        for (var r = n[1], o = e[1], i = It.atob(o), a = i.length, u = Math.ceil(a / 1024), c = new Array(u), s = 0; s < u; ++s) {
            for (var f = 1024 * s, l = Math.min(f + 1024, a), d = new Array(l - f), m = f, p = 0; m < l; ++p,
            ++m)
                d[p] = i[m].charCodeAt(0);
            c[s] = wt(d)
        }
        return P.some(Tt(c, {
            type: r
        }))
    }
    function Dt(n) {
        return new Nt(function(t, e) {
            Ot(n).fold(function() {
                e("uri is not base64: " + n)
            }, t)
        }
        )
    }
    function At(t, r, o) {
        return r = r || "image/png",
        l.HTMLCanvasElement.prototype.toBlob ? new Nt(function(e, n) {
            t.toBlob(function(t) {
                t ? e(t) : n()
            }, r, o)
        }
        ) : Dt(t.toDataURL(r, o))
    }
    function Pt(t) {
        return (u = t,
        new Nt(function(t, e) {
            var n = l.URL.createObjectURL(u)
              , r = new l.Image
              , o = function() {
                r.removeEventListener("load", i),
                r.removeEventListener("error", a)
            };
            function i() {
                o(),
                t(r)
            }
            function a() {
                o(),
                e("Unable to load data of type " + u.type + ": " + n)
            }
            r.addEventListener("load", i),
            r.addEventListener("error", a),
            r.src = n,
            r.complete && i()
        }
        )).then(function(t) {
            var e;
            e = t,
            l.URL.revokeObjectURL(e.src);
            var n, r, o = St((r = t).naturalWidth || r.width, (n = t).naturalHeight || n.height);
            return _t(o).drawImage(t, 0, 0),
            o
        });
        var u
    }
    function kt(n) {
        return new Nt(function(t) {
            var e = Et();
            e.onloadend = function() {
                t(e.result)
            }
            ,
            e.readAsDataURL(n)
        }
        )
    }
    var Mt = function(t) {
        return P.from(0 === (e = t).indexOf("blob:") ? Ct(e) : 0 === e.indexOf("data:") ? Dt(e) : null);
        var e
    };
    function Rt(t, e, n) {
        var r = e.type;
        function o(r, o) {
            return t.then(function(t) {
                return n = o,
                e = (e = r) || "image/png",
                t.toDataURL(e, n);
                var e, n
            })
        }
        return {
            getType: v(r),
            toBlob: function() {
                return Nt.resolve(e)
            },
            toDataURL: function() {
                return n
            },
            toBase64: function() {
                return n.split(",")[1]
            },
            toAdjustedBlob: function(e, n) {
                return t.then(function(t) {
                    return At(t, e, n)
                })
            },
            toAdjustedDataURL: o,
            toAdjustedBase64: function(t, e) {
                return o(t, e).then(function(t) {
                    return t.split(",")[1]
                })
            },
            toCanvas: function() {
                return t.then(Lt)
            }
        }
    }
    function Ft(e) {
        return kt(e).then(function(t) {
            return Rt(Pt(e), e, t)
        })
    }
    function jt(e, t) {
        return At(e, t).then(function(t) {
            return Rt(Nt.resolve(e), t, e.toDataURL())
        })
    }
    function Ut(t) {
        return (e = t,
        n = e.src,
        0 === n.indexOf("data:") ? Dt(n) : Ct(n)).then(function(t) {
            return Ft(t)
        });
        var e, n
    }
    var Bt, Yt, Wt = function(t, e) {
        return Rt(Pt(t), t, e)
    }, Ht = function(t, e, n) {
        return void 0 === e && void 0 === n ? qt(t) : t.toAdjustedBlob(e, n)
    }, qt = function(t) {
        return t.toBlob()
    }, $t = function(t) {
        return t.toDataURL()
    }, Vt = function(t) {
        var n = P.none()
          , e = []
          , r = function(t) {
            o() ? a(t) : e.push(t)
        }
          , o = function() {
            return n.isSome()
        }
          , i = function(t) {
            $(t, a)
        }
          , a = function(e) {
            n.each(function(t) {
                l.setTimeout(function() {
                    e(t)
                }, 0)
            })
        };
        return t(function(t) {
            n = P.some(t),
            i(e),
            e = []
        }),
        {
            get: r,
            map: function(n) {
                return Vt(function(e) {
                    r(function(t) {
                        e(n(t))
                    })
                })
            },
            isReady: o
        }
    }, Xt = {
        nu: Vt,
        pure: function(e) {
            return Vt(function(t) {
                t(e)
            })
        }
    }, Gt = function(e) {
        var t = function(t) {
            var r;
            e((r = t,
            function() {
                for (var t = [], e = 0; e < arguments.length; e++)
                    t[e] = arguments[e];
                var n = this;
                l.setTimeout(function() {
                    r.apply(n, t)
                }, 0)
            }
            ))
        }
          , n = function() {
            return Xt.nu(t)
        };
        return {
            map: function(r) {
                return Gt(function(n) {
                    t(function(t) {
                        var e = r(t);
                        n(e)
                    })
                })
            },
            bind: function(n) {
                return Gt(function(e) {
                    t(function(t) {
                        n(t).get(e)
                    })
                })
            },
            anonBind: function(n) {
                return Gt(function(e) {
                    t(function(t) {
                        n.get(e)
                    })
                })
            },
            toLazy: n,
            toCached: function() {
                var e = null;
                return Gt(function(t) {
                    null === e && (e = n()),
                    e.get(t)
                })
            },
            get: t
        }
    }, zt = {
        nu: Gt,
        pure: function(e) {
            return Gt(function(t) {
                t(e)
            })
        }
    }, Kt = function(a, t) {
        return t(function(r) {
            var o = []
              , i = 0;
            0 === a.length ? r([]) : $(a, function(t, e) {
                var n;
                t.get((n = e,
                function(t) {
                    o[n] = t,
                    ++i >= a.length && r(o)
                }
                ))
            })
        })
    }, Zt = function(t) {
        return Kt(t, zt.nu)
    }, Jt = function(t, e) {
        var n = q(t, e);
        return Zt(n)
    }, Qt = 0, te = function(t) {
        var e = (new Date).getTime();
        return t + "_" + Math.floor(1e9 * Math.random()) + ++Qt + String(e)
    }, ee = function(n) {
        var r, o = !1;
        return function() {
            for (var t = [], e = 0; e < arguments.length; e++)
                t[e] = arguments[e];
            return o || (o = !0,
            r = n.apply(null, t)),
            r
        }
    }, ne = function() {
        return re(0, 0)
    }, re = function(t, e) {
        return {
            major: t,
            minor: e
        }
    }, oe = {
        nu: re,
        detect: function(t, e) {
            var n = String(e).toLowerCase();
            return 0 === t.length ? ne() : function(t, e) {
                var n = function(t, e) {
                    for (var n = 0; n < t.length; n++) {
                        var r = t[n];
                        if (r.test(e))
                            return r
                    }
                }(t, e);
                if (!n)
                    return {
                        major: 0,
                        minor: 0
                    };
                var r = function(t) {
                    return Number(e.replace(n, "$" + t))
                };
                return re(r(1), r(2))
            }(t, n)
        },
        unknown: ne
    }, ie = "Firefox", ae = function(t, e) {
        return function() {
            return e === t
        }
    }, ue = function(t) {
        var e = t.current;
        return {
            current: e,
            version: t.version,
            isEdge: ae("Edge", e),
            isChrome: ae("Chrome", e),
            isIE: ae("IE", e),
            isOpera: ae("Opera", e),
            isFirefox: ae(ie, e),
            isSafari: ae("Safari", e)
        }
    }, ce = {
        unknown: function() {
            return ue({
                current: void 0,
                version: oe.unknown()
            })
        },
        nu: ue,
        edge: v("Edge"),
        chrome: v("Chrome"),
        ie: v("IE"),
        opera: v("Opera"),
        firefox: v(ie),
        safari: v("Safari")
    }, se = "Windows", fe = "Android", le = "Solaris", de = "FreeBSD", me = function(t, e) {
        return function() {
            return e === t
        }
    }, pe = function(t) {
        var e = t.current;
        return {
            current: e,
            version: t.version,
            isWindows: me(se, e),
            isiOS: me("iOS", e),
            isAndroid: me(fe, e),
            isOSX: me("OSX", e),
            isLinux: me("Linux", e),
            isSolaris: me(le, e),
            isFreeBSD: me(de, e)
        }
    }, ge = {
        unknown: function() {
            return pe({
                current: void 0,
                version: oe.unknown()
            })
        },
        nu: pe,
        windows: v(se),
        ios: v("iOS"),
        android: v(fe),
        linux: v("Linux"),
        osx: v("OSX"),
        solaris: v(le),
        freebsd: v(de)
    }, ve = function(t, e) {
        var n = String(e).toLowerCase();
        return G(t, function(t) {
            return t.search(n)
        })
    }, he = function(t, n) {
        return ve(t, n).map(function(t) {
            var e = oe.detect(t.versionRegexes, n);
            return {
                current: t.name,
                version: e
            }
        })
    }, ye = function(t, n) {
        return ve(t, n).map(function(t) {
            var e = oe.detect(t.versionRegexes, n);
            return {
                current: t.name,
                version: e
            }
        })
    }, be = function(t, e, n) {
        return "" === e || !(t.length < e.length) && t.substr(n, n + e.length) === e
    }, xe = function(t, e) {
        return Ie(t, e) ? (n = t,
        r = e.length,
        n.substring(r)) : t;
        var n, r
    }, Te = function(t, e) {
        return Se(t, e) ? (n = t,
        r = e.length,
        n.substring(0, n.length - r)) : t;
        var n, r
    }, Ee = function(t, e) {
        return -1 !== t.indexOf(e)
    }, we = function(n) {
        return (t = n,
        "" === t ? P.none() : P.some(t.substr(0, 1))).bind(function(e) {
            return (t = n,
            "" === t ? P.none() : P.some(t.substring(1))).map(function(t) {
                return e.toUpperCase() + t
            });
            var t
        }).getOr(n);
        var t
    }, Ie = function(t, e) {
        return be(t, e, 0)
    }, Se = function(t, e) {
        return be(t, e, t.length - e.length)
    }, Le = function(t) {
        return t.replace(/^\s+|\s+$/g, "")
    }, _e = /.*?version\/\ ?([0-9]+)\.([0-9]+).*/, Ne = function(e) {
        return function(t) {
            return Ee(t, e)
        }
    }, Ce = [{
        name: "Edge",
        versionRegexes: [/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],
        search: function(t) {
            return Ee(t, "edge/") && Ee(t, "chrome") && Ee(t, "safari") && Ee(t, "applewebkit")
        }
    }, {
        name: "Chrome",
        versionRegexes: [/.*?chrome\/([0-9]+)\.([0-9]+).*/, _e],
        search: function(t) {
            return Ee(t, "chrome") && !Ee(t, "chromeframe")
        }
    }, {
        name: "IE",
        versionRegexes: [/.*?msie\ ?([0-9]+)\.([0-9]+).*/, /.*?rv:([0-9]+)\.([0-9]+).*/],
        search: function(t) {
            return Ee(t, "msie") || Ee(t, "trident")
        }
    }, {
        name: "Opera",
        versionRegexes: [_e, /.*?opera\/([0-9]+)\.([0-9]+).*/],
        search: Ne("opera")
    }, {
        name: "Firefox",
        versionRegexes: [/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],
        search: Ne("firefox")
    }, {
        name: "Safari",
        versionRegexes: [_e, /.*?cpu os ([0-9]+)_([0-9]+).*/],
        search: function(t) {
            return (Ee(t, "safari") || Ee(t, "mobile/")) && Ee(t, "applewebkit")
        }
    }], Oe = [{
        name: "Windows",
        search: Ne("win"),
        versionRegexes: [/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]
    }, {
        name: "iOS",
        search: function(t) {
            return Ee(t, "iphone") || Ee(t, "ipad")
        },
        versionRegexes: [/.*?version\/\ ?([0-9]+)\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]
    }, {
        name: "Android",
        search: Ne("android"),
        versionRegexes: [/.*?android\ ?([0-9]+)\.([0-9]+).*/]
    }, {
        name: "OSX",
        search: Ne("os x"),
        versionRegexes: [/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]
    }, {
        name: "Linux",
        search: Ne("linux"),
        versionRegexes: []
    }, {
        name: "Solaris",
        search: Ne("sunos"),
        versionRegexes: []
    }, {
        name: "FreeBSD",
        search: Ne("freebsd"),
        versionRegexes: []
    }], De = {
        browsers: v(Ce),
        oses: v(Oe)
    }, Ae = function(t) {
        var e, n, r, o, i, a, u, c, s, f, l, d = De.browsers(), m = De.oses(), p = he(d, t).fold(ce.unknown, ce.nu), g = ye(m, t).fold(ge.unknown, ge.nu);
        return {
            browser: p,
            os: g,
            deviceType: (n = p,
            r = t,
            o = (e = g).isiOS() && !0 === /ipad/i.test(r),
            i = e.isiOS() && !o,
            a = e.isAndroid() && 3 === e.version.major,
            u = e.isAndroid() && 4 === e.version.major,
            c = o || a || u && !0 === /mobile/i.test(r),
            s = e.isiOS() || e.isAndroid(),
            f = s && !c,
            l = n.isSafari() && e.isiOS() && !1 === /safari/i.test(r),
            {
                isiPad: v(o),
                isiPhone: v(i),
                isTablet: v(c),
                isPhone: v(f),
                isTouch: v(s),
                isAndroid: e.isAndroid,
                isiOS: e.isiOS,
                isWebView: v(l)
            })
        }
    }, Pe = {
        detect: ee(function() {
            var t = l.navigator.userAgent;
            return Ae(t)
        })
    }, ke = function() {
        return xt.getOrDie("URL")
    }, Me = function(t) {
        return ke().createObjectURL(t)
    }, Re = function(t) {
        ke().revokeObjectURL(t)
    }, Fe = (l.Node.ATTRIBUTE_NODE,
    l.Node.CDATA_SECTION_NODE,
    l.Node.COMMENT_NODE), je = l.Node.DOCUMENT_NODE, Ue = (l.Node.DOCUMENT_TYPE_NODE,
    l.Node.DOCUMENT_FRAGMENT_NODE,
    l.Node.ELEMENT_NODE), Be = l.Node.TEXT_NODE, Ye = (l.Node.PROCESSING_INSTRUCTION_NODE,
    l.Node.ENTITY_REFERENCE_NODE,
    l.Node.ENTITY_NODE,
    l.Node.NOTATION_NODE,
    function(t) {
        return t.dom().nodeName.toLowerCase()
    }
    ), We = function(t) {
        return t.dom().nodeType
    }, He = function(t) {
        return t.dom().nodeValue
    }, qe = function(e) {
        return function(t) {
            return We(t) === e
        }
    }, $e = function(t) {
        return We(t) === Fe || "#comment" === Ye(t)
    }, Ve = qe(Ue), Xe = qe(Be), Ge = (qe(je),
    function(t, e, n) {
        if (!(M(n) || j(n) || B(n)))
            throw l.console.error("Invalid call to Attr.set. Key ", e, ":: Value ", n, ":: Element ", t),
            new Error("Attribute value was not simple");
        t.setAttribute(e, n + "")
    }
    ), ze = function(t, e, n) {
        Ge(t.dom(), e, n)
    }, Ke = function(t, e) {
        var n = t.dom();
        it(e, function(t, e) {
            Ge(n, e, t)
        })
    }, Ze = function(t, e) {
        var n = t.dom().getAttribute(e);
        return null === n ? void 0 : n
    }, Je = function(t, e) {
        var n = t.dom();
        return !(!n || !n.hasAttribute) && n.hasAttribute(e)
    }, Qe = function(t, e) {
        t.dom().removeAttribute(e)
    }, tn = Pe.detect(), en = function(t) {
        var e = Me(t);
        return nn(t, e)
    }, nn = function(i, a) {
        return zt.nu(function(o) {
            var t;
            (t = i,
            kt(t)).then(function(t) {
                var e = Wt(i, t)
                  , n = te("image")
                  , r = vt.blob(n, e, a);
                o(r)
            })
        })
    }, rn = function(t) {
        return 1 === t.length && W(t, "Files")
    }, on = function(t) {
        return !W(t, "text/_moz_htmlcontext")
    }, an = function(t) {
        return W(t, "Files")
    }, un = function(t) {
        return !0
    }, cn = {
        multiple: function(t) {
            return 0 === t.length ? zt.pure([]) : Jt(t, en)
        },
        toFiles: function(t) {
            return t.raw().target.files || t.raw().dataTransfer.files
        },
        isFiles: tn.browser.isChrome() || tn.browser.isSafari() || tn.browser.isOpera() ? an : tn.browser.isFirefox() ? on : tn.browser.isIE() ? rn : un,
        fromImages: function(t) {
            var e = q(t, function(t) {
                var e = te("image");
                return vt.url(e, Ze(t, "src"), t)
            });
            return zt.pure(e)
        },
        single: en,
        singleWithUrl: nn
    }, sn = {
        multiple: function(t) {
            return cn.multiple(t)
        },
        single: function(t) {
            return cn.single(t)
        },
        singleWithUrl: function(t, e) {
            return cn.singleWithUrl(t, e)
        }
    }, fn = function(t) {
        if (null == t)
            throw new Error("Node cannot be null or undefined");
        return {
            dom: v(t)
        }
    }, ln = {
        fromHtml: function(t, e) {
            var n = (e || l.document).createElement("div");
            if (n.innerHTML = t,
            !n.hasChildNodes() || 1 < n.childNodes.length)
                throw l.console.error("HTML does not have a single root node", t),
                new Error("HTML must have a single root node");
            return fn(n.childNodes[0])
        },
        fromTag: function(t, e) {
            var n = (e || l.document).createElement(t);
            return fn(n)
        },
        fromText: function(t, e) {
            var n = (e || l.document).createTextNode(t);
            return fn(n)
        },
        fromDom: fn,
        fromPoint: function(t, e, n) {
            var r = t.dom();
            return P.from(r.elementFromPoint(e, n)).map(fn)
        }
    }, dn = {
        "cement.dialog.paste.title": "Paste Formatting Options",
        "cement.dialog.paste.instructions": "Choose to keep or remove formatting in the pasted content.",
        "cement.dialog.paste.merge": "Keep Formatting",
        "cement.dialog.paste.clean": "Remove Formatting",
        "cement.dialog.flash.title": "Additional step needed to paste images",
        "cement.dialog.flash.trigger-paste": "Your browser requires you to take one more action to paste the images in your content. Please press the below keys to complete the image paste:",
        "cement.dialog.flash.missing": 'Adobe Flash is required to import images from Microsoft Office. Install the <a href="http://get.adobe.com/flashplayer/" target="_blank">Adobe Flash Player</a>.',
        "cement.dialog.flash.press-escape": 'Press <span class="ephox-polish-help-kbd">"Close"</span> to paste your content without images.',
        "loading.wait": "Please wait...",
        "flash.clipboard.no.rtf": tinymce.Env.mac && tinymce.Env.webkit ? 'Your browser security settings may be preventing images from being imported. <a href="https://support.ephox.com/entries/59328357-Safari-6-1-and-7-Flash-Sandboxing" style="text-decoration: underline">More information on paste for Safari</a>' : "Your browser security settings may be preventing images from being imported.",
        "safari.imagepaste": 'Safari does not support direct paste of images. <a href="https://support.ephox.com/entries/88543243-Safari-Direct-paste-of-images-does-not-work" style="text-decoration: underline">More information on image pasting for Safari</a>',
        "webview.imagepaste": 'Safari does not support direct paste of images. <a href="https://support.ephox.com/entries/88543243-Safari-Direct-paste-of-images-does-not-work" style="text-decoration: underline">More information on image pasting for Safari</a>',
        "error.code.images.not.found": "The images service was not found: (",
        "error.imageupload": "Image failed to upload: (",
        "error.full.stop": ").",
        "errors.local.images.disallowed": "Local image paste has been disabled. Local images have been removed from pasted content.",
        "flash.crashed": "Images have not been imported as Adobe Flash appears to have crashed. This may be caused by pasting large documents.",
        "errors.imageimport.failed": "Some images failed to import.",
        "errors.imageimport.unsupported": "Unsupported image type.",
        "errors.imageimport.invalid": "Image is invalid."
    }, mn = {
        translate: function(t) {
            return tinymce.translate(dn[t])
        }
    }, pn = {
        insert: function(t, e) {
            var n, r = e.getDoc(), o = "ephoxInsertMarker", i = e.selection, a = e.dom;
            i.setContent('<span id="' + o + '">&nbsp;</span>'),
            n = a.get(o);
            for (var u = r.createDocumentFragment(); t.firstChild && !a.isBlock(t.firstChild); )
                u.appendChild(t.firstChild);
            for (var c = r.createDocumentFragment(); t.lastChild && !a.isBlock(t.lastChild); )
                c.appendChild(t.lastChild);
            if (n.parentNode.insertBefore(u, n),
            a.insertAfter(c, n),
            t.firstChild) {
                if (a.isBlock(t.firstChild)) {
                    for (; !a.isBlock(n.parentNode) && n.parentNode !== a.getRoot(); )
                        n = a.split(n.parentNode, n);
                    a.is(n.parentNode, "td,th") || n.parentNode === a.getRoot() || (n = a.split(n.parentNode, n))
                }
                a.replace(t, n)
            } else
                a.remove(n)
        }
    }, gn = {
        each: tinymce.each,
        trim: tinymce.trim,
        bind: function(t, e) {
            return function() {
                return t.apply(e, arguments)
            }
        },
        extend: function(n) {
            for (var t = [], e = 1; e < arguments.length; e++)
                t[e - 1] = arguments[e];
            return tinymce.each(Array.prototype.slice.call(arguments, 1), function(t) {
                for (var e in t)
                    n[e] = t[e]
            }),
            n
        },
        ephoxGetComputedStyle: function(t) {
            return t.ownerDocument.defaultView ? t.ownerDocument.defaultView.getComputedStyle(t, null) : t.currentStyle || {}
        },
        log: function(t) {
            "undefined" != typeof console && console.log && console.log(t)
        },
        compose: function(t) {
            var r = Array.prototype.slice.call(t).reverse();
            return function(t) {
                for (var e = t, n = 0; n < r.length; n++)
                    e = (0,
                    r[n])(e);
                return e
            }
        }
    }, vn = {
        strip_class_attributes: "all",
        retain_style_properties: "none"
    }, hn = {
        strip_class_attributes: "none",
        retain_style_properties: "valid"
    }, yn = function(t, e, n) {
        var r = function(t, e) {
            if (t && "string" != typeof t)
                return t;
            switch (t) {
            case "clean":
                return vn;
            case "merge":
                return hn;
            default:
                return e
            }
        }(t, e);
        return r = gn.extend(r, {
            base_64_images: n
        })
    }, bn = {
        create: function(t, e, n) {
            var r = yn(t, vn, n)
              , o = yn(e, hn, n)
              , i = o;
            return {
                setWordContent: function(t) {
                    i = t ? r : o
                },
                get: function(t) {
                    return i[t]
                }
            }
        }
    }, xn = "startElement", Tn = "endElement", En = "text", wn = "comment", In = function(o) {
        var i, e, a = 0, u = function() {
            return i
        };
        e = function() {
            return i = {},
            a = 0,
            gn.each(o.attributes, function(t) {
                var e, n = t.nodeName, r = t.value;
                (!1 !== (e = t).specified || "name" === e.nodeName && "" !== e.value) && null != r && (i[n] = r,
                a++)
            }),
            void 0 === i.style && o.style.cssText && (i.style = o.style.cssText,
            a++),
            e = u,
            i
        }
        ;
        var c, s, f = function(n) {
            gn.each(e(), function(t, e) {
                n(e, t)
            })
        };
        return {
            get: function(t) {
                return e()[t]
            },
            each: f,
            filter: function(t) {
                var n, r;
                c || (s = e),
                r = t,
                c = (n = c) && r ? function(t, e) {
                    return r(t, n(t, e))
                }
                : n || r,
                e = function() {
                    return e = s,
                    f(function(t, e) {
                        var n = c(t, e);
                        null === n ? (o.removeAttribute(t),
                        delete i[t],
                        a--) : n !== e && ("class" === t ? o.className = n : o.setAttribute(t, n),
                        i[t] = n)
                    }),
                    e = u,
                    i
                }
            },
            getAttributes: function() {
                return e()
            },
            getAttributeCount: function() {
                return e(),
                a
            }
        }
    }, Sn = function(t) {
        return t.replace(/-(.)/g, function(t, e) {
            return e.toUpperCase()
        })
    }, Ln = !1, _n = function(i, t, e) {
        var n, r, o, a, u, c, s, f, l, d;
        switch (i.nodeType) {
        case 1:
            t ? n = Tn : (n = xn,
            a = In(i),
            u = {},
            c = i,
            s = function(t, e) {
                u[t] = e
            }
            ,
            null != (d = e || c.getAttribute("style")) && d.split || (d = c.style.cssText),
            gn.each(d.split(";"), function(t) {
                var e = t.indexOf(":");
                0 < e && ((f = gn.trim(t.substring(0, e))).toUpperCase() === f && (f = f.toLowerCase()),
                f = f.replace(/([A-Z])/g, function(t, e) {
                    return "-" + e.toLowerCase()
                }),
                l = gn.trim(t.substring(e + 1)),
                Ln || (Ln = 0 === f.indexOf("mso-")),
                s(f, l))
            }),
            Ln || (l = c.style["mso-list"]) && s("mso-list", l)),
            r = "HTML" !== i.scopeName && i.scopeName && i.tagName && i.tagName.indexOf(":") <= 0 ? (i.scopeName + ":" + i.tagName).toUpperCase() : i.tagName;
            break;
        case 3:
            n = En,
            o = i.nodeValue;
            break;
        case 8:
            n = wn,
            o = i.nodeValue;
            break;
        default:
            gn.log("WARNING: Unsupported node type encountered: " + i.nodeType)
        }
        var m = function() {
            return n
        }
          , p = function(t) {
            n === xn && a.filter(t)
        };
        return {
            getNode: function() {
                return a && a.getAttributes(),
                i
            },
            tag: function() {
                return r
            },
            type: m,
            text: function() {
                return o
            },
            toString: function() {
                return "Type: " + n + ", Tag: " + r + " Text: " + o
            },
            getAttribute: function(t) {
                return a.get(t.toLowerCase())
            },
            filterAttributes: p,
            filterStyles: function(r) {
                if (m() === xn) {
                    var o = "";
                    gn.each(u, function(t, e) {
                        var n = r(e, t);
                        null === n ? (i.style.removeProperty ? i.style.removeProperty(Sn(e)) : i.style.removeAttribute(Sn(e)),
                        delete u[e]) : (o += e + ": " + n + "; ",
                        u[e] = n)
                    }),
                    o = o || null,
                    p(function(t, e) {
                        return "style" === t ? o : e
                    }),
                    i.style.cssText = o
                }
            },
            getAttributeCount: function() {
                return a.getAttributeCount()
            },
            attributes: function(t) {
                a.each(t)
            },
            getStyle: function(t) {
                return u[t]
            },
            styles: function(n) {
                gn.each(u, function(t, e) {
                    n(e, t)
                })
            },
            getComputedStyle: function() {
                return gn.ephoxGetComputedStyle(i)
            },
            isWhitespace: function() {
                return n === En && /^[\s\u00A0]*$/.test(o)
            }
        }
    }, Nn = function(t, e) {
        return _n(e.createElement(t), !0)
    }, Cn = Nn("HTML", window.document), On = {
        START_ELEMENT_TYPE: xn,
        END_ELEMENT_TYPE: Tn,
        TEXT_TYPE: En,
        COMMENT_TYPE: wn,
        FINISHED: Cn,
        token: _n,
        createStartElement: function(t, e, n, r) {
            var o = r.createElement(t)
              , i = "";
            return gn.each(e, function(t, e) {
                o.setAttribute(e, t)
            }),
            gn.each(n, function(t, e) {
                i += e + ":" + t + ";",
                o.style[Sn(e)] = t
            }),
            _n(o, !1, "" !== i ? i : null)
        },
        createEndElement: Nn,
        createComment: function(t, e) {
            return _n(e.createComment(t), !1)
        },
        createText: function(t, e) {
            return _n(e.createTextNode(t))
        }
    }, Dn = function(i) {
        var a = i.createDocumentFragment()
          , u = function(t) {
            a.appendChild(t)
        };
        return {
            dom: a,
            receive: function(t) {
                var e, n, r, o;
                switch (t.type()) {
                case On.START_ELEMENT_TYPE:
                    o = t.getNode().cloneNode(!1),
                    u(r = o),
                    a = r;
                    break;
                case On.TEXT_TYPE:
                    e = t,
                    n = i.createTextNode(e.text()),
                    u(n);
                    break;
                case On.END_ELEMENT_TYPE:
                    a = a.parentNode;
                    break;
                case On.COMMENT_TYPE:
                    break;
                default:
                    throw {
                        message: "Unsupported token type: " + t.type()
                    }
                }
            }
        }
    }, An = function(t, o) {
        var i;
        o = o || window.document,
        i = o.createElement("div"),
        o.body.appendChild(i),
        i.style.position = "absolute",
        i.style.left = "-10000px",
        i.innerHTML = t;
        var a = i.firstChild || On.FINISHED
          , u = []
          , c = !1;
        return {
            hasNext: function() {
                return void 0 !== a
            },
            next: function() {
                var t, e, n = a, r = c;
                return !c && a.firstChild ? (u.push(a),
                a = a.firstChild) : c || 1 !== a.nodeType ? a.nextSibling ? (a = a.nextSibling,
                c = !1) : (a = u.pop(),
                c = !0) : c = !0,
                n === On.FINISHED || a || (o.body.removeChild(i),
                a = On.FINISHED),
                e = r,
                (t = n) === On.FINISHED ? t : t ? On.token(t, e) : void 0
            }
        }
    }, Pn = function(p, g) {
        return function(e, t, n) {
            var r, o, i, a = !1, u = function() {
                g && g(m),
                a = !1,
                o = [],
                i = []
            }, c = function(t) {
                gn.each(t, function(t) {
                    e.receive(t)
                })
            }, s = function(t) {
                a ? i.push(t) : e.receive(t)
            }, f = function() {
                l(),
                c(i),
                u()
            }, l = function() {
                gn.each(r, function(t) {
                    s(t)
                }),
                d()
            }, d = function() {
                r = []
            }, m = {
                document: n || window.document,
                settings: t || {},
                emit: s,
                receive: function(t) {
                    g && o.push(t),
                    p(m, t),
                    t === On.FINISHED && f()
                },
                startTransaction: function() {
                    a = !0
                },
                rollback: function() {
                    c(o),
                    u()
                },
                commit: f,
                defer: function(t) {
                    (r = r || []).push(t)
                },
                hasDeferred: function() {
                    return r && 0 < r.length
                },
                emitDeferred: l,
                dropDeferred: d
            };
            return u(),
            m
        }
    }, kn = Pn, Mn = function(n) {
        return Pn(function(t, e) {
            e.filterAttributes(gn.bind(n, t)),
            t.emit(e)
        })
    }, Rn = /^(P|H[1-6]|T[DH]|LI|DIV|BLOCKQUOTE|PRE|ADDRESS|FIELDSET|DD|DT|CENTER)$/, Fn = function() {
        return null
    }, jn = !1, Un = kn(function(t, e) {
        var n, r = function() {
            jn || (t.emit(On.createStartElement("P", {}, {}, t.document)),
            jn = !0)
        };
        switch (e.type()) {
        case On.TEXT_TYPE:
            r(),
            t.emit(e);
            break;
        case On.END_ELEMENT_TYPE:
            jn && (n = e,
            Rn.test(n.tag()) || e === On.FINISHED) ? (t.emit(On.createEndElement("P", t.document)),
            jn = !1) : "BR" === e.tag() && t.emit(e);
            break;
        case On.START_ELEMENT_TYPE:
            "BR" === e.tag() ? (e.filterAttributes(Fn),
            e.filterStyles(Fn),
            t.emit(e)) : "IMG" === e.tag() && e.getAttribute("alt") && (r(),
            t.emit(On.createText(e.getAttribute("alt"), t.document)))
        }
        e === On.FINISHED && t.emit(e)
    }), Bn = function(t) {
        var e = t;
        return 65279 === e.charCodeAt(e.length - 1) ? e.substring(0, e.length - 1) : t
    }, Yn = [Bn], Wn = tinymce.isIE && 9 <= document.documentMode ? [function(t) {
        return t.replace(/<BR><BR>/g, "<br>")
    }
    , function(t) {
        return t.replace(/<br>/g, " ")
    }
    , function(t) {
        return t.replace(/<br><br>/g, "<BR><BR>")
    }
    , function(t) {
        return /<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(t) ? t.replace(/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g, "$1") : t
    }
    ].concat(Yn) : Yn, Hn = {
        all: gn.compose(Wn),
        textOnly: Bn
    }, qn = /^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/, $n = kn(function(t, e) {
        var r, n = t.settings.get("retain_style_properties");
        e.filterStyles((r = n,
        function(t, e) {
            var n = !1;
            switch (r) {
            case "all":
            case "*":
                n = !0;
                break;
            case "valid":
                n = !qn.test(t);
                break;
            case void 0:
            case "none":
                n = "list-style-type" === t;
                break;
            default:
                n = 0 <= ("," + r + ",").indexOf("," + t + ",")
            }
            return n ? e : null
        }
        )),
        t.emit(e)
    }), Vn = kn(function(t, e) {
        t.seenList || (t.inferring ? "LI" === e.tag() && (e.type() === On.START_ELEMENT_TYPE ? t.inferring++ : (t.inferring--,
        t.inferring || (t.needsClosing = !0))) : ("OL" === e.tag() || "UL" === e.tag() ? t.seenList = !0 : "LI" === e.tag() && (t.inferring = 1,
        t.needsClosing || t.emit(On.createStartElement("UL", {}, {}, t.document))),
        !t.needsClosing || t.inferring || e.isWhitespace() || (t.needsClosing = !1,
        t.emit(On.createEndElement("UL", t.document))))),
        t.emit(e)
    }), Xn = Mn(function(t, e) {
        return "name" === t || "id" === t ? null : e
    }), Gn = Mn(function(t, e) {
        if ("class" === t)
            switch (this.settings.get("strip_class_attributes")) {
            case "mso":
                return 0 === e.indexOf("Mso") ? null : e;
            case "none":
                return e;
            default:
                return null
            }
        return e
    }), zn = function() {
        if (0 < navigator.userAgent.indexOf("Gecko") && navigator.userAgent.indexOf("WebKit") < 0)
            return !1;
        var t = document.createElement("div");
        try {
            t.innerHTML = '<p style="mso-list: Ignore;">&nbsp;</p>'
        } catch (t) {
            return !1
        }
        return "Ignore" === On.token(t.firstChild).getStyle("mso-list")
    }(), Kn = function(t, e) {
        return t.type() === On.START_ELEMENT_TYPE ? 0 === t.getAttributeCount() || e && 1 === t.getAttributeCount() && null !== t.getAttribute("style") && void 0 !== t.getAttribute("style") : t.type() === On.END_ELEMENT_TYPE
    }, Zn = zn, Jn = function(t) {
        return "A" === t.tag() || "SPAN" === t.tag()
    }, Qn = function(t) {
        var e = t.getStyle("mso-list");
        return e && "skip" !== e
    }, tr = [], er = [], nr = !1, rr = function(t, e) {
        var n, r, o = 1;
        for (n = e + 1; n < t; n++)
            if ((r = tr[n]) && "SPAN" === r.tag())
                if (r.type() === On.START_ELEMENT_TYPE)
                    o++;
                else if (r.type() === On.END_ELEMENT_TYPE && 0 == --o)
                    return void (tr[n] = null)
    }, or = function(t, e) {
        if (tr.push(e),
        er = er || [],
        e.type() === On.START_ELEMENT_TYPE)
            er.push(e);
        else if (e.type() === On.END_ELEMENT_TYPE && (er.pop(),
        0 === er.length))
            return void function(t) {
                if (nr) {
                    var e = void 0
                      , n = tr.length
                      , r = void 0;
                    for (r = 0; r < n; r++)
                        (e = tr[r]) && (e.type() === On.START_ELEMENT_TYPE && "SPAN" === e.tag() && Kn(e) ? rr(n, r) : t.emit(e))
                }
                tr = [],
                nr = !(er = [])
            }(t)
    }, ir = kn(function(t, e) {
        var n = function(t) {
            return !(0 <= ",FONT,EM,STRONG,SAMP,ACRONYM,CITE,CODE,DFN,KBD,TT,B,I,U,S,SUB,SUP,INS,DEL,VAR,SPAN,".indexOf("," + t.tag() + ",") && Kn(t, !0))
        };
        0 === (tr = tr || []).length ? e.type() === On.START_ELEMENT_TYPE ? n(e) ? t.emit(e) : or(t, e) : t.emit(e) : (nr || (nr = n(e)),
        or(t, e))
    }), ar = Mn(function(t, e) {
        return "style" === t && "" === e ? null : e
    }), ur = Mn(function(t, e) {
        return "lang" === t ? null : e
    }), cr = kn(function(t, e) {
        if ("IMG" === e.tag()) {
            if (e.type() === On.END_ELEMENT_TYPE && t.skipEnd)
                return void (t.skipEnd = !1);
            if (e.type() === On.START_ELEMENT_TYPE) {
                if (/^file:/.test(e.getAttribute("src")))
                    return void (t.skipEnd = !0);
                if (t.settings.get("base_64_images") && /^data:image\/.*;base64/.test(e.getAttribute("src")))
                    return void (t.skipEnd = !0)
            }
        }
        t.emit(e)
    }), sr = kn(function(t, e) {
        "META" !== e.tag() && "LINK" !== e.tag() && t.emit(e)
    }), fr = function(t) {
        return !Kn(t) && !/^OLE_LINK/.test(t.getAttribute("name"))
    }, lr = [], dr = kn(function(t, e) {
        var n;
        e.type() === On.START_ELEMENT_TYPE && "A" === e.tag() ? (lr.push(e),
        fr(e) && t.defer(e)) : e.type() === On.END_ELEMENT_TYPE && "A" === e.tag() ? (n = lr.pop(),
        fr(n) && t.defer(e),
        0 === lr.length && t.emitDeferred()) : t.hasDeferred() ? t.defer(e) : t.emit(e)
    }), mr = !1, pr = [kn(function(t, e) {
        "SCRIPT" === e.tag() ? mr = e.type() === On.START_ELEMENT_TYPE : mr || (e.filterAttributes(function(t, e) {
            return /^on/.test(t) || "language" === t ? null : e
        }),
        t.emit(e))
    }), Xn, cr, $n, ur, ar, Gn, dr, ir, sr, Vn], gr = kn(function(t, n) {
        n.filterAttributes(function(t, e) {
            return "align" === t ? null : "UL" !== n.tag() && "OL" !== n.tag() || "type" !== t ? e : null
        }),
        t.emit(n)
    }), vr = Mn(function(t, e) {
        return /^xmlns(:|$)/.test(t) ? null : e
    }), hr = kn(function(t, e) {
        e.tag && /^([OVWXP]|U[0-9]+|ST[0-9]+):/.test(e.tag()) || t.emit(e)
    }), yr = Mn(function(t, e) {
        return "href" === t && (0 <= e.indexOf("#_Toc") || 0 <= e.indexOf("#_mso")) ? null : e
    }), br = Mn(function(t, e) {
        return /^v:/.test(t) ? null : e
    }), xr = [{
        regex: /^\(?[dc][\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-alpha"
        }
    }, {
        regex: /^\(?[DC][\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-alpha"
        }
    }, {
        regex: /^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-roman"
        }
    }, {
        regex: /^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-roman"
        }
    }, {
        regex: /^\(?[0-9]+[\.\)]$/,
        type: {
            tag: "OL"
        }
    }, {
        regex: /^([0-9]+\.)*[0-9]+\.?$/,
        type: {
            tag: "OL",
            variant: "outline"
        }
    }, {
        regex: /^\(?[a-z]+[\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-alpha"
        }
    }, {
        regex: /^\(?[A-Z]+[\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-alpha"
        }
    }], Tr = {
        "\u2022": {
            tag: "UL",
            type: "disc"
        },
        "\xb7": {
            tag: "UL",
            type: "disc"
        },
        "\xa7": {
            tag: "UL",
            type: "square"
        }
    }, Er = {
        o: {
            tag: "UL",
            type: "circle"
        },
        "-": {
            tag: "UL",
            type: "disc"
        },
        "\u25cf": {
            tag: "UL",
            type: "disc"
        }
    }, wr = function(t, e) {
        var n = {
            tag: t.tag,
            type: t.type,
            variant: e
        };
        return t.start && (n.start = t.start),
        t.type || delete n.type,
        n
    }, Ir = function(t, e, n) {
        return t === e || t && e && t.tag === e.tag && t.type === e.type && (n || t.variant === e.variant)
    }, Sr = {
        guessListType: function(t, e, n) {
            var r, o, i, a = null;
            return t && (r = t.text,
            o = t.symbolFont),
            r = gn.trim(r),
            (a = Er[r]) ? a = wr(a, r) : o ? a = (a = Tr[r]) ? wr(a, r) : {
                tag: "UL",
                variant: r
            } : (gn.each(xr, function(t) {
                if (t.regex.test(r)) {
                    if (e && Ir(t.type, e, !0))
                        return (a = t.type).start = parseInt(r, 10),
                        !1;
                    a || (a = t.type),
                    a.start = parseInt(r, 10)
                }
            }),
            a && !a.variant && (i = "(" === r.charAt(0) ? "()" : ")" === r.charAt(r.length - 1) ? ")" : ".",
            a = wr(a, i))),
            a && "OL" === a.tag && n && ("P" !== n.tag() || /^MsoHeading/.test(n.getAttribute("class"))) && (a = null),
            a
        },
        eqListType: Ir,
        checkFont: function(t, e) {
            if (t.type() === On.START_ELEMENT_TYPE) {
                var n = t.getStyle("font-family");
                n ? e = "Wingdings" === n || "Symbol" === n : /^(P|H[1-6]|DIV)$/.test(t.tag()) && (e = !1)
            }
            return e
        }
    }, Lr = function(t) {
        var e = t.indexOf(".");
        if (0 <= e && void 0 === gn.trim(t.substring(e + 1)))
            return (void 0)[2],
            !1
    }, _r = (Bt = function(t, e) {
        var n, r = /([^{]+){([^}]+)}/g;
        for (r.lastIndex = 0; null !== (n = r.exec(t)); )
            gn.each(n[1].split(","), Lr(void 0));
        return !1
    }
    ,
    Yt = {},
    function(t, e) {
        var n, r = t + "," + e;
        return Yt.hasOwnProperty(r) ? Yt[r] : (n = Bt.call(null, t, e),
        Yt[r] = n)
    }
    ), Nr = function(t, e) {
        var n, r, o, i = !1, a = function(t) {
            var e = t.style.fontFamily;
            e && (i = "Wingdings" === e || "Symbol" === e)
        };
        if (t.type() === On.START_ELEMENT_TYPE && e.openedTag && "SPAN" === t.tag()) {
            for (a(n = e.openedTag.getNode()),
            1 < n.childNodes.length && "A" === n.firstChild.tagName && "" === n.firstChild.textContent && (n = n.childNodes[1]); n.firstChild && ("SPAN" === n.firstChild.tagName || "A" === n.firstChild.tagName); )
                a(n = n.firstChild);
            if (!(n = n.firstChild) || 3 !== n.nodeType)
                return n && "IMG" === n.tagName;
            if (r = n.value,
            gn.trim(r) || (r = (n = n.parentNode.nextSibling) ? n.value : ""),
            !n || gn.trim(n.parentNode.textContent) != r)
                return !1;
            if (o = Sr.guessListType({
                text: r,
                symbolFont: i
            }, null, e.originalToken))
                return n.nextSibling && "SPAN" === n.nextSibling.tagName && /^[\u00A0\s]/.test(n.nextSibling.firstChild.value) && ("P" === e.openedTag.tag() || "UL" === o.tag)
        }
        return !1
    }, Cr = function() {
        var a, u;
        return {
            guessIndentLevel: function(t, e, n, r) {
                var o, i;
                return r && /^([0-9]+\.)+[0-9]+\.?$/.test(r.text) ? r.text.replace(/([0-9]+|\.$)/g, "").length + 1 : (o = u || parseInt(_r(n, e.getAttribute("class"))),
                i = function(t, e) {
                    var n, r = 0;
                    for (n = t.parentNode; null != n && n !== e.parentNode; )
                        r += n.offsetLeft,
                        n = n.offsetParent;
                    return r
                }(t.getNode(), e.getNode()),
                o ? a ? i += a : 0 === i && (i += a = o) : o = 48,
                u = o = Math.min(i, o),
                Math.max(1, Math.floor(i / o)) || 1)
            }
        }
    }, Or = function() {
        var e = !1;
        return {
            check: function(t) {
                return e && t.type() === On.TEXT_TYPE ? (t.text(),
                !0) : t.type() === On.START_ELEMENT_TYPE && "STYLE" === t.tag() ? e = !0 : t.type() === On.END_ELEMENT_TYPE && "STYLE" === t.tag() && !(e = !1)
            }
        }
    }, Dr = ["disc", "circle", "square"];
    function Ar(a, u) {
        var i, o = [], c = [], s = 0, f = function(t, e) {
            var n = {}
              , r = {};
            s++,
            e && t.type && (n = {
                "list-style-type": t.type
            }),
            t.start && 1 < t.start && (r = {
                start: t.start
            }),
            o.push(t),
            a.emit(On.createStartElement(t.tag, r, n, u)),
            i = t
        }, l = function() {
            a.emit(On.createEndElement(o.pop().tag, u)),
            s--,
            i = o[o.length - 1]
        }, d = function() {
            var t = c ? c.pop() : "P";
            "P" !== t && a.emit(On.createEndElement(t, u)),
            a.emit(On.createEndElement("LI", u))
        }, m = function(t, e, n) {
            var r = {};
            if (t) {
                var o = t.getStyle("margin-left");
                void 0 !== o && (r["margin-left"] = o)
            } else
                r["list-style-type"] = "none";
            i && !Sr.eqListType(i, e) && (l(),
            n && (a.emit(On.createStartElement("P", {}, {}, u)),
            a.emit(On.createText("\xa0", u)),
            a.emit(On.createEndElement("P", u))),
            f(e, !0)),
            a.emit(On.createStartElement("LI", {}, r, u)),
            t && "P" !== t.tag() ? (c.push(t.tag()),
            t.filterStyles(function() {
                return null
            }),
            a.emit(t)) : c.push("P")
        };
        return {
            openList: f,
            closelist: l,
            closeAllLists: function() {
                for (; 0 < s; )
                    d(),
                    l();
                a.commit()
            },
            closeItem: d,
            openLI: m,
            openItem: function(t, e, n, r) {
                if (n) {
                    for (s || (s = 0); t < s; )
                        d(),
                        l();
                    var o, i;
                    if (i = t,
                    "UL" === (o = n).tag && Dr[i - 1] === o.type && (o = {
                        tag: "UL"
                    }),
                    n = o,
                    s === t)
                        d(),
                        m(e, n, r);
                    else
                        for (1 < t && 0 < c.length && "P" !== c[c.length - 1] && (a.emit(On.createEndElement(c[c.length - 1], u)),
                        c[c.length - 1] = "P"); s < t; )
                            f(n, s === t - 1),
                            m(s === t ? e : void 0, n)
                }
            },
            getCurrentListType: function() {
                return i
            },
            getCurrentLevel: function() {
                return s
            }
        }
    }
    var Pr = function(t, e) {
        gn.log("Unexpected token in list conversion: " + e.toString()),
        t.rollback()
    }
      , kr = function(t, e, n) {
        n.type() === On.TEXT_TYPE && "" === gn.trim(n.text()) ? t.defer(n) : e.skippedPara || n.type() !== On.START_ELEMENT_TYPE || "P" !== n.tag() || Qn(n) ? Rr(t, e, n) : (e.openedTag = n,
        t.defer(n),
        e.nextFilter = Mr)
    }
      , Mr = function(t, e, n) {
        n.type() !== On.START_ELEMENT_TYPE || "SPAN" !== n.tag() || 0 !== e.spanCount.length || !Zn && Nr(n, e) || Qn(n) ? n.type() === On.END_ELEMENT_TYPE ? "SPAN" === n.tag() ? (t.defer(n),
        e.spanCount.pop()) : "P" === n.tag() ? (t.defer(n),
        e.skippedPara = !0,
        e.openedTag = null,
        e.nextFilter = kr) : (e.nextFilter = Rr,
        e.nextFilter(t, e, n)) : n.isWhitespace() ? t.defer(n) : (e.nextFilter = Rr,
        e.nextFilter(t, e, n)) : (t.defer(n),
        e.spanCount.push(n))
    }
      , Rr = function(t, e, n) {
        var r = function() {
            e.emitter.closeAllLists(),
            t.emitDeferred(),
            e.openedTag = null,
            t.emit(n),
            e.nextFilter = Rr
        };
        if (n.type() === On.START_ELEMENT_TYPE && Qn(n) && "LI" !== n.tag()) {
            var o = / level([0-9]+)/.exec(n.getStyle("mso-list"));
            o && o[1] ? (e.itemLevel = parseInt(o[1], 10) + e.styleLevelAdjust,
            e.nextFilter === Rr ? t.emitDeferred() : t.dropDeferred(),
            e.nextFilter = jr,
            t.startTransaction(),
            e.originalToken = n,
            e.commentMode = !1) : r()
        } else
            !Zn && (n.type() === On.COMMENT_TYPE && "[if !supportLists]" === n.text() || Nr(n, t)) ? (n.type() === On.START_ELEMENT_TYPE && "SPAN" === n.tag() && e.spanCount.push(n),
            e.nextFilter = jr,
            t.startTransaction(),
            e.originalToken = e.openedTag,
            e.commentMode = !0,
            e.openedTag = null,
            t.dropDeferred()) : n.type() === On.END_ELEMENT_TYPE && Jn(n) ? (t.defer(n),
            e.spanCount.pop()) : n.type() === On.START_ELEMENT_TYPE ? Jn(n) ? (t.defer(n),
            e.spanCount.push(n)) : (e.openedTag && (e.emitter.closeAllLists(),
            t.emitDeferred()),
            e.openedTag = n,
            t.defer(n)) : r()
    }
      , Fr = function(t, e, n) {
        n.type() === On.END_ELEMENT_TYPE && e.originalToken.tag() === n.tag() && (e.nextFilter = kr,
        e.styleLevelAdjust = -1),
        t.emit(n)
    }
      , jr = function(t, e, n) {
        if (n.type() === On.START_ELEMENT_TYPE && "Ignore" === n.getStyle("mso-list") && (e.nextFilter = Ur),
        n.type() === On.START_ELEMENT_TYPE && "SPAN" === n.tag())
            e.spanCount.push(n),
            (e.commentMode && "" === n.getAttribute("style") || null === n.getAttribute("style")) && (e.nextFilter = Ur);
        else if ("A" === n.tag())
            n.type() === On.START_ELEMENT_TYPE ? e.spanCount.push(n) : e.spanCount.pop();
        else if (n.type() === On.TEXT_TYPE)
            if (e.commentMode)
                e.nextFilter = Ur,
                e.nextFilter(t, e, n);
            else {
                var r = e.originalToken
                  , o = e.spanCount;
                e.emitter.closeAllLists(),
                t.emit(r),
                gn.each(o, gn.bind(t.emit, t)),
                t.emit(n),
                t.commit(),
                e.originalToken = r,
                e.nextFilter = Fr
            }
        else
            (e.commentMode || n.type() !== On.COMMENT_TYPE) && Pr(t, n)
    }
      , Ur = function(t, e, n) {
        n.type() === On.TEXT_TYPE ? n.isWhitespace() || (e.nextFilter = Br,
        e.bulletInfo = {
            text: n.text(),
            symbolFont: e.symbolFont
        }) : Jn(n) ? n.type() === On.START_ELEMENT_TYPE ? e.spanCount.push(n) : e.spanCount.pop() : n.type() === On.START_ELEMENT_TYPE && "IMG" === n.tag() ? (e.nextFilter = Br,
        e.bulletInfo = {
            text: "\u2202",
            symbolFont: !0
        }) : Pr(t, n)
    }
      , Br = function(t, e, n) {
        n.type() === On.START_ELEMENT_TYPE && Jn(n) ? (e.spanCount.push(n),
        e.nextFilter = Yr) : n.type() === On.END_ELEMENT_TYPE && Jn(n) ? (e.spanCount.pop(),
        e.nextFilter = Wr) : n.type() === On.END_ELEMENT_TYPE && "IMG" === n.tag() || Pr(t, n)
    }
      , Yr = function(t, e, n) {
        n.type() === On.END_ELEMENT_TYPE && (Jn(n) && e.spanCount.pop(),
        e.nextFilter = Wr)
    }
      , Wr = function(o, i, a) {
        var t = function(t) {
            var e, n, r;
            if (i.nextFilter = Hr,
            i.commentMode && (i.itemLevel = i.indentGuesser.guessIndentLevel(a, i.originalToken, i.styles.styles, i.bulletInfo)),
            i.listType = Sr.guessListType(i.bulletInfo, (e = i.emitter.getCurrentListType(),
            n = i.emitter.getCurrentLevel(),
            r = i.itemLevel,
            n === r ? e : null), i.originalToken),
            i.listType) {
                for (i.emitter.openItem(i.itemLevel, i.originalToken, i.listType, i.skippedPara),
                o.emitDeferred(); 0 < i.spanCount.length; )
                    o.emit(i.spanCount.shift());
                t && o.emit(a)
            } else
                gn.log("Unknown list type: " + i.bulletInfo.text + " Symbol font? " + i.bulletInfo.symbolFont),
                o.rollback()
        };
        a.type() === On.TEXT_TYPE || a.type() === On.START_ELEMENT_TYPE ? t(!0) : a.type() === On.COMMENT_TYPE ? t("[endif]" !== a.text()) : a.type() === On.END_ELEMENT_TYPE ? Jn(a) && i.spanCount.pop() : Pr(o, a)
    }
      , Hr = function(t, e, n) {
        n.type() === On.END_ELEMENT_TYPE && n.tag() === e.originalToken.tag() ? (e.nextFilter = kr,
        e.skippedPara = !1) : t.emit(n)
    }
      , qr = {
        initial: Rr
    }
      , $r = {}
      , Vr = function(t) {
        $r.nextFilter = qr.initial,
        $r.itemLevel = 0,
        $r.originalToken = null,
        $r.commentMode = !1,
        $r.openedTag = null,
        $r.symbolFont = !1,
        $r.listType = null,
        $r.indentGuesser = Cr(),
        $r.emitter = Ar(t, t.document),
        $r.styles = Or(),
        $r.spanCount = [],
        $r.skippedPara = !1,
        $r.styleLevelAdjust = 0,
        $r.bulletInfo = void 0
    };
    Vr({});
    var Xr = [hr, kn(function(t, e) {
        $r.styles.check(e) || ($r.symbolFont = Sr.checkFont(e, $r.symbolFont),
        $r.nextFilter(t, $r, e))
    }, function(t) {
        Vr(t)
    }), yr, br, vr, gr]
      , Gr = function(t, e, n, r) {
        for (var o = Dn(n), i = An(t, n), a = function(t, e, n, r) {
            var o, i = e;
            for (o = t.length - 1; 0 <= o; o--)
                i = t[o](i, n, r);
            return i
        }(r, o, e, n); i.hasNext(); )
            a.receive(i.next());
        return o.dom
    }
      , zr = function(t) {
        return 0 <= t.indexOf("<o:p>") || 0 <= t.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal") || 0 <= t.indexOf("MsoListParagraphCxSpFirst") || 0 <= t.indexOf("<w:WordDocument>")
    }
      , Kr = {
        filter: function(t, e, n) {
            var r = Hn.all(t)
              , o = zr(r);
            e.setWordContent(o);
            var i = pr;
            return o && (i = Xr.concat(pr)),
            Gr(r, e, n, i)
        },
        filterPlainText: function(t, e, n) {
            var r = Hn.textOnly(t);
            return Gr(r, e, n, [Un])
        },
        isWordContent: zr
    }
      , Zr = {
        officeStyles: "prompt",
        htmlStyles: "clean"
    }
      , Jr = {
        openDialog: function(t, e, n) {
            var r, o = e("cement.dialog.paste.clean"), i = e("cement.dialog.paste.merge"), a = [{
                text: o,
                ariaLabel: o,
                onclick: function() {
                    r.close(),
                    n("clean")
                }
            }, {
                text: i,
                ariaLabel: i,
                onclick: function() {
                    r.close(),
                    n("merge")
                }
            }], u = {
                title: e("cement.dialog.paste.title"),
                spacing: 10,
                padding: 10,
                items: [{
                    type: "container",
                    html: e("cement.dialog.paste.instructions")
                }],
                buttons: a
            };
            r = t.windowManager.open(u),
            setTimeout(function() {
                r && r.getEl().focus()
            }, 1)
        }
    }
      , Qr = {
        openDialog: function(t, e, n) {
            var r = e("cement.dialog.paste.clean")
              , o = e("cement.dialog.paste.merge")
              , i = {
                title: e("cement.dialog.paste.title"),
                body: {
                    type: "panel",
                    items: [{
                        type: "htmlpanel",
                        name: "instructions",
                        html: e("cement.dialog.paste.instructions")
                    }]
                },
                buttons: [{
                    text: r,
                    type: "custom",
                    name: "clean"
                }, {
                    text: o,
                    type: "custom",
                    name: "merge"
                }],
                onAction: function(t, e) {
                    switch (e.name) {
                    case "clean":
                        t.close(),
                        n("clean");
                        break;
                    case "merge":
                        t.close(),
                        n("merge")
                    }
                }
            };
            t.windowManager.open(i)
        }
    };
    function to(a, u, c) {
        return {
            showDialog: function(o) {
                var t, e = a.settings.powerpaste_word_import || Zr.officeStyles, n = a.settings.powerpaste_html_import || Zr.htmlStyles, r = Kr.isWordContent(o) ? e : n, i = function(t) {
                    var e = {
                        content: o
                    };
                    a.fire("PastePreProcess", {
                        content: e,
                        internal: !1
                    });
                    var n = bn.create(t, t, !0)
                      , r = Kr.filter(e.content, n, a.getDoc());
                    a.fire("PastePostProcess", {
                        node: r,
                        internal: !1
                    }),
                    a.undoManager.transact(function() {
                        pn.insert(r, a)
                    })
                };
                "clean" === (t = r) || "merge" === t ? i(r) : (c ? Qr : Jr).openDialog(a, u, i)
            }
        }
    }
    function eo(u, t, e, r, c) {
        var s, f = /^image\/(jpe?g|png|gif|bmp)$/i;
        u.on("dragstart dragend", function(t) {
            s = "dragstart" === t.type
        }),
        u.on("dragover dragend dragleave", function(t) {
            s || t.preventDefault()
        });
        var l = function(t, e) {
            return e in t && 0 < t[e].length
        }
          , d = function(t) {
            var e = t["text/plain"];
            return !!e && 0 === e.indexOf("file://")
        }
          , m = function(t) {
            sn.multiple(t).get(function(t) {
                var e = q(t, function(t) {
                    var e = ln.fromTag("img")
                      , n = vt.cata(t, r.getLocalURL, function(t, e, n) {
                        return e
                    });
                    return ze(e, "src", n),
                    e.dom().outerHTML
                }).join("");
                u.insertContent(e, {
                    merge: !1 !== u.settings.paste_merge_formats
                }),
                r.uploadImages(t)
            })
        };
        u.on("drop", function(t) {
            if (!s) {
                if (tinymce.dom.RangeUtils && tinymce.dom.RangeUtils.getCaretRangeFromPoint) {
                    var e = tinymce.dom.RangeUtils.getCaretRangeFromPoint(t.clientX, t.clientY, u.getDoc());
                    e && u.selection.setRng(e)
                }
                var n = (a = (i = t).target.files || i.dataTransfer.files,
                V(a, function(t) {
                    return f.test(t.type)
                }));
                if (0 < n.length)
                    return m(n),
                    void t.preventDefault();
                var r = function(t) {
                    var e = {};
                    if (t) {
                        if (t.getData) {
                            var n = t.getData("Text");
                            n && 0 < n.length && (e["text/plain"] = n)
                        }
                        if (t.types)
                            for (var r = 0; r < t.types.length; r++) {
                                var o = t.types[r];
                                e[o] = t.getData(o)
                            }
                    }
                    return e
                }(t.dataTransfer);
                d(o = r) || !l(o, "text/html") && !l(o, "text/plain") || (to(u, mn.translate, c).showDialog(r["text/html"] || r["text/plain"]),
                t.preventDefault())
            }
            var o, i, a
        })
    }
    var no = function() {
        for (var e = [], t = 0; t < arguments.length; t++)
            e[t] = arguments[t];
        return function() {
            for (var n = [], t = 0; t < arguments.length; t++)
                n[t] = arguments[t];
            if (e.length !== n.length)
                throw new Error('Wrong number of arguments to struct. Expected "[' + e.length + ']", got ' + n.length + " arguments");
            var r = {};
            return $(e, function(t, e) {
                r[t] = v(n[e])
            }),
            r
        }
    }
      , ro = function(t) {
        return t.slice(0).sort()
    }
      , oo = function(e, t) {
        if (!F(t))
            throw new Error("The " + e + " fields must be an array. Was: " + t + ".");
        $(t, function(t) {
            if (!M(t))
                throw new Error("The value " + t + " in the " + e + " fields was not a string.")
        })
    }
      , io = function(o, i) {
        var n, a = o.concat(i);
        if (0 === a.length)
            throw new Error("You must specify at least one required or optional field.");
        return oo("required", o),
        oo("optional", i),
        n = ro(a),
        G(n, function(t, e) {
            return e < n.length - 1 && t === n[e + 1]
        }).each(function(t) {
            throw new Error("The field: " + t + " occurs more than once in the combined fields: [" + n.join(", ") + "].")
        }),
        function(e) {
            var n = ot(e);
            tt(o, function(t) {
                return W(n, t)
            }) || function(t, e) {
                throw new Error("All required keys (" + ro(t).join(", ") + ") were not specified. Specified keys were: " + ro(e).join(", ") + ".")
            }(o, n);
            var t = V(n, function(t) {
                return !W(a, t)
            });
            0 < t.length && function(t) {
                throw new Error("Unsupported keys for object: " + ro(t).join(", "))
            }(t);
            var r = {};
            return $(o, function(t) {
                r[t] = v(e[t])
            }),
            $(i, function(t) {
                r[t] = v(Object.prototype.hasOwnProperty.call(e, t) ? P.some(e[t]) : P.none())
            }),
            r
        }
    }
      , ao = no("id", "imageresult", "objurl");
    function uo() {
        var o = {}
          , n = function(t) {
            Re(t.objurl())
        };
        return {
            add: function(t, e, n) {
                var r = ao(t, e, n);
                return o[t] = r
            },
            get: function(t) {
                return P.from(o[t])
            },
            remove: function(t) {
                var e = o[t];
                delete o[t],
                void 0 !== e && n(e)
            },
            lookupByData: function(e) {
                return function(t, e) {
                    for (var n = ot(t), r = 0, o = n.length; r < o; r++) {
                        var i = n[r]
                          , a = t[i];
                        if (e(a, i, t))
                            return P.some(a)
                    }
                    return P.none()
                }(o, function(t) {
                    return $t(t.imageresult()) === e
                })
            },
            destroy: function() {
                it(o, n),
                o = {}
            }
        }
    }
    function co(t) {
        var n = no.apply(null, t)
          , r = [];
        return {
            bind: function(t) {
                if (void 0 === t)
                    throw "Event bind error: undefined handler";
                r.push(t)
            },
            unbind: function(e) {
                r = V(r, function(t) {
                    return t !== e
                })
            },
            trigger: function() {
                var e = n.apply(null, arguments);
                $(r, function(t) {
                    t(e)
                })
            }
        }
    }
    var so = {
        create: function(t) {
            return {
                registry: at(t, function(t) {
                    return {
                        bind: t.bind,
                        unbind: t.unbind
                    }
                }),
                trigger: at(t, function(t) {
                    return t.trigger
                })
            }
        }
    }
      , fo = function(t) {
        return t.replace(/\./g, "-")
    }
      , lo = function(t, e) {
        return t + "-" + e
    }
      , mo = function(t) {
        var n = fo(t);
        return {
            resolve: function(t) {
                var e = t.split(" ");
                return q(e, function(t) {
                    return lo(n, t)
                }).join(" ")
            }
        }
    }
      , po = {
        resolve: mo("ephox-salmon").resolve
    }
      , go = po.resolve("upload-image-in-progress")
      , vo = "data-" + po.resolve("image-blob")
      , ho = "data-" + po.resolve("image-upload")
      , yo = {
        uploadInProgress: v(go),
        blobId: v(vo),
        trackedImage: v(ho)
    }
      , bo = function(t) {
        var e = Xe(t) ? t.dom().parentNode : t.dom();
        return null != e && e.ownerDocument.body.contains(e)
    }
      , xo = function(t, e) {
        for (var n = [], r = function(t) {
            return n.push(t),
            e(t)
        }, o = e(t); (o = o.bind(r)).isSome(); )
            ;
        return n
    }
      , To = Ue
      , Eo = je
      , wo = function(t, e) {
        var n = t.dom();
        if (n.nodeType !== To)
            return !1;
        if (void 0 !== n.matches)
            return n.matches(e);
        if (void 0 !== n.msMatchesSelector)
            return n.msMatchesSelector(e);
        if (void 0 !== n.webkitMatchesSelector)
            return n.webkitMatchesSelector(e);
        if (void 0 !== n.mozMatchesSelector)
            return n.mozMatchesSelector(e);
        throw new Error("Browser lacks native selectors")
    }
      , Io = function(t) {
        return t.nodeType !== To && t.nodeType !== Eo || 0 === t.childElementCount
    }
      , So = function(t, e) {
        var n = void 0 === e ? l.document : e.dom();
        return Io(n) ? [] : q(n.querySelectorAll(t), ln.fromDom)
    }
      , Lo = function(t, e) {
        var n = void 0 === e ? l.document : e.dom();
        return Io(n) ? P.none() : P.from(n.querySelector(t)).map(ln.fromDom)
    }
      , _o = function(t, e) {
        return t.dom() === e.dom()
    }
      , No = (Pe.detect().browser.isIE(),
    wo)
      , Co = function(t) {
        return ln.fromDom(t.dom().ownerDocument)
    }
      , Oo = function(t) {
        var e = t.dom();
        return P.from(e.parentNode).map(ln.fromDom)
    }
      , Do = function(t, e) {
        for (var n = U(e) ? e : v(!1), r = t.dom(), o = []; null !== r.parentNode && void 0 !== r.parentNode; ) {
            var i = r.parentNode
              , a = ln.fromDom(i);
            if (o.push(a),
            !0 === n(a))
                break;
            r = i
        }
        return o
    }
      , Ao = function(t) {
        var e = t.dom();
        return P.from(e.previousSibling).map(ln.fromDom)
    }
      , Po = function(t) {
        var e = t.dom();
        return P.from(e.nextSibling).map(ln.fromDom)
    }
      , ko = function(t) {
        return nt(xo(t, Ao))
    }
      , Mo = function(t) {
        var e = t.dom();
        return q(e.childNodes, ln.fromDom)
    }
      , Ro = function(t, e) {
        var n = t.dom().childNodes;
        return P.from(n[e]).map(ln.fromDom)
    }
      , Fo = function(t) {
        return Ro(t, 0)
    }
      , jo = function(t) {
        return t.dom().childNodes.length
    }
      , Uo = function(t) {
        return t.dom().hasChildNodes()
    }
      , Bo = (no("element", "offset"),
    function(t, e) {
        var n = [];
        return $(Mo(t), function(t) {
            e(t) && (n = n.concat([t])),
            n = n.concat(Bo(t, e))
        }),
        n
    }
    )
      , Yo = function(t, e) {
        return So(e, t)
    }
      , Wo = yo.trackedImage()
      , Ho = function(t, e) {
        return Yo(t, "img[" + Wo + '="' + e + '"]')
    }
      , qo = function(t) {
        return Yo(t, "img:not([" + Wo + "])[" + yo.blobId() + "]")
    };
    function $o() {
        var o = []
          , i = []
          , t = so.create({
            complete: co(["response"])
        })
          , a = function() {
            t.trigger.complete(i),
            i = []
        }
          , u = function() {
            return 0 < o.length
        };
        return {
            findById: Ho,
            findAll: qo,
            register: function(t, e) {
                ze(t, Wo, e),
                o.push(e)
            },
            report: function(t, e, r) {
                var n;
                $(e, function(t) {
                    var e, n;
                    Qe(t, Wo),
                    e = r,
                    n = t,
                    i.push({
                        success: e,
                        element: n.dom()
                    })
                }),
                n = t,
                o = V(o, function(t, e) {
                    return t !== n
                }),
                !1 === u() && a()
            },
            inProgress: u,
            isActive: function(t) {
                return W(o, t)
            },
            events: t.registry
        }
    }
    var Vo = ft([{
        get: []
    }, {
        post: []
    }, {
        put: []
    }, {
        del: []
    }])
      , Xo = {
        get: Vo.get,
        post: Vo.post,
        put: Vo.put,
        del: Vo.del
    }
      , Go = function(t, e, n, r) {
        var o = t.bind(function(t) {
            return t.match({
                file: function() {
                    return P.none()
                },
                form: function() {
                    return P.some("application/x-www-form-urlencoded; charset=UTF-8")
                },
                json: function() {
                    return P.some("application/json")
                },
                plain: function() {
                    return P.some("text/plain")
                },
                html: function() {
                    return P.some("text/html")
                }
            })
        })
          , i = n.match({
            none: P.none,
            xhr: v(P.some(!0))
        })
          , a = e.match({
            json: P.none,
            blob: v(P.some("blob")),
            xml: v(P.some("document")),
            html: v(P.some("document")),
            text: v(P.some("text"))
        })
          , u = e.match({
            json: v("application/json, text/javascript"),
            blob: v("application/octet-stream"),
            text: v("text/plain"),
            html: v("text/html"),
            xml: v("application/xml, text/xml")
        }) + ", */*; q=0.01"
          , c = r;
        return {
            contentType: v(o),
            credentials: v(i),
            responseType: v(a),
            accept: v(u),
            headers: v(c)
        }
    }
      , zo = function(n, t) {
        t.contentType().each(function(t) {
            n.setRequestHeader("Content-Type", t)
        });
        var e = t.accept();
        n.setRequestHeader("Accept", e),
        t.credentials().each(function(t) {
            n.withCredentials = t
        }),
        t.responseType().each(function(t) {
            n.responseType = t
        });
        var r = t.headers();
        it(r, function(t, e) {
            M(e) || M(t) ? n.setRequestHeader(e, t) : l.console.error("Request header data was not a string: ", e, " -> ", t)
        })
    }
      , Ko = function(e) {
        return zt.nu(function(n) {
            var t = Et();
            t.onload = function(t) {
                var e = t.target;
                n(e.result)
            }
            ,
            t.readAsText(e)
        })
    }
      , Zo = function(n) {
        return {
            is: function(t) {
                return n === t
            },
            isValue: _,
            isError: S,
            getOr: v(n),
            getOrThunk: v(n),
            getOrDie: v(n),
            or: function(t) {
                return Zo(n)
            },
            orThunk: function(t) {
                return Zo(n)
            },
            fold: function(t, e) {
                return e(n)
            },
            map: function(t) {
                return Zo(t(n))
            },
            mapError: function(t) {
                return Zo(n)
            },
            each: function(t) {
                t(n)
            },
            bind: function(t) {
                return t(n)
            },
            exists: function(t) {
                return t(n)
            },
            forall: function(t) {
                return t(n)
            },
            toOption: function() {
                return P.some(n)
            }
        }
    }
      , Jo = function(n) {
        return {
            is: S,
            isValue: S,
            isError: _,
            getOr: p,
            getOrThunk: function(t) {
                return t()
            },
            getOrDie: function() {
                return I(String(n))()
            },
            or: function(t) {
                return t
            },
            orThunk: function(t) {
                return t()
            },
            fold: function(t, e) {
                return t(n)
            },
            map: function(t) {
                return Jo(n)
            },
            mapError: function(t) {
                return Jo(t(n))
            },
            each: L,
            bind: function(t) {
                return Jo(n)
            },
            exists: S,
            forall: _,
            toOption: P.none
        }
    }
      , Qo = {
        value: Zo,
        error: Jo,
        fromOption: function(t, e) {
            return t.fold(function() {
                return Jo(e)
            }, Zo)
        }
    }
      , ti = function() {
        return xt.getOrDie("JSON")
    }
      , ei = {
        parse: function(t) {
            return ti().parse(t)
        },
        stringify: function(t, e, n) {
            return ti().stringify(t, e, n)
        }
    }
      , ni = function(t) {
        try {
            var e = ei.parse(t);
            return Qo.value(e)
        } catch (t) {
            return Qo.error("Response was not JSON")
        }
    }
      , ri = io(["message", "status", "responseText"], [])
      , oi = function(t) {
        var e = ri(t);
        return e.toString = e.message,
        e
    }
      , ii = {
        handle: function(n, t, r) {
            var e = function() {
                return zt.pure(r.response)
            };
            return t.match({
                json: function() {
                    return ni(r.response).fold(e, zt.pure)
                },
                blob: function() {
                    return t = r,
                    P.from(t.response).map(Ko).getOr(zt.pure("no response content"));
                    var t
                },
                text: e,
                html: e,
                xml: e
            }).map(function(t) {
                var e = 0 === r.status ? "Unknown HTTP error (possible cross-domain request)" : 'Could not load url "' + n + '": ' + r.statusText;
                return oi({
                    message: e,
                    status: r.status,
                    responseText: t
                })
            })
        },
        nu: oi
    }
      , ai = function() {
        return (ai = Object.assign || function(t) {
            for (var e, n = 1, r = arguments.length; n < r; n++)
                for (var o in e = arguments[n])
                    Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
            return t
        }
        ).apply(this, arguments)
    }
      , ui = function(i) {
        return ai({}, i, {
            toCached: function() {
                return ui(i.toCached())
            },
            bindFuture: function(e) {
                return ui(i.bind(function(t) {
                    return t.fold(function(t) {
                        return zt.pure(Qo.error(t))
                    }, function(t) {
                        return e(t)
                    })
                }))
            },
            bindResult: function(e) {
                return ui(i.map(function(t) {
                    return t.bind(e)
                }))
            },
            mapResult: function(e) {
                return ui(i.map(function(t) {
                    return t.map(e)
                }))
            },
            mapError: function(e) {
                return ui(i.map(function(t) {
                    return t.mapError(e)
                }))
            },
            foldResult: function(e, n) {
                return i.map(function(t) {
                    return t.fold(e, n)
                })
            },
            withTimeout: function(t, o) {
                return ui(zt.nu(function(e) {
                    var n = !1
                      , r = l.setTimeout(function() {
                        n = !0,
                        e(Qo.error(o()))
                    }, t);
                    i.get(function(t) {
                        n || (l.clearTimeout(r),
                        e(t))
                    })
                }))
            }
        })
    }
      , ci = function(t) {
        return ui(zt.nu(t))
    }
      , si = function(t) {
        return ui(zt.pure(Qo.value(t)))
    }
      , fi = ci
      , li = si
      , di = function(t) {
        return ui(zt.pure(Qo.error(t)))
    }
      , mi = function(t, e) {
        var n, r, o = function() {
            return li(e.response)
        }, i = function(t) {
            return ii.nu({
                message: t,
                status: e.status,
                responseText: e.responseText
            })
        };
        return t.match({
            json: function() {
                return ni(e.response).fold(function(t) {
                    return di(i(t))
                }, li)
            },
            blob: o,
            text: o,
            html: o,
            xml: (n = "Invalid XML document",
            r = o,
            function() {
                return r().bindResult(function(t) {
                    return null === t ? Qo.error(i(n)) : Qo.value(t)
                })
            }
            )
        })
    }
      , pi = function(i, a, u, c, s, t) {
        var f = void 0 !== t ? t : {};
        return fi(function(e) {
            var t = a.match({
                get: v("get"),
                put: v("put"),
                post: v("post"),
                del: v("delete")
            })
              , n = new (xt.getOrDie("XMLHttpRequest"));
            n.open(t, i, !0);
            var r = Go(u, c, s, f);
            zo(n, r);
            var o = function() {
                ii.handle(i, c, n).get(function(t) {
                    e(Qo.error(t))
                })
            };
            n.onload = function() {
                0 !== n.status || Ie(i, "file:") ? n.status < 100 || 400 <= n.status ? o() : mi(c, n).get(e) : o()
            }
            ,
            n.onerror = o,
            u.fold(function() {
                n.send()
            }, function(t) {
                var e = t.match({
                    file: p,
                    form: p,
                    json: ei.stringify,
                    plain: p,
                    html: p
                });
                n.send(e)
            })
        }).toLazy()
    }
      , gi = ft([{
        file: ["data"]
    }, {
        form: ["data"]
    }, {
        json: ["data"]
    }, {
        plain: ["data"]
    }, {
        html: ["data"]
    }])
      , vi = {
        file: gi.file,
        form: gi.form,
        json: gi.json,
        plain: gi.plain,
        html: gi.html
    }
      , hi = ft([{
        none: []
    }, {
        xhr: []
    }])
      , yi = {
        none: hi.none,
        xhr: hi.xhr
    }
      , bi = ft([{
        json: []
    }, {
        blob: []
    }, {
        text: []
    }, {
        html: []
    }, {
        xml: []
    }])
      , xi = {
        json: bi.json,
        blob: bi.blob,
        text: bi.text,
        html: bi.html,
        xml: bi.xml,
        cata: function(t, e, n, r, o, i) {
            return t.match({
                json: e,
                blob: n,
                text: r,
                html: o,
                xml: i
            })
        }
    }
      , Ti = no("message", "status", "contents")
      , Ei = ["jpg", "png", "gif", "jpeg"]
      , wi = {
        failureObject: Ti,
        getFilename: function(t, e) {
            return M(t.name) && !Se(t.name, ".tmp") ? t.name : function(t, e) {
                if (M(t.type) && Ie(t.type, "image/")) {
                    var n = t.type.substr("image/".length);
                    return W(Ei, n) ? e + "." + n : e
                }
                return e
            }(t, e)
        },
        buildData: function(t, e, n) {
            var r = new (xt.getOrDie("FormData"));
            return r.append(t, e, n),
            r
        }
    }
      , Ii = function(t) {
        var e = "";
        return "" !== t.protocol && (e += t.protocol,
        e += ":"),
        "" !== t.authority && (e += "//",
        e += t.authority),
        e += t.path,
        "" !== t.query && (e += "?",
        e += t.query),
        "" !== t.anchor && (e += "#",
        e += t.anchor),
        e
    }
      , Si = {
        strictMode: !1,
        key: ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"],
        q: {
            name: "queryKey",
            parser: /(?:^|&)([^&=]*)=?([^&]*)/g
        },
        parser: {
            strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
            loose: /^(?:(?![^:@\/]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
        }
    }
      , Li = function(t, e) {
        return function(t, e) {
            for (var r = e, n = r.parser[r.strictMode ? "strict" : "loose"].exec(t), o = {}, i = 14; i--; )
                o[r.key[i]] = n[i] || "";
            return o[r.q.name] = {},
            o[r.key[12]].replace(r.q.parser, function(t, e, n) {
                e && (o[r.q.name][e] = n)
            }),
            o
        }(t, pt(Si, e))
    }
      , _i = function(t) {
        return Te(t, Ni(t))
    }
      , Ni = function(t) {
        return t.substring(t.lastIndexOf("/"))
    }
      , Ci = function(t) {
        for (var e = t, n = ""; "" !== e; )
            if (Ie(e, "../"))
                e = xe(e, "../");
            else if (Ie(e, "./"))
                e = xe(e, "./");
            else if (Ie(e, "/./"))
                e = "/" + xe(e, "/./");
            else if ("/." === e)
                e = "/";
            else if (Ie(e, "/../"))
                e = "/" + xe(e, "/../"),
                n = _i(n);
            else if ("/.." === e)
                e = "/",
                n = _i(n);
            else if ("." === e || ".." === e)
                e = "";
            else {
                var r = e.match(/(^\/?.*?)(\/|$)/)[1];
                e = xe(e, r),
                n += r
            }
        return n
    }
      , Oi = function(t, e, n) {
        if ("" !== n && "" === t)
            return "/" + e;
        var r = t.substring(t.lastIndexOf("/") + 1);
        return Te(t, r) + e
    }
      , Di = function(t, e) {
        var n = {
            strictMode: !0
        }
          , r = Li(t, n)
          , o = Li(e, n)
          , i = {};
        return "" !== o.protocol ? (i.protocol = o.protocol,
        i.authority = o.authority,
        i.path = Ci(o.path),
        i.query = o.query) : ("" !== o.authority ? (i.authority = o.authority,
        i.path = Ci(o.path),
        i.query = o.query) : ("" === o.path ? (i.path = r.path,
        "" !== o.query ? i.query = o.query : i.query = r.query) : (Ie(o.path, "/") ? i.path = Ci(o.path) : (i.path = Oi(r.path, o.path, t.authority),
        i.path = Ci(i.path)),
        i.query = o.query),
        i.authority = r.authority),
        i.protocol = r.protocol),
        i.anchor = o.anchor,
        i
    }
      , Ai = function(t, e) {
        var n = Di(t, e);
        return Ii(n)
    };
    function Pi(d) {
        var t, e, n, r, m = (t = d.url,
        e = t.lastIndexOf("/"),
        n = 0 < e ? t.substr(0, e) : t,
        r = void 0 === d.basePath ? n : d.basePath,
        Se(r, "/") ? r : r + "/"), o = function(t, e, f) {
            var n, r, o, i, a, u, l = wi.getFilename(t, e), c = !0 === d.credentials ? yi.xhr() : yi.none(), s = vi.file(wi.buildData("image", t, l));
            (n = d.url,
            r = s,
            o = xi.text(),
            i = c,
            u = Xo.post(),
            pi(n, u, P.some(r), o, i, a)).map(function(t) {
                t.fold(function(t) {
                    f(Qo.error(wi.failureObject(t.message(), t.status(), t.responseText())))
                }, function(e) {
                    var n, t, r, o;
                    try {
                        var i = ei.parse(e);
                        if (!M(i.location))
                            return t = "JSON response did not contain a string location",
                            r = 500,
                            o = e,
                            void f(Qo.error(wi.failureObject(t, r, o)));
                        n = i.location
                    } catch (t) {
                        n = e
                    }
                    var a, u, c, s = (a = l,
                    u = n.split(/\s+/),
                    c = 1 === u.length && "" !== u[0] ? u[0] : a,
                    Ai(m, c));
                    f(Qo.value({
                        location: s
                    }))
                })
            })
        };
        return {
            upload: function(t, e, n) {
                var r = t.imageresult();
                Ht(r).then(function(t) {
                    o(t, e, n)
                })
            }
        }
    }
    no("id", "filename", "blob", "base64");
    var ki = function(t) {
        return Pi(t)
    }
      , Mi = function(t, e) {
        var n = Ze(t, e);
        return void 0 === n || "" === n ? [] : n.split(" ")
    }
      , Ri = function(t) {
        return void 0 !== t.dom().classList
    }
      , Fi = function(t) {
        return Mi(t, "class")
    }
      , ji = function(t, e) {
        return o = e,
        i = Mi(n = t, r = "class").concat([o]),
        ze(n, r, i.join(" ")),
        !0;
        var n, r, o, i
    }
      , Ui = function(t, e) {
        return o = e,
        0 < (i = V(Mi(n = t, r = "class"), function(t) {
            return t !== o
        })).length ? ze(n, r, i.join(" ")) : Qe(n, r),
        !1;
        var n, r, o, i
    }
      , Bi = function(t, e) {
        Ri(t) ? t.dom().classList.add(e) : ji(t, e)
    }
      , Yi = function(t, e) {
        var n;
        Ri(t) ? t.dom().classList.remove(e) : Ui(t, e),
        0 === (Ri(n = t) ? n.dom().classList : Fi(n)).length && Qe(n, "class")
    }
      , Wi = function(t, e) {
        return Ri(t) && t.dom().classList.contains(e)
    }
      , Hi = function(e, t) {
        $(t, function(t) {
            Bi(e, t)
        })
    }
      , qi = function(t) {
        return Ri(t) ? function(t) {
            for (var e = t.dom().classList, n = new Array(e.length), r = 0; r < e.length; r++)
                n[r] = e.item(r);
            return n
        }(t) : Fi(t)
    }
      , $i = function(e) {
        return function(t) {
            return Wi(t, e)
        }
    }
      , Vi = function(t, e, n) {
        for (var r = t.dom(), o = U(n) ? n : v(!1); r.parentNode; ) {
            r = r.parentNode;
            var i = ln.fromDom(r);
            if (e(i))
                return P.some(i);
            if (o(i))
                break
        }
        return P.none()
    }
      , Xi = function(t, e) {
        return G(t.dom().childNodes, g(e, ln.fromDom)).map(ln.fromDom)
    }
      , Gi = function(t, r) {
        var o = function(t) {
            for (var e = 0; e < t.childNodes.length; e++) {
                if (r(ln.fromDom(t.childNodes[e])))
                    return P.some(ln.fromDom(t.childNodes[e]));
                var n = o(t.childNodes[e]);
                if (n.isSome())
                    return n
            }
            return P.none()
        };
        return o(t.dom())
    }
      , zi = function(t) {
        return Lo(t)
    }
      , Ki = function(t, e, n) {
        return Vi(t, function(t) {
            return wo(t, e)
        }, n)
    }
      , Zi = function(t, e) {
        return Lo(e, t)
    }
      , Ji = function(t, e, n) {
        return r = Ki,
        a = n,
        wo(o = t, i = e) ? P.some(o) : U(a) && a(o) ? P.none() : r(o, i, a);
        var r, o, i, a
    }
      , Qi = no("image", "blobInfo")
      , ta = ft([{
        failure: ["error"]
    }, {
        success: ["result", "images", "blob"]
    }])
      , ea = function(t, e, n, r, o) {
        var i = $t(n)
          , a = t.lookupByData(i).getOrThunk(function() {
            return t.add(e, n, r)
        });
        return ze(o, yo.blobId(), a.id()),
        Qi(o, a)
    }
      , na = function(e, n) {
        return e.get(n).fold(function() {
            return Qo.error("Internal error with blob cache")
        }, function(t) {
            return e.remove(n),
            Qo.value(t)
        })
    }
      , ra = function(t, e, n) {
        var r = t.isActive(e);
        return t.register(n, e),
        Bi(n, yo.uploadInProgress()),
        r ? P.none() : P.some(e)
    }
      , oa = function(t, n, a, r, u, e, c) {
        var s = function() {
            l.console.error("Internal error with blob cache", u),
            c(ta.failure({
                status: v(666)
            }))
        };
        t.upload(e, u, function(t) {
            var e, i = n.findById(r, u);
            $(i, (e = yo.uploadInProgress(),
            function(t) {
                Yi(t, e)
            }
            )),
            t.fold(function(t) {
                c(ta.failure(t))
            }, function(e) {
                var t, n, r, o;
                (t = a,
                n = i,
                r = u,
                o = e,
                $(n, function(t) {
                    ze(t, "src", o.location),
                    Qe(t, yo.blobId())
                }),
                na(t, r)).fold(s, function(t) {
                    c(ta.success(e, i, t))
                })
            }),
            n.report(u, i, t.isValue())
        })
    }
      , ia = function(o, i, t) {
        return Q(t, function(t) {
            return vt.cata(t, function(e, n, r) {
                return Zi(i, 'img[src="' + r + '"]').fold(function() {
                    return [Qo.error("Image that was just inserted could not be found: " + r)]
                }, function(t) {
                    return [Qo.value(ea(o, e, n, r, t))]
                })
            }, v([]))
        })
    }
      , aa = function(t, o, e) {
        var n = t.findAll(e);
        return t.inProgress() ? [] : q(n, function(t) {
            return e = o,
            r = Ze(n = t, yo.blobId()),
            e.get(r).fold(function() {
                return Qo.error(r)
            }, function(t) {
                return Qo.value(Qi(n, t))
            });
            var e, n, r
        })
    }
      , ua = function(t) {
        return parseInt(t, 10)
    }
      , ca = function(t, e, n) {
        return {
            major: v(t),
            minor: v(e),
            patch: v(n)
        }
    }
      , sa = {
        getTinymceVersion: function() {
            var t, e, n = [tinymce.majorVersion, tinymce.minorVersion].join(".");
            return t = n.split(".").slice(0, 3).join("."),
            (e = /([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(t)) ? ca(ua(e[1]), ua(e[2]), ua(e[3])) : ca(0, 0, 0)
        }
    };
    function fa(c) {
        var s = function(t, e) {
            return v(4 === (o = sa.getTinymceVersion()).major() && o.minor() < 6 ? t : t + "." + (n = e.toLowerCase(),
            (r = {
                "image/jpeg": "jpg",
                "image/jpg": "jpg",
                "image/gif": "gif",
                "image/png": "png"
            }).hasOwnProperty(n) ? r[n] : "dat"));
            var n, r, o
        };
        return {
            importImages: function(t) {
                var e = Q(t, function(t) {
                    return vt.cata(t, function(t, e, n) {
                        var r, o, i, a, u = $t(e);
                        return [(r = t,
                        o = e,
                        i = u,
                        a = n,
                        zt.nu(function(e) {
                            qt(o).then(function(t) {
                                c.editorUpload.blobCache.add({
                                    id: v(r),
                                    name: v(r),
                                    filename: s(r, t.type),
                                    blob: v(t),
                                    base64: v(i.split(",")[1]),
                                    blobUri: v(a),
                                    uri: v(null)
                                }),
                                e(t)
                            })
                        }))]
                    }, v([]))
                });
                return Zt(e)
            },
            uploadImages: function() {
                c.uploadImages()
            },
            prepareImages: L,
            getLocalURL: function(t, e, n) {
                return $t(e)
            }
        }
    }
    var la = function(t, e) {
        var n = (e || l.document).createElement("div");
        return n.innerHTML = t,
        Mo(ln.fromDom(n))
    }
      , da = function(e, n) {
        Oo(e).each(function(t) {
            t.dom().insertBefore(n.dom(), e.dom())
        })
    }
      , ma = function(t, e) {
        Po(t).fold(function() {
            Oo(t).each(function(t) {
                ga(t, e)
            })
        }, function(t) {
            da(t, e)
        })
    }
      , pa = function(e, n) {
        Fo(e).fold(function() {
            ga(e, n)
        }, function(t) {
            e.dom().insertBefore(n.dom(), t.dom())
        })
    }
      , ga = function(t, e) {
        t.dom().appendChild(e.dom())
    }
      , va = function(t, e) {
        da(t, e),
        ga(e, t)
    }
      , ha = function(r, o) {
        $(o, function(t, e) {
            var n = 0 === e ? r : o[e - 1];
            ma(n, t)
        })
    }
      , ya = function(e, t) {
        $(t, function(t) {
            ga(e, t)
        })
    }
      , ba = function(t) {
        Yi(t, yo.uploadInProgress())
    }
      , xa = function(t) {
        for (var e = 0; e < t.undoManager.data.length; e++) {
            var n = t.undoManager.data[e].content
              , r = ln.fromTag("div");
            ya(r, la(n));
            var o = Yo(r, "." + yo.uploadInProgress());
            $(o, ba),
            t.undoManager.data[e].content = r.dom().innerHTML
        }
    }
      , Ta = function(t, e, n) {
        for (var r = 0; r < t.undoManager.data.length; r++)
            t.undoManager.data[r].content = t.undoManager.data[r].content.split(e.objurl()).join(n.location)
    }
      , Ea = {
        showDialog: function(t, e) {
            var n, r = {
                title: "Error",
                spacing: 10,
                padding: 10,
                items: [{
                    type: "container",
                    html: e
                }],
                buttons: [{
                    text: "Ok",
                    onclick: function() {
                        n.close()
                    }
                }]
            };
            n = t.windowManager.open(r)
        }
    }
      , wa = function(r, t) {
        var o, e, i, a, u, n, c = uo(), s = $o(), f = (o = r,
        e = t.url,
        i = Ea,
        a = function() {
            return mn.translate("error.code.images.not.found") + e + mn.translate("error.full.stop")
        }
        ,
        u = function() {
            return mn.translate("error.imageupload") + e + mn.translate("error.full.stop")
        }
        ,
        n = function(t) {
            var e = t.status()
              , n = 0 === e || 400 <= e || e < 500 ? a : u;
            i.showDialog(o, n())
        }
        ,
        {
            instance: function() {
                return t = n,
                e = !1,
                function() {
                    e || (e = !0,
                    t.apply(null, arguments))
                }
                ;
                var t, e
            }
        }), l = ki(t), d = function() {
            return ln.fromDom(r.getBody())
        }, m = function(e, t, n) {
            $(t, function(t) {
                ze(t, "data-mce-src", e.location)
            }),
            Ta(r, n, e)
        };
        s.events.complete.bind(function(t) {
            xa(r)
        });
        var p = function(o, i) {
            ra(s, o.blobInfo().id(), o.image()).each(function(t) {
                var e, n, r;
                e = t,
                n = o.blobInfo(),
                r = i,
                oa(l, s, c, d(), e, n, function(t) {
                    t.fold(function(t) {
                        r(t)
                    }, m)
                })
            })
        };
        return {
            importImages: function() {
                return zt.pure([])
            },
            uploadImages: function(t) {
                var e, n, r, o, i;
                e = f.instance(),
                n = aa(s, c, d()),
                $(n, function(t) {
                    t.fold(function(t) {
                        s.report(t, P.none(), !1)
                    }, function(t) {
                        p(t, e)
                    })
                }),
                r = t,
                o = f.instance(),
                i = ia(c, d(), r),
                $(i, function(t) {
                    t.fold(function(t) {
                        console.error(t)
                    }, function(t) {
                        p(t, o)
                    })
                })
            },
            prepareImages: L,
            getLocalURL: function(t, e, n) {
                return n
            }
        }
    }
      , Ia = function(o) {
        var t = fa(o);
        return {
            importImages: function() {
                return zt.pure([])
            },
            uploadImages: L,
            prepareImages: function(t) {
                $(t, function(t) {
                    vt.cata(t, function(t, e, n) {
                        var r = $t(e);
                        $(o.dom.select('img[src="' + n + '"]'), function(t) {
                            o.dom.setAttrib(t, "src", r)
                        })
                    }, L)
                })
            },
            getLocalURL: t.getLocalURL
        }
    };
    function Sa(t) {
        return void 0 !== t.uploadImages ? fa(t) : function(t) {
            if (a(t)) {
                var e = {
                    url: t.settings.images_upload_url,
                    basePath: t.settings.images_upload_base_path,
                    credentials: t.settings.images_upload_credentials
                };
                return wa(t, e)
            }
            return Ia(t)
        }(t)
    }
    var La = function(e, r, t, n) {
        var o, i, a, u, c, s = e.selection, f = e.dom, l = e.getBody();
        if (c = t.isText(),
        t.reset(),
        n.clipboardData && n.clipboardData.getData("text/html")) {
            n.preventDefault();
            var d = n.clipboardData.getData("text/html")
              , m = d.match(/<html[\s\S]+<\/html>/i)
              , p = null === m ? d : m[0];
            return r(p)
        }
        if (!f.get("_mcePaste")) {
            if (o = f.add(l, "div", {
                id: "_mcePaste",
                class: "mcePaste"
            }, '\ufeff<br _mce_bogus="1">'),
            u = l !== e.getDoc().body ? f.getPos(e.selection.getStart(), l).y : l.scrollTop,
            f.setStyles(o, {
                position: "absolute",
                left: -1e4,
                top: u,
                width: 1,
                height: 1,
                overflow: "hidden"
            }),
            tinymce.isIE)
                return (a = f.doc.body.createTextRange()).moveToElementText(o),
                a.execCommand("Paste"),
                f.remove(o),
                "\ufeff" === o.innerHTML ? (e.execCommand("mcePasteWord"),
                void n.preventDefault()) : (r(c ? o.innerText : o.innerHTML),
                tinymce.dom.Event.cancel(n));
            var g = function(t) {
                t.preventDefault()
            };
            if (f.bind(e.getDoc(), "mousedown", g),
            f.bind(e.getDoc(), "keydown", g),
            tinymce.isGecko && (a = e.selection.getRng(!0)).startContainer === a.endContainer && 3 === a.startContainer.nodeType) {
                var v = f.select("p,h1,h2,h3,h4,h5,h6,pre", o);
                1 === v.length && f.remove(v.reverse(), !0)
            }
            i = e.selection.getRng(),
            o = o.firstChild,
            (a = e.getDoc().createRange()).setStart(o, 0),
            a.setEnd(o, 1),
            s.setRng(a),
            window.setTimeout(function() {
                var n = ""
                  , t = f.select("div.mcePaste");
                gn.each(t, function(t) {
                    var e = t.firstChild;
                    e && "DIV" === e.nodeName && e.style.marginTop && e.style.backgroundColor && f.remove(e, 1),
                    gn.each(f.select("div.mcePaste", t), function(t) {
                        f.remove(t, 1)
                    }),
                    gn.each(f.select("span.Apple-style-span", t), function(t) {
                        f.remove(t, 1)
                    }),
                    gn.each(f.select("br[_mce_bogus]", t), function(t) {
                        f.remove(t)
                    }),
                    n += t.innerHTML
                }),
                gn.each(t, function(t) {
                    f.remove(t)
                }),
                i && s.setRng(i),
                r(n),
                f.unbind(e.getDoc(), "mousedown", g),
                f.unbind(e.getDoc(), "keydown", g)
            }, 0)
        }
    }
      , _a = {
        getOnPasteFunction: function(e, n, r) {
            return function(t) {
                La(e, n, r, t)
            }
        },
        getOnKeyDownFunction: function(e, n, r) {
            return function(t) {
                (tinymce.isOpera || 0 < navigator.userAgent.indexOf("Firefox/2")) && ((tinymce.isMac ? t.metaKey : t.ctrlKey) && 86 === t.keyCode || t.shiftKey && 45 === t.keyCode) && La(e, n, r, t)
            }
        }
    };
    function Na() {
        var o = {};
        return {
            getOrSetIndexed: function(t, e) {
                return void 0 !== o[t] ? o[t] : (n = t,
                r = e(),
                o[n] = r);
                var n, r
            },
            waitForLoad: function() {
                var t = ct(o);
                return Zt(t)
            }
        }
    }
    var Ca, Oa, Da = function(u) {
        var c = y(bt, u);
        bt("callbacks", c());
        var e = function(t, e) {
            var n, r, o, i = c(), a = (r = void 0 === (n = i).count ? 0 : n.count,
            o = "callback_" + r,
            n.count = r + 1,
            o);
            return i.callbacks[a] = function() {
                e || s(a),
                t.apply(null, arguments)
            }
            ,
            u + ".callbacks." + a
        }
          , s = function(t) {
            var e = t.substring(t.lastIndexOf(".") + 1)
              , n = c();
            void 0 !== n.callbacks[e] && delete n.callbacks[e]
        };
        return {
            ephemeral: function(t) {
                return e(t, !1)
            },
            permanent: function(t) {
                return e(t, !0)
            },
            unregister: s
        }
    }, Aa = function(m, p) {
        return function(t) {
            if (m(t)) {
                var e, n, r, o, i, a, u, c = ln.fromDom(t.target), s = function() {
                    t.stopPropagation()
                }, f = function() {
                    t.preventDefault()
                }, l = g(f, s), d = (e = c,
                n = t.clientX,
                r = t.clientY,
                o = s,
                i = f,
                a = l,
                u = t,
                {
                    target: v(e),
                    x: v(n),
                    y: v(r),
                    stop: o,
                    prevent: i,
                    kill: a,
                    raw: v(u)
                });
                p(d)
            }
        }
    }, Pa = function(t, e, n, r, o) {
        var i = Aa(n, r);
        return t.dom().addEventListener(e, i, o),
        {
            unbind: y(ka, t, e, i, o)
        }
    }, ka = function(t, e, n, r) {
        t.dom().removeEventListener(e, n, r)
    }, Ma = v(!0), Ra = function(t, e, n) {
        return Pa(t, e, Ma, n, !1)
    }, Fa = Da("ephox.henchman.features"), ja = function(i) {
        return Xt.nu(function(e) {
            var t = function() {
                r.unbind(),
                o.unbind()
            }
              , n = ln.fromTag("script");
            ze(n, "src", i),
            ze(n, "type", "text/javascript"),
            ze(n, "async", "async"),
            ze(n, "data-main", Fa.ephemeral(function(t) {
                e(Qo.value(t))
            }));
            var r = Ra(n, "error", function() {
                t(),
                e(Qo.error("Error loading external script tag " + i))
            })
              , o = Ra(n, "load", t);
            ga(ln.fromDom(l.document.head), n)
        })
    }, Ua = function(t, e) {
        var n, r, o, i = e || ln.fromDom(l.document), a = ln.fromTag("link", i.dom());
        return Ke(a, {
            rel: "stylesheet",
            type: "text/css",
            href: t
        }),
        n = i,
        r = a,
        o = ln.fromDom(n.dom().head),
        ga(o, r),
        a
    }, Ba = function(o, i) {
        return Xt.nu(function(e) {
            var n = function(t) {
                $(r, function(t) {
                    t.unbind()
                }),
                e(t.fold(function(t) {
                    return Qo.error(t + 'Unable to download editor stylesheets from "' + o + '"')
                }, Qo.value))
            }
              , t = Ua(o)
              , r = [Ra(t, "load", function(t) {
                !function(t) {
                    try {
                        var e = t.target().dom().sheet.cssRules;
                        return R(e) && 0 === e.length
                    } catch (t) {}
                    return !1
                }(t) ? i(n) : n(Qo.error(""))
            }), Ra(t, "error", y(n, Qo.error("")))]
        })
    }, Ya = (Ca = Na(),
    {
        preload: function() {
            Oa().get(p)
        },
        addStylesheet: function(t, e) {
            return Ca.getOrSetIndexed(t, function() {
                return Ba(t, e)
            })
        },
        addScript: function(t, e) {
            return Ca.getOrSetIndexed(t, function() {
                return ja(t).map(e)
            })
        },
        waitForLoad: Oa = function() {
            return Ca.waitForLoad()
        }
    }), Wa = function(t, e) {
        return Ya.addScript(t, e)
    }, Ha = Pe.detect(), qa = Ha.deviceType.isiOS() || Ha.deviceType.isAndroid(), $a = v({
        isSupported: v(!1),
        cleanDocument: v(di("not supported"))
    }), Va = qa ? $a : function(t) {
        var r = Wa(t + "/wordimport.js", p);
        return r.get(function(t) {
            t.fold(function(t) {
                l.console.error("Unable to load word import: ", t)
            }, L)
        }),
        {
            isSupported: v(!0),
            cleanDocument: function(e, n) {
                return r.map(function(t) {
                    return t.map(function(t) {
                        return t.cleanDocument(e, n)
                    })
                })
            }
        }
    }
    ;
    function Xa(t, e, n, r) {
        var o = _o(t, n) && e === r;
        return {
            startContainer: v(t),
            startOffset: v(e),
            endContainer: v(n),
            endOffset: v(r),
            collapsed: v(o)
        }
    }
    var Ga, za, Ka = function(t) {
        t.dom().textContent = "",
        $(Mo(t), function(t) {
            Za(t)
        })
    }, Za = function(t) {
        var e = t.dom();
        null !== e.parentNode && e.parentNode.removeChild(e)
    }, Ja = function(t) {
        var e, n = Mo(t);
        0 < n.length && (e = t,
        $(n, function(t) {
            da(e, t)
        })),
        Za(t)
    }, Qa = function() {
        var t = !1;
        return {
            isBlocked: function() {
                return t
            },
            block: function() {
                t = !0
            },
            unblock: function() {
                t = !1
            }
        }
    }, tu = function(t, e) {
        return {
            control: t,
            instance: e
        }
    }, eu = {
        tap: function(n) {
            var r = Qa();
            return tu(r, function() {
                for (var t = [], e = 0; e < arguments.length; e++)
                    t[e] = arguments[e];
                r.isBlocked() || n.apply(null, t)
            })
        }
    }, nu = Pe.detect(), ru = nu.browser.isIE() && nu.browser.version.major <= 10, ou = ru ? function(t, e, n) {
        e.control.block(),
        t.dom().execCommand("paste"),
        n(),
        e.control.unblock()
    }
    : function(t, e, n) {
        setTimeout(n, 1)
    }
    , iu = {
        willBlock: v(ru),
        run: function(t, e, n) {
            return ou(t, e, n)
        }
    }, au = ["b", "i", "u", "sub", "sup", "strike"], uu = function(t) {
        $(Mo(t), function(t) {
            var e;
            Ve(e = t) && !Uo(e) && W(au, Ye(e)) && Za(t)
        })
    }, cu = function(t, o) {
        var e = Mo(t);
        $(e, function(t) {
            var e, n, r;
            o(t) && (n = Mo(e = t),
            r = ln.fromTag("div", Co(e).dom()),
            ya(r, n),
            da(e, r),
            Za(e))
        })
    }, su = {
        consolidate: function(n, t) {
            Po(n).filter(t).each(function(t) {
                var e = Mo(t);
                ya(n, e),
                Za(t)
            }),
            cu(n, t),
            uu(n)
        }
    }, fu = mo("ephox-sloth").resolve("bin"), lu = {
        bin: v(fu)
    }, du = function(t) {
        return void 0 !== t.style
    }, mu = function(t, e, n) {
        if (!M(n))
            throw l.console.error("Invalid call to CSS.set. Property ", e, ":: Value ", n, ":: Element ", t),
            new Error("CSS value must be a string: " + n);
        du(t) && t.style.setProperty(e, n)
    }, pu = function(t, e) {
        du(t) && t.style.removeProperty(e)
    }, gu = function(t, e, n) {
        var r = t.dom();
        mu(r, e, n)
    }, vu = function(t, e) {
        var n = t.dom();
        it(e, function(t, e) {
            mu(n, e, t)
        })
    }, hu = function(t, e) {
        var n = t.dom()
          , r = l.window.getComputedStyle(n).getPropertyValue(e)
          , o = "" !== r || bo(t) ? r : yu(n, e);
        return null === o ? void 0 : o
    }, yu = function(t, e) {
        return du(t) ? t.style.getPropertyValue(e) : ""
    }, bu = function(t, e) {
        var n = t.dom()
          , r = yu(n, e);
        return P.from(r).filter(function(t) {
            return 0 < t.length
        })
    }, xu = function(t) {
        var e = {}
          , n = t.dom();
        if (du(n))
            for (var r = 0; r < n.style.length; r++) {
                var o = n.style.item(r);
                e[o] = n.style[o]
            }
        return e
    }, Tu = function(t, e) {
        var n = t.dom();
        pu(n, e),
        Je(t, "style") && "" === Le(Ze(t, "style")) && Qe(t, "style")
    }, Eu = function(t) {
        return "rtl" === hu(t, "direction") ? "rtl" : "ltr"
    }, wu = function(t) {
        return t.dom().innerHTML
    }, Iu = function(t, e) {
        var n = Co(t).dom()
          , r = ln.fromDom(n.createDocumentFragment())
          , o = la(e, n);
        ya(r, o),
        Ka(t),
        ga(t, r)
    }, Su = lu.bin(), Lu = Su + te(""), _u = (Ga = "-100000px",
    za = "100000px",
    function(t) {
        return "rtl" === Eu(t) ? za : Ga
    }
    );
    function Nu(e, t, n) {
        var r = function(e, t) {
            var n = ln.fromTag("div");
            Ke(n, t),
            Ke(n, {
                contenteditable: "true",
                "aria-hidden": "true"
            }),
            vu(n, {
                position: "fixed",
                top: "0px",
                width: "100px",
                height: "100px",
                overflow: "hidden",
                opacity: "0"
            }),
            Hi(n, [Su, Lu]);
            var r = function(t) {
                return Wi(t, Lu)
            };
            return {
                attach: function(t) {
                    Ka(n),
                    gu(n, "left", _u(t)),
                    ga(t, n)
                },
                focus: function() {
                    Ki(n, "body").each(function(t) {
                        e.toOff(t, n)
                    })
                },
                contents: function() {
                    return su.consolidate(n, r),
                    no("elements", "html", "container")(Mo(n), wu(n), n)
                },
                container: function() {
                    return n
                },
                detach: function() {
                    Za(n)
                }
            }
        }(e, n)
          , o = function() {
            e.cleanup();
            var t = r.contents();
            r.detach(),
            a.trigger.after(t.elements(), t.html(), r.container())
        }
          , i = eu.tap(function() {
            a.trigger.before(),
            r.attach(t),
            r.focus(),
            iu.run(Co(t), i, o)
        })
          , a = so.create({
            before: co([]),
            after: co(["elements", "html", "container"])
        })
          , u = L;
        return {
            instance: v(function() {
                i.instance()
            }),
            destroy: u,
            events: a.registry
        }
    }
    var Cu = function(t, e, n, r) {
        var o = Co(t).dom().createRange();
        return o.setStart(t.dom(), e),
        o.setEnd(n.dom(), r),
        o
    }
      , Ou = ft([{
        before: ["element"]
    }, {
        on: ["element", "offset"]
    }, {
        after: ["element"]
    }])
      , Du = {
        before: Ou.before,
        on: Ou.on,
        after: Ou.after,
        cata: function(t, e, n, r) {
            return t.fold(e, n, r)
        },
        getStart: function(t) {
            return t.fold(p, p, p)
        }
    }
      , Au = ft([{
        domRange: ["rng"]
    }, {
        relative: ["startSitu", "finishSitu"]
    }, {
        exact: ["start", "soffset", "finish", "foffset"]
    }])
      , Pu = no("start", "soffset", "finish", "foffset")
      , ku = Au.relative
      , Mu = function(t, e, n) {
        var r, o, i = t.document.createRange();
        return r = i,
        e.fold(function(t) {
            r.setStartBefore(t.dom())
        }, function(t, e) {
            r.setStart(t.dom(), e)
        }, function(t) {
            r.setStartAfter(t.dom())
        }),
        o = i,
        n.fold(function(t) {
            o.setEndBefore(t.dom())
        }, function(t, e) {
            o.setEnd(t.dom(), e)
        }, function(t) {
            o.setEndAfter(t.dom())
        }),
        i
    }
      , Ru = function(t, e, n, r, o) {
        var i = t.document.createRange();
        return i.setStart(e.dom(), n),
        i.setEnd(r.dom(), o),
        i
    }
      , Fu = ft([{
        ltr: ["start", "soffset", "finish", "foffset"]
    }, {
        rtl: ["start", "soffset", "finish", "foffset"]
    }])
      , ju = function(t, e, n) {
        return e(ln.fromDom(n.startContainer), n.startOffset, ln.fromDom(n.endContainer), n.endOffset)
    }
      , Uu = function(t, e) {
        var o, n, r, i = (o = t,
        e.match({
            domRange: function(t) {
                return {
                    ltr: v(t),
                    rtl: P.none
                }
            },
            relative: function(t, e) {
                return {
                    ltr: ee(function() {
                        return Mu(o, t, e)
                    }),
                    rtl: ee(function() {
                        return P.some(Mu(o, e, t))
                    })
                }
            },
            exact: function(t, e, n, r) {
                return {
                    ltr: ee(function() {
                        return Ru(o, t, e, n, r)
                    }),
                    rtl: ee(function() {
                        return P.some(Ru(o, n, r, t, e))
                    })
                }
            }
        }));
        return (r = (n = i).ltr()).collapsed ? n.rtl().filter(function(t) {
            return !1 === t.collapsed
        }).map(function(t) {
            return Fu.rtl(ln.fromDom(t.endContainer), t.endOffset, ln.fromDom(t.startContainer), t.startOffset)
        }).getOrThunk(function() {
            return ju(0, Fu.ltr, r)
        }) : ju(0, Fu.ltr, r)
    }
      , Bu = function(t, e) {
        for (var n = 0; n < t.length; n++) {
            var r = e(t[n], n);
            if (r.isSome())
                return r
        }
        return P.none()
    };
    function Yu(n, r) {
        var e = function(t) {
            return n(t) ? P.from(t.dom().nodeValue) : P.none()
        }
          , t = Pe.detect().browser
          , o = t.isIE() && 10 === t.version.major ? function(t) {
            try {
                return e(t)
            } catch (t) {
                return P.none()
            }
        }
        : e;
        return {
            get: function(t) {
                if (!n(t))
                    throw new Error("Can only get " + r + " value of a " + r + " node");
                return o(t).getOr("")
            },
            getOption: o,
            set: function(t, e) {
                if (!n(t))
                    throw new Error("Can only set raw " + r + " value of a " + r + " node");
                t.dom().nodeValue = e
            }
        }
    }
    var Wu = Yu(Xe, "text")
      , Hu = function(t) {
        return Wu.get(t)
    }
      , qu = function(t, e) {
        Wu.set(t, e)
    }
      , $u = (document.caretPositionFromPoint || document.caretRangeFromPoint,
    function(t, e) {
        var n = Ye(t);
        return "input" === n ? Du.after(t) : W(["br", "img"], n) ? 0 === e ? Du.before(t) : Du.after(t) : Du.on(t, e)
    }
    )
      , Vu = function(t, e, n, r, o) {
        var i, a, u = Ru(t, e, n, r, o);
        i = t,
        a = u,
        P.from(i.getSelection()).each(function(t) {
            t.removeAllRanges(),
            t.addRange(a)
        })
    }
      , Xu = function(t, e, n, r, o) {
        var i, a, u, c, f, s = (i = r,
        a = o,
        u = $u(e, n),
        c = $u(i, a),
        ku(u, c));
        Uu(f = t, s).match({
            ltr: function(t, e, n, r) {
                Vu(f, t, e, n, r)
            },
            rtl: function(e, n, r, o) {
                var t, i, a, u, c, s = f.getSelection();
                if (s.setBaseAndExtent)
                    s.setBaseAndExtent(e.dom(), n, r.dom(), o);
                else if (s.extend)
                    try {
                        i = e,
                        a = n,
                        u = r,
                        c = o,
                        (t = s).collapse(i.dom(), a),
                        t.extend(u.dom(), c)
                    } catch (t) {
                        Vu(f, r, o, e, n)
                    }
                else
                    Vu(f, r, o, e, n)
            }
        })
    }
      , Gu = function(t) {
        var e, n, r, o, i, a, u = ln.fromDom(t.anchorNode), c = ln.fromDom(t.focusNode);
        return e = u,
        n = t.anchorOffset,
        r = c,
        o = t.focusOffset,
        i = Cu(e, n, r, o),
        a = _o(e, r) && n === o,
        i.collapsed && !a ? P.some(Pu(u, t.anchorOffset, c, t.focusOffset)) : function(t) {
            if (0 < t.rangeCount) {
                var e = t.getRangeAt(0)
                  , n = t.getRangeAt(t.rangeCount - 1);
                return P.some(Pu(ln.fromDom(e.startContainer), e.startOffset, ln.fromDom(n.endContainer), n.endOffset))
            }
            return P.none()
        }(t)
    }
      , zu = function(t) {
        return P.from(t.getSelection()).filter(function(t) {
            return 0 < t.rangeCount
        }).bind(Gu)
    }
      , Ku = function(t) {
        return {
            startContainer: t.start,
            startOffset: t.soffset,
            endContainer: t.finish,
            endOffset: t.foffset
        }
    }
      , Zu = {
        set: function(t, e) {
            Xu(t, e.startContainer(), e.startOffset(), e.endContainer(), e.endOffset())
        },
        get: function(t) {
            return zu(t).map(Ku)
        }
    };
    function Ju(a) {
        return function(e) {
            var u, r, o, c, n = so.create({
                after: co(["container"])
            }), i = (u = Zu,
            r = ln.fromTag("br"),
            o = P.none(),
            c = function(t) {
                return Co(t).dom().defaultView
            }
            ,
            {
                cleanup: function() {
                    Za(r)
                },
                toOn: function(i, t) {
                    var a = c(t);
                    o.each(function(t) {
                        var e = jo(i)
                          , n = _o(i, t.startContainer()) && e < t.startOffset() ? e : t.startOffset
                          , r = _o(i, t.endContainer()) && e < t.endOffset() ? e : t.endOffset
                          , o = Xa(t.startContainer(), n, t.endContainer(), r);
                        u.set(a, o)
                    })
                },
                toOff: function(t, e) {
                    var n = c(e);
                    ga(e, r),
                    o = u.get(n, Xa),
                    u.set(n, Xa(r, 0, r, 0))
                }
            }), t = Nu(i, e, a);
            return t.events.after.bind(function(t) {
                i.toOn(e, t.container()),
                n.trigger.after(t.container())
            }),
            {
                run: function() {
                    t.instance()()
                },
                events: n.registry
            }
        }
    }
    var Qu = ft([{
        error: ["message"]
    }, {
        paste: ["elements", "correlated"]
    }, {
        cancel: []
    }, {
        incomplete: ["elements", "correlated", "message"]
    }])
      , tc = function(t, e, n, r, o) {
        return t.fold(e, n, r, o)
    }
      , ec = {
        error: Qu.error,
        paste: Qu.paste,
        cancel: Qu.cancel,
        incomplete: Qu.incomplete,
        cata: tc,
        carry: function(t, r) {
            return tc(t, P.none, P.none, P.none, function(t, e, n) {
                return tc(r, P.none, function(t, e) {
                    return P.some(Qu.incomplete(t, e, n))
                }, P.none, P.none)
            }).getOr(r)
        }
    }
      , nc = ["officeStyles", "htmlStyles", "isWord", "isGoogleDocs", "proxyBin", "isInternal", "backgroundAssets"]
      , rc = function(t, n) {
        var r = {};
        return $(nc, function(e) {
            n[e]().or(t[e]()).each(function(t) {
                r[e] = t
            })
        }),
        oc(r)
    }
      , oc = io([], nc)
      , ic = io(["response", "bundle"], [])
      , ac = function(e) {
        return fc(function(t) {
            t(ic(e))
        })
    }
      , uc = function(t, e) {
        t(ic(e))
    }
      , cc = function(t) {
        return ac({
            response: t.response(),
            bundle: t.bundle()
        })
    }
      , sc = function(t) {
        return ac({
            response: ec.error(t),
            bundle: oc({})
        })
    }
      , fc = function(e) {
        var t = function(t) {
            e(t)
        }
          , o = fc;
        return {
            get: t,
            map: function(r) {
                return o(function(n) {
                    t(function(t) {
                        var e = r(t);
                        n(e)
                    })
                })
            },
            bind: function(n) {
                return o(function(e) {
                    t(function(t) {
                        n(t).get(e)
                    })
                })
            }
        }
    }
      , lc = no("steps", "input", "label", "capture")
      , dc = function(t, e, n) {
        var r;
        return (r = n,
        Bu(t, function(e) {
            return e.getAvailable(r).map(function(t) {
                return lc(e.steps(), t, e.label(), e.capture())
            })
        })).getOrThunk(function() {
            var t = e.getAvailable(n);
            return lc(e.steps(), t, e.label(), e.capture())
        })
    }
      , mc = function(t, a) {
        return X(t, function(t, i) {
            return t.bind(function(t) {
                var r, e, n, o;
                return e = function() {
                    return i(a, t)
                }
                ,
                n = y(cc, r = t),
                o = function() {
                    return e().map(function(t) {
                        var e = rc(r.bundle(), t.bundle())
                          , n = ec.carry(r.response(), t.response());
                        return ic({
                            response: n,
                            bundle: e
                        })
                    })
                }
                ,
                ec.cata(r.response(), n, o, n, o)
            })
        }, ac({
            response: ec.paste([], []),
            bundle: oc({})
        }))
    }
      , pc = function(t) {
        return e = t,
        n = !1,
        ln.fromDom(e.dom().cloneNode(n));
        var e, n
    }
      , gc = function(t) {
        return $e(t) ? (e = "v:shape",
        n = He(t),
        r = ln.fromTag("div"),
        o = n.indexOf("]>"),
        r.dom().innerHTML = n.substr(o + "]>".length),
        Gi(r, function(t) {
            return Ye(t) === e
        })) : P.none();
        var e, n, r, o
    }
      , vc = function(t) {
        return Yo(t, ".rtf-data-image")
    }
      , hc = {
        local: function(t) {
            if ("img" === Ye(t)) {
                var e = Ze(t, "src");
                if (null != e && Ie(e, "file://")) {
                    var n = pc(t)
                      , r = e.split(/[\/\\]/)
                      , o = r[r.length - 1];
                    return ze(n, "data-image-id", o),
                    Qe(n, "src"),
                    ze(n, "data-image-type", "local"),
                    Bi(n, "rtf-data-image"),
                    P.some(n)
                }
                return P.none()
            }
            return P.none()
        },
        vshape: function(t) {
            return gc(t).map(function(t) {
                var e = Ze(t, "o:spid")
                  , n = void 0 === e ? Ze(t, "id") : e
                  , r = ln.fromTag("img");
                return Bi(r, "rtf-data-image"),
                ze(r, "data-image-id", n.substr("_x0000_".length)),
                ze(r, "data-image-type", "code"),
                vu(r, {
                    width: hu(t, "width"),
                    height: hu(t, "height")
                }),
                r
            })
        },
        find: vc,
        exists: function(t) {
            return 0 < vc(t).length
        },
        scour: gc
    }
      , yc = function() {
        return /^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/
    }
      , bc = function() {
        return /^(font|em|strong|samp|acronym|cite|code|dfn|kbd|tt|b|i|u|s|sub|sup|ins|del|var|span)$/
    }
      , xc = ft([{
        starts: ["value", "f"]
    }, {
        pattern: ["regex", "f"]
    }, {
        contains: ["value", "f"]
    }, {
        exact: ["value", "f"]
    }, {
        all: []
    }, {
        not: ["stringMatch"]
    }])
      , Tc = function(t, n) {
        return t.fold(function(t, e) {
            return 0 === e(n).indexOf(e(t))
        }, function(t, e) {
            return t.test(e(n))
        }, function(t, e) {
            return 0 <= e(n).indexOf(e(t))
        }, function(t, e) {
            return e(n) === e(t)
        }, function() {
            return !0
        }, function(t) {
            return !Tc(t, n)
        })
    }
      , Ec = {
        starts: xc.starts,
        pattern: xc.pattern,
        contains: xc.contains,
        exact: xc.exact,
        all: xc.all,
        not: xc.not,
        cata: function(t, e, n, r, o, i, a) {
            return t.fold(e, n, r, o, i, a)
        },
        matches: Tc,
        caseSensitive: function(t) {
            return t
        },
        caseInsensitive: function(t) {
            return t.toLowerCase()
        }
    }
      , wc = function(t, e, n, r) {
        var o = r.name
          , i = void 0 !== r.condition ? r.condition : v(!0)
          , a = void 0 !== r.value ? r.value : Ec.all();
        return Ec.matches(o, n) && Ec.matches(a, e) && i(t)
    }
      , Ic = function(t, e) {
        var n = Ye(t)
          , r = e.name
          , o = void 0 !== e.condition ? e.condition : v(!0);
        return Ec.matches(r, n) && o(t)
    }
      , Sc = function(t, e) {
        var n = {};
        return $(t.dom().attributes, function(t) {
            e(t.value, t.name) || (n[t.name] = t.value)
        }),
        n
    }
      , Lc = function(t, e, n) {
        var r, o, i = q(t.dom().attributes, function(t) {
            return t.name
        });
        st(e) !== i.length && (r = t,
        o = e,
        $(i, function(t) {
            Qe(r, t)
        }),
        it(o, function(t, e) {
            ze(r, e, t)
        }))
    }
      , _c = (v({}),
    function(e) {
        var t = ot(e);
        return q(t, function(t) {
            return t + ": " + e[t]
        }).join("; ")
    }
    )
      , Nc = function(r, o) {
        var t = r.dom().style
          , i = {};
        return $(null == t ? [] : t, function(t) {
            var e, n = (e = t,
            r.dom().style.getPropertyValue(e));
            o(n, t) || (i[t] = n)
        }),
        i
    }
      , Cc = function(n, t, e) {
        ze(n, "style", "");
        var r = st(t)
          , o = st(e);
        if (0 === r && 0 === o)
            Qe(n, "style");
        else if (0 === r)
            ze(n, "style", _c(e));
        else {
            it(t, function(t, e) {
                gu(n, e, t)
            });
            var i = Ze(n, "style")
              , a = 0 < o ? _c(e) + "; " : "";
            ze(n, "style", a + i)
        }
    }
      , Oc = function(t, e, n) {
        var r, o, i, a = t.dom().getAttribute("style"), u = (o = {},
        i = null != (r = a) ? r.split(";") : [],
        $(i, function(t) {
            var e = t.split(":");
            2 === e.length && (o[Le(e[0])] = Le(e[1]))
        }),
        o), c = {};
        return $(e, function(t) {
            var e = u[t];
            void 0 === e || n(e, t) || (c[t] = e)
        }),
        c
    }
      , Dc = ["mso-list"]
      , Ac = function(t, e) {
        var n = Oc(t, Dc, e)
          , r = Nc(t, e);
        Cc(t, r, n)
    }
      , Pc = function(t, e) {
        var n = Sc(t, e);
        Lc(t, n, {})
    }
      , kc = Ac
      , Mc = Pc
      , Rc = function(t, e) {
        Ac(ln.fromDom(t), e)
    }
      , Fc = function(t, r, o) {
        t(o, function(e, n) {
            return H(r, function(t) {
                return wc(o, e, n, t)
            })
        })
    }
      , jc = function(t, e) {
        var r = pt({
            styles: [],
            attributes: [],
            classes: [],
            tags: []
        }, e)
          , n = Yo(t, "*");
        $(n, function(n) {
            Fc(kc, r.styles, n),
            Fc(Mc, r.attributes, n),
            $(r.classes, function(e) {
                var t = Je(n, "class") ? qi(n) : [];
                $(t, function(t) {
                    Ec.matches(e.name, t) && Yi(n, t)
                })
            })
        });
        var o = Yo(t, "*");
        $(o, function(t) {
            H(r.tags, y(Ic, t)) && Za(t)
        })
    }
      , Uc = function(t, e) {
        var n = pt({
            tags: []
        }, e)
          , r = Yo(t, "*");
        $(r, function(t) {
            H(n.tags, y(Ic, t)) && Ja(t)
        })
    }
      , Bc = function(t, e) {
        var n = pt({
            tags: []
        }, e)
          , r = Yo(t, "*");
        $(r, function(e) {
            G(n.tags, y(Ic, e)).each(function(t) {
                t.mutate(e)
            })
        })
    }
      , Yc = "startElement"
      , Wc = "endElement"
      , Hc = "comment"
      , qc = function(t, e, n) {
        var r, o, i, a = ln.fromDom(t);
        switch (t.nodeType) {
        case 1:
            e ? r = Wc : (r = Yc,
            vu(a, n || {})),
            o = "HTML" !== t.scopeName && t.scopeName && t.tagName && t.tagName.indexOf(":") <= 0 ? (t.scopeName + ":" + t.tagName).toUpperCase() : t.tagName;
            break;
        case 3:
            r = "text",
            i = t.nodeValue;
            break;
        case 8:
            r = Hc,
            i = t.nodeValue;
            break;
        default:
            l.console.log("WARNING: Unsupported node type encountered: " + t.nodeType)
        }
        return {
            getNode: function() {
                return t
            },
            tag: function() {
                return o
            },
            type: function() {
                return r
            },
            text: function() {
                return i
            }
        }
    }
      , $c = function(t, e) {
        return qc(e.createElement(t), !0)
    }
      , Vc = $c("HTML", l.window.document)
      , Xc = {
        START_ELEMENT_TYPE: Yc,
        END_ELEMENT_TYPE: Wc,
        TEXT_TYPE: "text",
        COMMENT_TYPE: Hc,
        FINISHED: Vc,
        token: qc,
        createStartElement: function(t, e, n, r) {
            var o = r.createElement(t);
            return it(e, function(t, e) {
                o.setAttribute(e, t)
            }),
            qc(o, !1, n)
        },
        createEndElement: $c,
        createComment: function(t, e) {
            return qc(e.createComment(t), !1)
        },
        createText: function(t, e) {
            return qc(e.createTextNode(t))
        }
    }
      , Gc = function(i) {
        var a = i.createDocumentFragment()
          , u = a
          , c = function(t) {
            a.appendChild(t)
        };
        return {
            dom: u,
            receive: function(t) {
                var e, n, r, o;
                switch (t.type()) {
                case Xc.START_ELEMENT_TYPE:
                    o = t.getNode().cloneNode(!1),
                    c(r = o),
                    a = r;
                    break;
                case Xc.TEXT_TYPE:
                    e = t,
                    n = i.createTextNode(e.text()),
                    c(n);
                    break;
                case Xc.END_ELEMENT_TYPE:
                    null === (a = a.parentNode) && (a = u);
                    break;
                case Xc.COMMENT_TYPE:
                    break;
                default:
                    throw {
                        message: "Unsupported token type: " + t.type()
                    }
                }
            },
            label: "SERIALISER"
        }
    }
      , zc = function(t, o) {
        var i;
        o = o || l.window.document,
        i = o.createElement("div"),
        o.body.appendChild(i),
        i.style.position = "absolute",
        i.style.left = "-10000px",
        i.innerHTML = t;
        var a = i.firstChild || Xc.FINISHED
          , u = []
          , c = !1;
        return {
            hasNext: function() {
                return void 0 !== a
            },
            next: function() {
                var t, e, n = a, r = c;
                return !c && a.firstChild ? (u.push(a),
                a = a.firstChild) : c || 1 !== a.nodeType ? a.nextSibling ? (a = a.nextSibling,
                c = !1) : (a = u.pop(),
                c = !0) : c = !0,
                n === Xc.FINISHED || a || (o.body.removeChild(i),
                a = Xc.FINISHED),
                e = r,
                (t = n) === Xc.FINISHED ? t : t ? Xc.token(t, e) : void 0
            }
        }
    }
      , Kc = function(t, e, n) {
        var r, o = n;
        for (r = e.length - 1; 0 <= r; r--)
            o = e[r](o, {}, t);
        return o
    }
      , Zc = function(t, e, n) {
        for (var r = Gc(t), o = zc(e, t), i = Kc(t, n, r); o.hasNext(); ) {
            var a = o.next();
            i.receive(a)
        }
        return r.dom
    }
      , Jc = function(e) {
        return function(t) {
            jc(t, e)
        }
    }
      , Qc = function(e) {
        return function(t) {
            Uc(t, e)
        }
    }
      , ts = function(e) {
        return function(t) {
            Bc(t, e)
        }
    }
      , es = function(o) {
        return function(t) {
            var e = wu(t)
              , n = Co(t)
              , r = Zc(n.dom(), e, o);
            Ka(t),
            t.dom().appendChild(r)
        }
    }
      , ns = function(t, e) {
        return 0 <= t.indexOf("<o:p>") || e.browser.isEdge() && 0 <= t.indexOf('v:shapes="') || e.browser.isEdge() && 0 <= t.indexOf("mso-") || 0 <= t.indexOf("mso-list") || 0 <= t.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal") || 0 <= t.indexOf("MsoListParagraphCxSpFirst") || 0 <= t.indexOf("<w:WordDocument>")
    }
      , rs = function(t, e, n) {
        var r = ln.fromTag("div", t.dom());
        return r.dom().innerHTML = e,
        $(n, function(t) {
            t(r)
        }),
        wu(r)
    };
    function os(a, u, t) {
        return function(e, t, n) {
            var r = function(t) {
                e.receive(t)
            }
              , o = function(t, e, n) {
                return n = void 0 !== n ? n : t.type() === Xc.END_ELEMENT_TYPE,
                Xc.token(e, n, {})
            }
              , i = {
                emit: r,
                emitTokens: function(t) {
                    $(t, r)
                },
                receive: function(t) {
                    a(i, t, o)
                },
                document: l.window.document
            };
            return u(i),
            i
        }
    }
    var is = function(t, e) {
        var n = ln.fromDom(t.getNode());
        return Ze(n, e)
    }
      , as = function(t, e) {
        var n = ln.fromDom(t.getNode());
        return hu(n, e)
    }
      , us = function(t) {
        return t.type() === Xc.TEXT_TYPE && /^[\s\u00A0]*$/.test(t.text())
    }
      , cs = function(t, e, n) {
        return t === e || t && e && t.tag === e.tag && t.type === e.type && (n || t.variant === e.variant)
    }
      , ss = {
        guessFrom: function(t, e) {
            return G(t, function(t) {
                return "UL" === t.tag || e && cs(t, e, !0)
            }).orThunk(function() {
                return rt(t)
            })
        },
        eqListType: cs
    }
      , fs = function(t, e) {
        if (void 0 === t || void 0 === e)
            throw l.console.trace(),
            "brick";
        t.nextFilter.set(e)
    }
      , ls = function(t, e, n) {
        e.nextFilter.get()(t, e, n)
    }
      , ds = fs
      , ms = ls
      , ps = no("level", "token", "type")
      , gs = function(t, n, e, r) {
        var o = e.getCurrentListType()
          , i = e.getCurrentLevel() == r.level() ? o : null;
        return ss.guessFrom(r.emblems(), i).filter(function(t) {
            return !("OL" === t.tag && (!W(["P"], (e = n).tag()) || /^MsoHeading/.test(is(e, "class"))));
            var e
        })
    }
      , vs = function(t, e) {
        return Je(ln.fromDom(e.getNode()), "data-list-level")
    }
      , hs = function(d) {
        return function(t, e, n) {
            var r, o, i, a, u = (r = ln.fromDom(n.getNode()),
            o = parseInt(Ze(r, "data-list-level"), 10),
            i = Ze(r, "data-list-emblems"),
            a = JSON.parse(i),
            Qe(r, "data-list-level"),
            Qe(r, "data-list-emblems"),
            {
                level: v(o),
                emblems: v(a)
            });
            u.level(),
            e.originalToken.set(n);
            var c, s, f, l = (c = n,
            s = u,
            gs((f = e).listType.get(), c, f.emitter, s).each(f.listType.set),
            ps(s.level(), f.originalToken.get(), f.listType.get()));
            e.emitter.openItem(l.level(), l.token(), l.type()),
            ds(e, d.inside())
        }
    };
    function ys(t, e, n) {
        return {
            pred: t,
            action: e,
            label: v(n)
        }
    }
    var bs = function(t, r) {
        return function(t, e, n) {
            return r(t, e, n)
        }
    };
    function xs(t, r, e) {
        var o = bs(0, e)
          , n = function(t, e, n) {
            G(r, function(t) {
                return t.pred(e, n)
            }).fold(v(o), function(t) {
                var e = t.label();
                return void 0 === e ? t.action : bs(0, t.action)
            })(t, e, n)
        };
        return n.toString = function() {
            return "Handlers for " + t
        }
        ,
        n
    }
    var Ts, Es, ws, Is, Ss, Ls, _s, Ns, Cs, Os, Ds, As = function(r) {
        return xs("Inside.List.Item", [ys(function(t, e) {
            return e.type() === Xc.END_ELEMENT_TYPE && t.originalToken.get() && e.tag() === t.originalToken.get().tag()
        }, function(t, e, n) {
            ds(e, r.outside())
        }, "Closing open tag")], function(t, e, n) {
            t.emit(n)
        })
    }, Ps = function(r) {
        return xs("Outside.List.Item", [ys(vs, hs(r), "Data List ****"), ys(function(t, e) {
            return e.type() === Xc.TEXT_TYPE && us(e)
        }, function(t, e, n) {
            t.emit(n)
        }, "Whitespace")], function(t, e, n) {
            e.emitter.closeAllLists(),
            t.emit(n),
            ds(e, r.outside())
        })
    }, ks = no("state", "result"), Ms = no("state", "value"), Rs = {
        state: no("level", "type", "types", "items"),
        value: Ms,
        result: ks
    }, Fs = function(t, e) {
        var n = t.items().slice(0)
          , r = void 0 !== e && "P" !== e ? P.some(e) : P.none();
        r.fold(function() {
            n.push("P")
        }, function(t) {
            n.push(t)
        });
        var o = Rs.state(t.level(), t.type(), t.types(), n);
        return Rs.value(o, r)
    }, js = function(t) {
        var e = t.items().slice(0);
        if (0 < e.length && "P" !== e[e.length - 1]) {
            var n = e[e.length - 1];
            e[e.length - 1] = "P";
            var r = Rs.state(t.level(), t.type(), t.types(), e);
            return Rs.value(r, P.some(n))
        }
        return Rs.value(t, P.none())
    }, Us = function(t, e, n) {
        for (var r = [], o = t; e(o); ) {
            var i = n(o);
            o = i.state(),
            r = r.concat(i.result())
        }
        return Rs.result(o, r)
    }, Bs = function(t, e, n) {
        return Us(t, function(t) {
            return t.level() < e
        }, n)
    }, Ys = function(t, e, n) {
        return Us(t, function(t) {
            return t.level() > e
        }, n)
    }, Ws = function(t) {
        var e;
        return t ? void 0 !== (e = as(t, "margin-left")) && "0px" !== e ? {
            "margin-left": e
        } : {} : {
            "list-style-type": "none"
        }
    }, Hs = function(t, e, n) {
        var r = e.start && 1 < e.start ? {
            start: e.start
        } : {}
          , o = t.level() + 1
          , i = e
          , a = t.types().concat([e])
          , u = [y(Xc.createStartElement, e.tag, r, n)]
          , c = Rs.state(o, i, a, t.items());
        return Rs.result(c, u)
    }, qs = function(t) {
        var e = t.types().slice(0)
          , n = [y(Xc.createEndElement, e.pop().tag)]
          , r = t.level() - 1
          , o = e[e.length - 1]
          , i = Rs.state(r, o, e, t.items());
        return Rs.result(i, n)
    }, $s = Hs, Vs = function(t, e, n) {
        var r, o, i, a = Ws(e), u = t.type() && !ss.eqListType(t.type(), n) ? (r = n,
        o = qs(t),
        i = Hs(o.state(), r, r.type ? {
            "list-style-type": r.type
        } : {}),
        Rs.result(i.state(), o.result().concat(i.result()))) : Rs.result(t, []), c = [y(Xc.createStartElement, "LI", {}, a)], s = Fs(u.state(), e && e.tag()), f = s.value().map(function(t) {
            return Rc(e.getNode(), v(!0)),
            [v(e)]
        }).getOr([]);
        return Rs.result(s.state(), u.result().concat(c).concat(f))
    }, Xs = qs, Gs = function(t) {
        var e = y(Xc.createEndElement, "LI")
          , n = js(t)
          , r = n.value().fold(function() {
            return [e]
        }, function(t) {
            return [y(Xc.createEndElement, t), e]
        });
        return Rs.result(n.state(), r)
    }, zs = function(t) {
        if (0 === t.length)
            throw "Compose must have at least one element in the list";
        var e = t[t.length - 1]
          , n = Q(t, function(t) {
            return t.result()
        });
        return Rs.result(e.state(), n)
    }, Ks = function(t) {
        var e = Gs(t)
          , n = Xs(e.state());
        return zs([e, n])
    }, Zs = function(t, c, s, f) {
        return Bs(t, s, function(t) {
            return n = c,
            r = s,
            o = f,
            i = (e = t).level() === r - 1 && n.type ? {
                "list-style-type": n.type
            } : {},
            a = $s(e, n, i),
            u = Vs(a.state(), a.state().level() == r ? o : void 0, n),
            zs([a, u]);
            var e, n, r, o, i, a, u
        })
    }, Js = function(t, e) {
        return Ys(t, e, Ks)
    }, Qs = {
        openItem: function(t, e, n, r) {
            var o, i, a, u, c, s, f, l, d, m, p, g, v = t.level() > e ? Js(t, e) : Rs.result(t, []), h = v.state().level() === e ? (l = v.state(),
            d = r,
            m = n,
            p = 0 < l.level() ? Gs(l) : Rs.result(l, []),
            g = Vs(p.state(), m, d),
            zs([p, g])) : (o = v.state(),
            i = r,
            u = n,
            c = 1 < (a = e) ? js(o) : Rs.value(o, P.none()),
            s = c.value().map(function(t) {
                return [y(Xc.createEndElement, t)]
            }).getOr([]),
            c.state().level(),
            f = Zs(c.state(), i, a, u),
            Rs.result(f.state(), s.concat(f.result())));
            return zs([v, h])
        },
        closeAllLists: Js
    }, tf = ["disc", "circle", "square"], ef = function(t, e) {
        return "UL" === t.tag && tf[e - 1] === t.type && (t = {
            tag: "UL"
        }),
        t
    }, nf = function(t) {
        var e = t
          , n = function() {
            return e
        };
        return {
            get: n,
            set: function(t) {
                e = t
            },
            clone: function() {
                return nf(n())
            }
        }
    }, rf = {
        getCurrentListType: function() {
            return of().getCurrentListType()
        },
        getCurrentLevel: function() {
            return of().getCurrentLevel()
        },
        closeAllLists: function() {
            return of().closeAllLists.apply(void 0, arguments)
        },
        openItem: function() {
            return of().openItem.apply(void 0, arguments)
        }
    }, of = function() {
        return {
            getCurrentListType: v({}),
            getCurrentLevel: v(1),
            closeAllLists: p,
            openItem: p
        }
    }, af = {
        inside: function() {
            return cf
        },
        outside: function() {
            return sf
        }
    }, uf = (Ts = !1,
    {
        check: function(t) {
            return Ts && t.type() === Xc.TEXT_TYPE ? (t.text(),
            !0) : t.type() === Xc.START_ELEMENT_TYPE && "STYLE" === t.tag() ? Ts = !0 : t.type() === Xc.END_ELEMENT_TYPE && "STYLE" === t.tag() && !(Ts = !1)
        }
    }), cf = As(af), sf = Ps(af), ff = (ws = nf(Es = sf),
    Is = nf(null),
    Ss = nf(null),
    {
        reset: function(t) {
            ws.set(Es),
            Is.set(null),
            Ss.set(null);
            var n, r, i, a, e = (r = (n = t).document,
            i = Rs.state(0, void 0, [], []),
            a = function(t) {
                $(t.result(), function(t) {
                    var e = t(r);
                    n.emit(e)
                })
            }
            ,
            {
                closeAllLists: function() {
                    var t = Qs.closeAllLists(i, 0);
                    i = t.state(),
                    a(t)
                },
                openItem: function(t, e, n) {
                    if (n) {
                        var r = ef(n, t)
                          , o = Qs.openItem(i, t, e, r);
                        i = o.state(),
                        a(o)
                    }
                },
                getCurrentListType: function() {
                    return i.type()
                },
                getCurrentLevel: function() {
                    return i.level()
                }
            });
            of = v(e)
        },
        nextFilter: ws,
        originalToken: Is,
        listType: Ss,
        emitter: rf
    }), lf = os(function(t, e, n) {
        uf.check(e) || ms(t, ff, e)
    }, ff.reset), df = [{
        regex: /^\(?[dc][\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-alpha"
        }
    }, {
        regex: /^\(?[DC][\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-alpha"
        }
    }, {
        regex: /^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-roman"
        }
    }, {
        regex: /^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-roman"
        }
    }, {
        regex: /^\(?[0-9]+[\.\)]$/,
        type: {
            tag: "OL"
        }
    }, {
        regex: /^([0-9]+\.)*[0-9]+\.?$/,
        type: {
            tag: "OL",
            variant: "outline"
        }
    }, {
        regex: /^\(?[a-z]+[\.\)]$/,
        type: {
            tag: "OL",
            type: "lower-alpha"
        }
    }, {
        regex: /^\(?[A-Z]+[\.\)]$/,
        type: {
            tag: "OL",
            type: "upper-alpha"
        }
    }], mf = {
        "\u2022": {
            tag: "UL",
            type: "disc"
        },
        "\xb7": {
            tag: "UL",
            type: "disc"
        },
        "\xa7": {
            tag: "UL",
            type: "square"
        }
    }, pf = {
        o: {
            tag: "UL",
            type: "circle"
        },
        "-": {
            tag: "UL",
            type: "disc"
        },
        "\u25cf": {
            tag: "UL",
            type: "disc"
        },
        "\ufffd": {
            tag: "UL",
            type: "circle"
        }
    }, gf = function(u, t) {
        var e = pf[u] ? [pf[u]] : []
          , n = t && mf[u] ? [mf[u]] : t ? [{
            tag: "UL",
            variant: u
        }] : []
          , r = Q(df, function(t) {
            return t.regex.test(u) ? [pt(t.type, (r = u,
            o = r.split("."),
            i = function() {
                if (0 === o.length)
                    return r;
                var t = o[o.length - 1];
                return 0 === t.length && 1 < o.length ? o[o.length - 2] : t
            }(),
            a = parseInt(i, 10),
            isNaN(a) ? {} : {
                start: a
            }), {
                variant: (e = t.type,
                n = u,
                void 0 !== e.variant ? e.variant : "(" === n.charAt(0) ? "()" : ")" === n.charAt(n.length - 1) ? ")" : ".")
            })] : [];
            var e, n, r, o, i, a
        })
          , o = e.concat(n).concat(r);
        return q(o, function(t) {
            return void 0 !== t.variant ? t : pt(t, {
                variant: u
            })
        })
    }, vf = function(t) {
        return t.dom().textContent
    }, hf = function(t) {
        return Oc(t, ["mso-list"], v(!1))["mso-list"]
    }, yf = function(t) {
        return Ve(t) && bu(t, "font-family").exists(function(t) {
            return W(["wingdings", "symbol"], t.toLowerCase())
        })
    }, bf = {
        getMsoList: hf,
        extractLevel: function(t) {
            var e = hf(t)
              , n = / level([0-9]+)/.exec(e);
            return n && n[1] ? P.some(parseInt(n[1], 10)) : P.none()
        },
        extractEmblem: function(t, e) {
            var n = vf(t).trim()
              , r = gf(n, e);
            return 0 < r.length ? P.some(r) : P.none()
        },
        extractSymSpan: function(t) {
            return Xi(t, yf)
        },
        extractMsoIgnore: function(t) {
            return Gi(t, function(t) {
                return !!(Ve(t) ? Oc(t, ["mso-list"], v(!1)) : [])["mso-list"]
            })
        },
        extractCommentSpan: function(t) {
            return Xi(t, $e).bind(Po).filter(function(t) {
                return "span" === Ye(t)
            })
        },
        isSymbol: yf,
        deduceLevel: function(t) {
            return bu(t, "margin-left").bind(function(t) {
                var e = parseInt(t, 10);
                return isNaN(e) ? P.none() : P.some(Math.max(1, Math.ceil(e / 18)))
            })
        }
    }, xf = function(t) {
        for (var e = []; null !== t.nextNode(); )
            e.push(ln.fromDom(t.currentNode));
        return e
    }, Tf = Pe.detect().browser, Ef = Tf.isIE() || Tf.isEdge() ? function(t) {
        try {
            return xf(t)
        } catch (t) {
            return []
        }
    }
    : xf, wf = v(v(!0)), If = function(t, e) {
        var n = e.fold(wf, function(e) {
            return function(t) {
                return e(t.nodeValue)
            }
        });
        n.acceptNode = n;
        var r = l.document.createTreeWalker(t.dom(), xt.getOrDie("NodeFilter").SHOW_COMMENT, n, !1);
        return Ef(r)
    }, Sf = function(t, e, n, r) {
        var o;
        !function(t, e, n) {
            ze(t, "data-list-level", e);
            var r = JSON.stringify(n);
            ze(t, "data-list-emblems", r)
        }(t, e, n),
        o = If(t, P.none()),
        $(o, Za),
        $(r, Za),
        Qe(t, "style"),
        Qe(t, "class")
    }, Lf = function(t) {
        return (r = t,
        bf.extractLevel(r).bind(function(n) {
            return bf.extractSymSpan(r).bind(function(e) {
                return bf.extractEmblem(e, !0).map(function(t) {
                    return {
                        mutate: function() {
                            Sf(r, n, t, [e])
                        }
                    }
                })
            })
        })).orThunk(function() {
            return r = t,
            bf.extractLevel(r).bind(function(n) {
                return bf.extractCommentSpan(r).bind(function(e) {
                    return bf.extractEmblem(e, bf.isSymbol(e)).map(function(t) {
                        return {
                            mutate: function() {
                                Sf(r, n, t, [e])
                            }
                        }
                    })
                })
            });
            var r
        }).orThunk(function() {
            return r = t,
            bf.extractLevel(r).bind(function(n) {
                return bf.extractCommentSpan(r).bind(function(e) {
                    return bf.extractEmblem(e, bf.isSymbol(e)).map(function(t) {
                        return {
                            mutate: function() {
                                Sf(r, n, t, [e])
                            }
                        }
                    })
                })
            });
            var r
        }).orThunk(function() {
            return "p" !== Ye(r = t) ? P.none() : bf.extractLevel(r).bind(function(n) {
                return bf.extractMsoIgnore(r).bind(function(e) {
                    return bf.extractEmblem(e, !1).map(function(t) {
                        return {
                            mutate: function() {
                                Sf(r, n, t, [Oo(e).getOr(e)])
                            }
                        }
                    })
                })
            });
            var r
        }).orThunk(function() {
            return "p" !== Ye(r = t) ? P.none() : bf.extractMsoIgnore(r).bind(function(t) {
                var n = Oo(t).getOr(t)
                  , e = bf.isSymbol(n);
                return bf.extractEmblem(t, e).bind(function(e) {
                    return bf.deduceLevel(r).map(function(t) {
                        return {
                            mutate: function() {
                                Sf(r, t, e, [n])
                            }
                        }
                    })
                })
            });
            var r
        });
        var r
    }, _f = {
        filter: lf,
        preprocess: ts({
            tags: [{
                name: Ec.pattern(/^(p|h\d+)$/, Ec.caseInsensitive),
                mutate: function(t) {
                    Lf(t).each(function(t) {
                        t.mutate()
                    })
                }
            }]
        })
    }, Nf = function(t, e) {
        return Gi(t, e).isSome()
    }, Cf = function(t) {
        return void 0 === t.dom().attributes || null === t.dom().attributes || 0 === t.dom().attributes.length || 1 === t.dom().attributes.length && "style" === t.dom().attributes[0].name
    }, Of = {
        isNotImage: function(t) {
            return "img" !== Ye(t)
        },
        hasContent: function(t) {
            return !Cf(t) || (n = (e = t).dom().attributes,
            r = null != n && 0 < n.length,
            ("span" !== Ye(e) || r) && Nf(t, function(t) {
                var e = !Cf(t)
                  , n = !W(["font", "em", "strong", "samp", "acronym", "cite", "code", "dfn", "kbd", "tt", "b", "i", "u", "s", "sub", "sup", "ins", "del", "var", "span"], Ye(t));
                return Xe(t) || e || n
            }));
            var e, n, r
        },
        isList: function(t) {
            return "ol" === Ye(t) || "ul" === Ye(t)
        },
        isLocal: function(t) {
            var e = Ze(t, "src");
            return /^file:/.test(e)
        },
        hasNoAttributes: Cf,
        isEmpty: function(t) {
            return 0 === wu(t).length
        }
    }, Df = function(t, e) {
        var n = ln.fromTag(t);
        da(e, n);
        var r = e.dom().attributes;
        $(r, function(t) {
            n.dom().setAttribute(t.name, t.value)
        });
        var o = Mo(e);
        return ya(n, o),
        Za(e),
        n
    }, Af = function(t) {
        return Ao(t).bind(function(t) {
            return Xe(t) && 0 === Hu(t).trim().length ? Af(t) : "li" === Ye(t) ? P.some(t) : P.none()
        })
    }, Pf = {
        changeTag: Df,
        addBrTag: function(t) {
            0 === wu(t).length && ga(t, ln.fromTag("br"))
        },
        properlyNest: function(n) {
            Oo(n).each(function(t) {
                var e = Ye(t);
                W(["ol", "ul"], e) && Af(n).fold(function() {
                    var t = ln.fromTag("li");
                    gu(t, "list-style-type", "none"),
                    va(n, t)
                }, function(t) {
                    ga(t, n)
                })
            })
        },
        fontToSpan: function(t) {
            var o = Df("span", t)
              , i = {
                "font-size": {
                    1: "8pt",
                    2: "10pt",
                    3: "12pt",
                    4: "14pt",
                    5: "18pt",
                    6: "24pt",
                    7: "36pt"
                }
            };
            it({
                face: "font-family",
                size: "font-size",
                color: "color"
            }, function(t, e) {
                if (Je(o, e)) {
                    var n = Ze(o, e)
                      , r = void 0 !== i[t] && void 0 !== i[t][n] ? i[t][n] : n;
                    gu(o, t, r),
                    Qe(o, e)
                }
            })
        }
    }, kf = Yu($e, "comment"), Mf = function(t) {
        return kf.get(t)
    }, Rf = Qc({
        tags: [{
            name: Ec.pattern(/^([OVWXP]|U[0-9]+|ST[0-9]+):/i, Ec.caseInsensitive)
        }]
    }), Ff = Jc({
        attributes: [{
            name: Ec.exact("id", Ec.caseInsensitive),
            value: Ec.starts("docs-internal-guid", Ec.caseInsensitive)
        }]
    }), jf = [es([_f.filter])], Uf = Jc({
        attributes: [{
            name: Ec.pattern(/^v:/, Ec.caseInsensitive)
        }, {
            name: Ec.exact("href", Ec.caseInsensitive),
            value: Ec.contains("#_toc", Ec.caseInsensitive)
        }, {
            name: Ec.exact("href", Ec.caseInsensitive),
            value: Ec.contains("#_mso", Ec.caseInsensitive)
        }, {
            name: Ec.pattern(/^xmlns(:|$)/, Ec.caseInsensitive)
        }, {
            name: Ec.exact("type", Ec.caseInsensitive),
            condition: Of.isList
        }]
    }), Bf = Jc({
        tags: [{
            name: Ec.exact("script", Ec.caseInsensitive)
        }, {
            name: Ec.exact("link", Ec.caseInsensitive)
        }, {
            name: Ec.exact("style", Ec.caseInsensitive),
            condition: Of.isEmpty
        }],
        attributes: [{
            name: Ec.starts("on", Ec.caseInsensitive)
        }, {
            name: Ec.exact('"', Ec.caseInsensitive)
        }, {
            name: Ec.exact("lang", Ec.caseInsensitive)
        }, {
            name: Ec.exact("language", Ec.caseInsensitive)
        }],
        styles: [{
            name: Ec.all(),
            value: Ec.pattern(/OLE_LINK/i, Ec.caseInsensitive)
        }]
    }), Yf = Jc({
        tags: [{
            name: Ec.exact("meta", Ec.caseInsensitive)
        }]
    }), Wf = Jc({
        tags: [{
            name: Ec.exact("style", Ec.caseInsensitive)
        }]
    }), Hf = Jc({
        styles: [{
            name: Ec.not(Ec.pattern(/width|height|list-style-type/, Ec.caseInsensitive)),
            condition: function(t) {
                return !Wi(t, "ephox-limbo-transform")
            }
        }, {
            name: Ec.pattern(/width|height/, Ec.caseInsensitive),
            condition: Of.isNotImage
        }]
    }), qf = Qc({
        tags: [{
            name: Ec.exact("strong", Ec.caseInsensitive)
        }, {
            name: Ec.exact("em", Ec.caseInsensitive)
        }, {
            name: Ec.exact("b", Ec.caseInsensitive)
        }, {
            name: Ec.exact("i", Ec.caseInsensitive)
        }, {
            name: Ec.exact("u", Ec.caseInsensitive)
        }, {
            name: Ec.exact("strike", Ec.caseInsensitive)
        }, {
            name: Ec.exact("sub", Ec.caseInsensitive)
        }, {
            name: Ec.exact("sup", Ec.caseInsensitive)
        }, {
            name: Ec.exact("font", Ec.caseInsensitive)
        }]
    }), $f = Jc({
        classes: [{
            name: Ec.not(Ec.exact("rtf-data-image", Ec.caseInsensitive))
        }]
    }), Vf = Jc({
        styles: [{
            name: Ec.pattern(yc(), Ec.caseInsensitive)
        }]
    }), Xf = Jc({
        classes: [{
            name: Ec.pattern(/mso/i, Ec.caseInsensitive)
        }]
    }), Gf = Qc({
        tags: [{
            name: Ec.exact("img", Ec.caseInsensitive),
            condition: Of.isLocal
        }]
    }), zf = Qc({
        tags: [{
            name: Ec.exact("a", Ec.caseInsensitive),
            condition: Of.hasNoAttributes
        }]
    }), Kf = Jc({
        attributes: [{
            name: Ec.exact("style", Ec.caseInsensitive),
            value: Ec.exact("", Ec.caseInsensitive),
            debug: !0
        }]
    }), Zf = Jc({
        attributes: [{
            name: Ec.exact("class", Ec.caseInsensitive),
            value: Ec.exact("", Ec.caseInsensitive),
            debug: !0
        }]
    }), Jf = Qc({
        tags: [{
            name: Ec.pattern(bc(), Ec.caseInsensitive),
            condition: w(Of.hasContent)
        }]
    }), Qf = Qc({
        tags: [{
            name: Ec.exact("p", Ec.caseInsensitive),
            condition: (Ls = "li",
            function(t) {
                return Oo(t).exists(function(t) {
                    return Ye(t) === Ls && 1 === Mo(t).length
                })
            }
            )
        }]
    }), tl = ts({
        tags: [{
            name: Ec.exact("p", Ec.caseInsensitive),
            mutate: Pf.addBrTag
        }]
    }), el = ts({
        tags: [{
            name: Ec.pattern(/ol|ul/, Ec.caseInsensitive),
            mutate: Pf.properlyNest
        }]
    }), nl = ts({
        tags: [{
            name: Ec.exact("b", Ec.caseInsensitive),
            mutate: y(Pf.changeTag, "strong")
        }, {
            name: Ec.exact("i", Ec.caseInsensitive),
            mutate: y(Pf.changeTag, "em")
        }, {
            name: Ec.exact("u", Ec.caseInsensitive),
            mutate: function(t) {
                var e = Pf.changeTag("span", t);
                Bi(e, "ephox-limbo-transform"),
                gu(e, "text-decoration", "underline")
            }
        }, {
            name: Ec.exact("s", Ec.caseInsensitive),
            mutate: y(Pf.changeTag, "strike")
        }, {
            name: Ec.exact("font", Ec.caseInsensitive),
            mutate: Pf.fontToSpan,
            debug: !0
        }]
    }), rl = Jc({
        classes: [{
            name: Ec.exact("ephox-limbo-transform", Ec.caseInsensitive)
        }]
    }), ol = Jc({
        tags: [{
            name: Ec.exact("br", Ec.caseInsensitive),
            condition: $i("Apple-interchange-newline")
        }]
    }), il = {
        unwrapWordTags: Rf,
        removeWordAttributes: Uf,
        removeGoogleDocsId: Ff,
        parseLists: jf,
        removeExcess: Bf,
        removeMetaTags: Yf,
        removeStyleTags: Wf,
        cleanStyles: Hf,
        cleanInlineStyleElements: qf,
        cleanClasses: $f,
        cleanupBrowserCruft: Jc({
            styles: [{
                name: Ec.pattern(/^-/, Ec.caseInsensitive)
            }, {
                name: Ec.all(),
                value: Ec.exact("initial", Ec.caseInsensitive)
            }, {
                name: Ec.exact("background-color", Ec.caseInsensitive),
                value: Ec.exact("transparent", Ec.caseInsensitive)
            }, {
                name: Ec.exact("font-style", Ec.caseInsensitive),
                value: Ec.exact("normal", Ec.caseInsensitive)
            }, {
                name: Ec.pattern(/font-variant.*/, Ec.caseInsensitive)
            }, {
                name: Ec.exact("letter-spacing", Ec.caseInsensitive)
            }, {
                name: Ec.exact("font-weight", Ec.caseInsensitive),
                value: Ec.pattern(/400|normal/, Ec.caseInsensitive)
            }, {
                name: Ec.exact("orphans", Ec.caseInsensitive)
            }, {
                name: Ec.exact("text-decoration", Ec.caseInsensitive),
                value: Ec.exact("none", Ec.caseInsensitive)
            }, {
                name: Ec.exact("text-size-adjust", Ec.caseInsensitive)
            }, {
                name: Ec.exact("text-indent", Ec.caseInsensitive),
                value: Ec.exact("0px", Ec.caseInsensitive)
            }, {
                name: Ec.exact("text-transform", Ec.caseInsensitive),
                value: Ec.exact("none", Ec.caseInsensitive)
            }, {
                name: Ec.exact("white-space", Ec.caseInsensitive),
                value: Ec.exact("normal", Ec.caseInsensitive)
            }, {
                name: Ec.exact("widows", Ec.caseInsensitive)
            }, {
                name: Ec.exact("word-spacing", Ec.caseInsensitive),
                value: Ec.exact("0px", Ec.caseInsensitive)
            }, {
                name: Ec.exact("text-align", Ec.caseInsensitive),
                value: Ec.pattern(/start|end/, Ec.caseInsensitive)
            }, {
                name: Ec.exact("font-weight", Ec.caseInsensitive),
                value: Ec.pattern(/700|bold/, Ec.caseInsensitive),
                condition: function(t) {
                    return /^h\d$/.test(Ye(t))
                }
            }]
        }),
        cleanupBrowserTags: ol,
        unwrapConvertedSpace: (Ns = (_s = function(t, n) {
            return function(e) {
                return t(e).filter(function(t) {
                    return Xe(e) && n(vf(t), " ")
                }).isSome()
            }
        }
        )(Ao, Se),
        Cs = _s(Po, Ie),
        ts({
            tags: [{
                name: Ec.exact("span", Ec.caseInsensitive),
                condition: $i("Apple-converted-space"),
                mutate: function(t) {
                    "\xa0" === vf(t) && (Ns(t) || Cs(t) ? Ja(t) : (da(t, ln.fromText(" ")),
                    Za(t)))
                }
            }]
        })),
        mergeStyles: Vf,
        mergeClasses: Xf,
        removeLocalImages: Gf,
        removeVacantLinks: zf,
        removeEmptyStyle: Kf,
        removeEmptyClass: Zf,
        pruneInlineTags: Jf,
        unwrapSingleParagraphsInlists: Qf,
        addPlaceholders: tl,
        nestedListFixes: el,
        inlineTagFixes: nl,
        cleanupFlags: rl,
        distillAnchorsFromLocalLinks: (Os = /^file:\/\/\/[^#]+(#[^#]+)$/,
        ts({
            tags: [{
                name: Ec.exact("a", Ec.caseInsensitive),
                condition: function(t) {
                    var e = Ze(t, "href");
                    return !!e && Os.test(e)
                },
                mutate: function(t) {
                    var e = Ze(t, "href");
                    ze(t, "href", e.replace(Os, "$1"))
                }
            }]
        })),
        removeLocalLinks: Jc({
            attributes: [{
                name: Ec.exact("href", Ec.caseInsensitive),
                value: Ec.starts("file:///", Ec.caseInsensitive),
                debug: !0
            }]
        }),
        replaceClipboardChangedUrls: ts({
            tags: [(Ds = function(t, n, r) {
                return {
                    name: Ec.exact(t, Ec.caseInsensitive),
                    condition: function(t) {
                        return Je(t, n)
                    },
                    mutate: function(t) {
                        var e = Ze(t, n);
                        ze(t, r, e),
                        Qe(t, n)
                    }
                }
            }
            )("a", "data-ephox-href", "href"), Ds("img", "data-ephox-src", "src")]
        }),
        removeFragmentComments: function(a) {
            var u = ["table", "thead", "tbody", "tfoot", "th", "tr", "td", "ul", "ol", "li"]
              , t = Bo(a, $e)
              , e = G(t, function(t) {
                return Ee(Mf(t), "StartFragment")
            })
              , n = G(t, function(t) {
                return Ee(Mf(t), "EndFragment")
            });
            e.each(function(i) {
                n.each(function(t) {
                    for (var e, n = i, r = [], o = (e = Cu(i, 0, t, 0),
                    ln.fromDom(e.commonAncestorContainer)); void 0 !== o && !_o(o, a); )
                        W(u, Ye(o)) ? n = o : r.push(o),
                        o = Oo(o).getOr(void 0);
                    $(r, Ja),
                    $(ko(n), Za)
                }),
                Za(i)
            }),
            n.each(Za)
        },
        none: L
    }, al = function(t) {
        return t.browser.isIE() && 11 <= t.browser.version.major
    }, ul = function(i, a) {
        return os(function(t, e) {
            var r, o, n = (r = e,
            o = a,
            i(ln.fromDom(r.getNode())).fold(function() {
                return [r]
            }, function(t) {
                var e = r.type() === Xc.END_ELEMENT_TYPE
                  , n = [Xc.token(t.dom(), e)];
                return !e && o && n.push(Xc.token(t.dom(), !0)),
                n
            }));
            $(n, t.emit)
        }, L)
    }, cl = function(t, e, n) {
        var r, o, i, a, u, c, s, f, l, d, m, p, g, v = (r = t,
        i = (o = n).browser.isFirefox() || o.browser.isEdge(),
        a = i ? hc.local : hc.vshape,
        u = !i,
        c = al(o) ? il.none : es([ul(a, u)]),
        {
            annotate: [r ? c : il.none],
            local: [i ? il.none : il.removeLocalImages]
        });
        return J([v.local, (p = t,
        g = n,
        al(g) || !p ? [] : [_f.preprocess]), v.annotate, [il.inlineTagFixes], function(t, e, n) {
            if (!t)
                return [il.none];
            var r = [il.unwrapWordTags]
              , o = al(n) ? [] : il.parseLists;
            return r.concat(o).concat([il.removeWordAttributes])
        }(t, 0, n), [il.removeGoogleDocsId], [il.nestedListFixes], [il.removeExcess], [il.removeMetaTags], (m = e,
        m ? [il.mergeStyles, il.mergeClasses] : [il.cleanStyles, il.cleanInlineStyleElements, il.cleanClasses]), [il.distillAnchorsFromLocalLinks, il.removeLocalLinks, il.removeVacantLinks, il.replaceClipboardChangedUrls], [il.removeEmptyStyle], [il.removeEmptyClass], [il.pruneInlineTags], [il.cleanupBrowserTags], (l = t,
        d = e,
        !l && d ? [il.cleanupBrowserCruft] : []), [il.unwrapConvertedSpace], [il.addPlaceholders], (s = t,
        f = n,
        al(f) && s ? [il.unwrapSingleParagraphsInlists] : []), [il.cleanupFlags], [il.removeStyleTags]])
    }, sl = ["body", "p", "div", "article", "aside", "figcaption", "figure", "footer", "header", "nav", "section", "ol", "ul", "li", "table", "thead", "tbody", "tfoot", "caption", "tr", "td", "th", "h1", "h2", "h3", "h4", "h5", "h6", "blockquote", "pre", "address"], fl = function(t) {
        return e = t,
        n = v(0),
        r = v(0),
        o = P.none(),
        {
            term: function() {
                return new RegExp(e,o.getOr("g"))
            },
            prefix: n,
            suffix: r
        };
        var e, n, r, o
    }, ll = function(t, e) {
        return z(t, function(t) {
            return t.start() === e
        })
    }, dl = function(t, e, n) {
        var r, o, i = n(t, e);
        return r = i,
        o = t.start(),
        q(r, function(t) {
            return ai({}, t, {
                start: v(t.start() + o),
                finish: v(t.finish() + o)
            })
        })
    }, ml = function(t, n, e) {
        return void 0 === e && (e = 0),
        X(t, function(e, t) {
            return n(t, e.len).fold(v(e), function(t) {
                return {
                    len: t.finish(),
                    list: e.list.concat([t])
                }
            })
        }, {
            len: e,
            list: []
        }).list
    }, pl = function(t, e, n) {
        return 0 === e.length ? t : Q(t, function(r) {
            var t = Q(e, function(t) {
                return (n = t) >= (e = r).start() && n <= e.finish() ? [t - r.start()] : [];
                var e, n
            });
            return 0 < t.length ? dl(r, t, n) : [r]
        })
    }, gl = function(o, t, i) {
        var e = ll(o, t)
          , a = ll(o, i);
        return e.bind(function(t) {
            var e, n, r = a.getOr((n = i,
            (e = o)[e.length - 1] && e[e.length - 1].finish() === n ? e.length + 1 : -1));
            return -1 < r ? P.some(o.slice(t, r)) : P.none()
        }).getOr([])
    }, vl = function(n, t) {
        var e, r, o = Q(t, function(e) {
            var t = function(t, e) {
                for (var n = e.term(), r = [], o = n.exec(t); o; ) {
                    var i = o.index + e.prefix(o)
                      , a = o[0].length - e.prefix(o) - e.suffix(o);
                    r.push({
                        start: v(i),
                        finish: v(i + a)
                    }),
                    n.lastIndex = i + a,
                    o = n.exec(t)
                }
                return r
            }(n, e.pattern());
            return q(t, function(t) {
                return ai({}, e, t)
            })
        });
        return e = o,
        (r = Array.prototype.slice.call(e, 0)).sort(function(t, e) {
            return t.start() < e.start() ? -1 : e.start() < t.start() ? 1 : 0
        }),
        r
    }, hl = (no("word", "pattern"),
    no("element", "offset"),
    no("element", "deltaOffset"),
    no("element", "start", "finish")), yl = (no("begin", "end"),
    no("element", "text"),
    ft([{
        include: ["item"]
    }, {
        excludeWith: ["item"]
    }, {
        excludeWithout: ["item"]
    }])), bl = {
        include: yl.include,
        excludeWith: yl.excludeWith,
        excludeWithout: yl.excludeWithout,
        cata: function(t, e, n, r) {
            return t.fold(e, n, r)
        }
    }, xl = function(t, n) {
        var r = []
          , o = [];
        return $(t, function(t) {
            var e = n(t);
            bl.cata(e, function() {
                o.push(t)
            }, function() {
                0 < o.length && r.push(o),
                r.push([t]),
                o = []
            }, function() {
                0 < o.length && r.push(o),
                o = []
            })
        }),
        0 < o.length && r.push(o),
        r
    }, Tl = ft([{
        boundary: ["item", "universe"]
    }, {
        empty: ["item", "universe"]
    }, {
        text: ["item", "universe"]
    }]), El = S, wl = _, Il = v(0), Sl = v(1), Ll = function(t) {
        return ai({}, t, {
            isBoundary: function() {
                return t.fold(wl, El, El)
            },
            toText: function() {
                return t.fold(P.none, P.none, function(t) {
                    return P.some(t)
                })
            },
            is: function(n) {
                return t.fold(El, El, function(t, e) {
                    return e.eq(t, n)
                })
            },
            len: function() {
                return t.fold(Il, Sl, function(t, e) {
                    return e.property().getText(t).length
                })
            }
        })
    }, _l = {
        text: g(Ll, Tl.text),
        boundary: g(Ll, Tl.boundary),
        empty: g(Ll, Tl.empty),
        cata: function(t, e, n, r) {
            return t.fold(e, n, r)
        }
    }, Nl = function(e, t, n) {
        if (e.property().isText(t))
            return [_l.text(t, e)];
        if (e.property().isEmptyTag(t))
            return [_l.empty(t, e)];
        if (e.property().isElement(t)) {
            var r = e.property().children(t)
              , o = e.property().isBoundary(t) ? [_l.boundary(t, e)] : []
              , i = void 0 !== n && n(t) ? [] : Q(r, function(t) {
                return Nl(e, t, n)
            });
            return o.concat(i).concat(o)
        }
        return []
    }, Cl = Nl, Ol = function(e, t, n) {
        var r = Q(t, function(t) {
            return Cl(e, t, n)
        })
          , o = xl(r, function(t) {
            return t.match({
                boundary: function() {
                    return bl.excludeWithout(t)
                },
                empty: function() {
                    return bl.excludeWith(t)
                },
                text: function() {
                    return bl.include(t)
                }
            })
        });
        return V(o, function(t) {
            return 0 < t.length
        })
    }, Dl = function(r, t) {
        if (0 === t.length)
            return [r];
        var e = X(t, function(t, e) {
            if (0 === e)
                return t;
            var n = r.substring(t.prev, e);
            return {
                prev: e,
                values: t.values.concat([n])
            }
        }, {
            prev: 0,
            values: []
        })
          , n = t[t.length - 1];
        return n < r.length ? e.values.concat(r.substring(n)) : e.values
    }, Al = function(o, t, e) {
        var n = Q(e, function(t) {
            return [t.start(), t.finish()]
        })
          , i = pl(t, n, function(t, e) {
            return function(o, t, e) {
                var n = o.property().getText(t)
                  , r = V(Dl(n, e), function(t) {
                    return 0 < t.length
                });
                if (r.length <= 1)
                    return [hl(t, 0, n.length)];
                o.property().setText(t, r[0]);
                var i = ml(r.slice(1), function(t, e) {
                    var n = o.create().text(t)
                      , r = hl(n, e, e + t.length);
                    return P.some(r)
                }, r[0].length)
                  , a = q(i, function(t) {
                    return t.element()
                });
                return o.insert().afterAll(t, a),
                [hl(t, 0, r[0].length)].concat(i)
            }(o, t.element(), e)
        });
        return q(e, function(t) {
            var e = gl(i, t.start(), t.finish())
              , n = q(e, function(t) {
                return t.element()
            })
              , r = q(n, o.property().getText).join("");
            return {
                elements: function() {
                    return n
                },
                word: t.word,
                exact: function() {
                    return r
                }
            }
        })
    }, Pl = function(a, t, u, e) {
        var n = Ol(a, t, e);
        return Q(n, function(t) {
            var r, e = Q(t, function(t) {
                return t.fold(v([]), v([]), function(t) {
                    return [t]
                })
            }), n = q(e, a.property().getText).join(""), o = vl(n, u), i = (r = a,
            ml(e, function(t, e) {
                var n = e + r.property().getText(t).length;
                return P.from(hl(t, e, n))
            }));
            return Al(a, i, o)
        })
    }, kl = {
        up: v({
            selector: Ki,
            closest: Ji,
            predicate: Vi,
            all: Do
        }),
        down: v({
            selector: Yo,
            predicate: Bo
        }),
        styles: v({
            get: hu,
            getRaw: bu,
            set: gu,
            remove: Tu
        }),
        attrs: v({
            get: Ze,
            set: ze,
            remove: Qe,
            copyTo: function(t, e) {
                var n = X(t.dom().attributes, function(t, e) {
                    return t[e.name] = e.value,
                    t
                }, {});
                Ke(e, n)
            }
        }),
        insert: v({
            before: da,
            after: ma,
            afterAll: ha,
            append: ga,
            appendAll: ya,
            prepend: pa,
            wrap: va
        }),
        remove: v({
            unwrap: Ja,
            remove: Za
        }),
        create: v({
            nu: ln.fromTag,
            clone: function(t) {
                return ln.fromDom(t.dom().cloneNode(!1))
            },
            text: ln.fromText
        }),
        query: v({
            comparePosition: function(t, e) {
                return t.dom().compareDocumentPosition(e.dom())
            },
            prevSibling: Ao,
            nextSibling: Po
        }),
        property: v({
            children: Mo,
            name: Ye,
            parent: Oo,
            document: function(t) {
                return t.dom().ownerDocument
            },
            isText: Xe,
            isComment: $e,
            isElement: Ve,
            getText: Hu,
            setText: qu,
            isBoundary: function(t) {
                return !!Ve(t) && ("body" === Ye(t) || W(sl, Ye(t)))
            },
            isEmptyTag: function(t) {
                return !!Ve(t) && W(["br", "img", "hr", "input"], Ye(t))
            }
        }),
        eq: _o,
        is: No
    }, Ml = function(t) {
        return zi(t).isSome()
    }, Rl = /(?:(?:[A-Za-z]{3,9}:(?:\/\/))(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?[A-Za-z0-9-]+(?:\.[A-Za-z0-9-]+)*|(?:www\.|[-;:&=+$,.\w]+@)[A-Za-z0-9-]+(?:\.[A-Za-z0-9-]+)*)(?::[0-9]+)?(?:\/[-+~=%.()\/\w]*)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source, Fl = function(t) {
        var e, n = no("word", "pattern")("__INTERNAL__", fl(Rl));
        return Pl(kl, t, [n], e)
    }, jl = function(t) {
        return !Ji(t, "a", e).isSome();
        var e
    }, Ul = function(t) {
        var e = t.indexOf("://");
        return 3 <= e && e <= 9
    }, Bl = {
        links: function(t) {
            var e = Fl(t);
            $(e, function(t) {
                var n, e = t.exact();
                (e.indexOf("@") < 0 || Ul(e)) && (n = t.elements(),
                P.from(n[0]).filter(jl).map(function(t) {
                    var e = ln.fromTag("a");
                    return da(t, e),
                    ya(e, n),
                    ze(e, "href", vf(e)),
                    e
                }))
            })
        },
        position: function(t) {
            $(t, function(t) {
                Ve(t) && bu(t, "position").isSome() && Tu(t, "position")
            })
        },
        list: function(t) {
            var e = V(t, function(t) {
                return "li" === Ye(t)
            });
            if (0 < e.length) {
                var n = ko(e[0])
                  , r = ln.fromTag("ul");
                if (da(t[0], r),
                0 < n.length) {
                    var o = ln.fromTag("li");
                    ga(r, o),
                    ya(o, n)
                }
                ya(r, e)
            }
        }
    }, Yl = function(t) {
        var e = Mo(t);
        $([Bl.links, Bl.position, Bl.list], function(t) {
            t(e)
        })
    }, Wl = function(t, e, n, r, o) {
        Yl(n);
        var i = wu(n)
          , a = cl(o, r, e);
        return rs(t, i, a)
    }, Hl = Yl, ql = function(t, e) {
        var n = wu(e);
        return rs(t, n, [il.removeMetaTags, il.replaceClipboardChangedUrls])
    }, $l = function(t, e) {
        var n = wu(e);
        return rs(t, n, [il.removeFragmentComments])
    }, Vl = function(t) {
        var i = function(t) {
            return "_" + t
        }
          , o = function(t, e) {
            return t._simpleAdt === i(e)
        }
          , a = ot(t)
          , n = {};
        $(a, function(e) {
            n["as" + we(e)] = function(t) {
                return o(t, e) ? P.some(t.data) : P.none()
            }
        });
        var e = {};
        return it(t, function(r, o) {
            e[o] = function(t) {
                return {
                    _simpleAdt: i(o),
                    data: (e = r,
                    n = t,
                    0 === e.length ? {} : io(e, [])(n)),
                    _simpleAdt_data: t
                };
                var e, n
            }
        }),
        mt(n, {
            constructors: e,
            match: function(e, n) {
                var t, r = ot(n);
                if (r.length !== a.length)
                    throw new Error("Partial match");
                return Bu(r, function(t) {
                    return o(e, t) ? P.some(n[t]) : P.none()
                }).getOrDie("Must find branch for constructor: " + (0 === (t = e._simpleAdt).indexOf("") ? t.substring("".length + "_".length) : t))(e.data)
            }
        })
    }, Xl = Vl({
        disabled: [],
        fromClipboard: ["rtf"]
    }), Gl = Xl.match, zl = {
        disabled: Xl.constructors.disabled,
        fromClipboard: Xl.constructors.fromClipboard,
        match: Gl
    }, Kl = function(t, e) {
        var n = new RegExp(e,"i");
        return Bu(t, function(t) {
            return null !== t.match(n) ? P.some({
                type: t,
                flavor: e
            }) : P.none()
        })
    }, Zl = {
        isValidData: function(t) {
            return void 0 !== t && void 0 !== t.types && null !== t.types
        },
        getPreferredFlavor: function(t, e) {
            return Bu(t, function(t) {
                return Kl(e, t)
            })
        },
        getFlavor: Kl
    }, Jl = Vl({
        event: ["nativeEvent"],
        html: ["container"],
        word: ["html", "rtf"],
        text: ["text"],
        images: ["images"],
        void: []
    }), Ql = Pe.detect().browser, td = !(Ql.isIE() || Ql.isEdge() && Ql.version.major < 16), ed = ["^image/", "file"], nd = function(t) {
        return Ee(e = t, "<html") && (Ee(e, 'xmlns:o="urn:schemas-microsoft-com:office:office"') || Ee(e, 'xmlns:x="urn:schemas-microsoft-com:office:excel"')) || Ee(t, 'meta name="ProgId" content="Word.Document"');
        var e
    }, rd = function(t) {
        return Ee(t, "<meta") && Ee(t, 'id="docs-internal-guid')
    }, od = function(t) {
        return 0 < t.length
    }, id = function(e, t) {
        return Zl.getFlavor(e.types, t).map(function(t) {
            return e.getData(t.type)
        }).filter(od)
    }, ad = function(t) {
        return id(t, "html")
    }, ud = function(t) {
        return ad(t).filter(rd)
    }, cd = function(t) {
        return td ? P.some(t.clipboardData).filter(Zl.isValidData) : P.none()
    }, sd = function(t) {
        var e = ln.fromTag("div");
        Iu(e, t);
        var n = $l(Co(e), e)
          , r = ln.fromTag("div");
        return Iu(r, n),
        Jl.constructors.html({
            container: r
        })
    }, fd = function(t) {
        var e = function(e) {
            return void 0 === e.items ? P.none() : Zl.getPreferredFlavor(ed, e.types).map(function(t) {
                return Jl.constructors.images({
                    images: e.items
                })
            })
        }
          , r = function(e) {
            return Bu(e.types, function(t) {
                return "text/plain" === t ? P.some(e.getData(t)).map(function(t) {
                    return Jl.constructors.text({
                        text: t
                    })
                }) : P.none()
            })
        };
        return {
            getWordData: function() {
                return cd(t).bind(function(n) {
                    return (t = n,
                    ad(t).filter(nd)).map(function(t) {
                        var e = id(n, "rtf");
                        return Jl.constructors.word({
                            html: t,
                            rtf: e.fold(function() {
                                return zl.disabled()
                            }, function(t) {
                                return zl.fromClipboard({
                                    rtf: t
                                })
                            })
                        })
                    });
                    var t
                })
            },
            getGoogleDocsData: function() {
                return cd(t).bind(ud).map(sd)
            },
            getImage: function() {
                return cd(t).bind(e)
            },
            getText: function() {
                return cd(t).fold(function() {
                    var t = l.window.clipboardData;
                    return void 0 !== t ? P.some(Jl.constructors.text({
                        text: t.getData("text")
                    })) : P.none()
                }, r)
            },
            getHtml: function() {
                return cd(t).bind(ad).map(sd)
            },
            getOnlyText: function() {
                return cd(t).bind(function(t) {
                    return e = t.types,
                    n = "text/plain",
                    1 === e.length && e[0] === n ? r(t) : P.none();
                    var e, n
                })
            },
            getNative: function() {
                return Jl.constructors.event({
                    nativeEvent: t
                })
            },
            getVoid: function() {
                return Jl.constructors.void({})
            }
        }
    }, ld = function(t) {
        return {
            getWordData: function() {
                return P.some(Jl.constructors.word({
                    html: t,
                    rtf: zl.disabled()
                }))
            },
            getGoogleDocsData: P.none,
            getImage: P.none,
            getHtml: P.none,
            getText: P.none,
            getNative: I("There is no native event"),
            getOnlyText: P.none,
            getVoid: I("There is no paste event")
        }
    }, dd = function(t) {
        return {
            getWordData: P.none,
            getGoogleDocsData: P.none,
            getImage: P.none,
            getHtml: P.none,
            getText: function() {
                return P.some(Jl.constructors.text({
                    text: t
                }))
            },
            getNative: I("There is no native event"),
            getOnlyText: P.none,
            getVoid: I("There is no paste event")
        }
    }, md = function(t) {
        return q(t, function(t) {
            return t.asset()
        })
    };
    function pd(i, a) {
        var u = so.create({
            cancel: co([]),
            error: co(["message"]),
            insert: co(["elements", "assets", "correlated", "isInternal"])
        })
          , r = function(t, e, n) {
            var r = dc(i, a, t);
            r.capture() && n();
            var o = q(r.steps(), function(t) {
                return t(e)
            });
            mc(o, r.input()).get(function(t) {
                var r = t.bundle().isInternal().getOr(!1);
                ec.cata(t.response(), function(t) {
                    u.trigger.error(t)
                }, function(t, e) {
                    u.trigger.insert(t, md(e), e, r)
                }, function() {
                    u.trigger.cancel()
                }, function(t, e, n) {
                    u.trigger.insert(t, md(e), e, r),
                    u.trigger.error(n)
                })
            })
        }
          , o = eu.tap(function(n) {
            zu(n.target.ownerDocument.defaultView).each(function(t) {
                if (!Wi(t.start(), lu.bin())) {
                    var e = fd(n);
                    iu.willBlock() && (o.control.block(),
                    n.preventDefault()),
                    r(e, o.control, function() {
                        n.preventDefault()
                    })
                }
            })
        });
        return {
            paste: o.instance,
            pasteCustom: function(t) {
                var e = eu.tap(L);
                r(t, e.control, L)
            },
            isBlocked: o.control.isBlocked,
            destroy: L,
            events: u.registry
        }
    }
    var gd = function() {
        var e = P.none();
        return {
            convert: function(t) {
                e = function(n) {
                    var t, e = yt("window.clipboardData.files"), r = void 0 !== (t = n).convertURL ? t.convertURL : void 0 !== t.msConvertURL ? t.msConvertURL : void 0;
                    if (void 0 !== e && void 0 !== r && 0 < e.length) {
                        var o = Jt(e, function(t) {
                            var e = Me(t);
                            return r.apply(n, [t, "specified", e]),
                            sn.singleWithUrl(t, e)
                        });
                        return P.some(o)
                    }
                    return P.none()
                }(t)
            },
            listen: function(t) {
                return e.fold(function() {
                    return zt.nu(function(t) {
                        t([])
                    })
                }, function(t) {
                    return t
                }).get(t)
            },
            clear: function() {
                e = P.none()
            }
        }
    }
      , vd = no("asset", "image")
      , hd = function(t, o) {
        return vt.cata(t, function(t, e, n, r) {
            return ze(o, "src", n),
            !0
        }, S)
    }
      , yd = function(t, r) {
        var o = [];
        return $(t, function(t, e) {
            var n = r[e];
            hd(t, n) && o.push(vd(t, n))
        }),
        o
    }
      , bd = function(t) {
        return Jt(t, function(u) {
            return zt.nu(function(i) {
                var t, a = u.dom();
                (t = a,
                Ut(t)).then(function(o) {
                    o.toBlob().then(function(t) {
                        var e = Ie(a.src, "blob:") ? a.src : l.URL.createObjectURL(t)
                          , n = te("image")
                          , r = vt.blob(n, o, e);
                        i(vd(r, u))
                    })
                })
            })
        })
    }
      , xd = function(e, t) {
        return (n = t,
        Ot(n)).map(function(t) {
            return vd(sn.single(t), e)
        });
        var n
    }
      , Td = function(t) {
        var e = ln.fromTag("div");
        return ya(e, t),
        Yo(e, "img[src]")
    }
      , Ed = function(t) {
        return 0 === t.indexOf("data:") && -1 < t.indexOf("base64")
    }
      , wd = function(t) {
        return 0 === t.indexOf("blob:")
    }
      , Id = function(t) {
        var e = Ze(t, "src");
        return Ed(e) || wd(e)
    }
      , Sd = function(t) {
        return Q(Td(t), function(t) {
            var n, e, r = Ze(t, "src");
            return Ed(r) ? xd(t, r).toArray() : wd(r) ? (n = t,
            e = r,
            Mt(e).map(function(t) {
                var e = zt.nu(function(e) {
                    t.then(function(t) {
                        sn.single(t).get(e)
                    })
                });
                return vd(e, n)
            })).toArray() : []
        })
    };
    function Ld(f) {
        return function(t, s) {
            return fc(function(a) {
                var u = function() {
                    uc(a, {
                        response: s.response(),
                        bundle: s.bundle()
                    })
                }
                  , c = function(t) {
                    var e, n, r = V(Td(t), Id);
                    $(r, Za),
                    uc(a, {
                        response: 0 < r.length ? (e = t,
                        n = V(e, function(t) {
                            return "img" !== Ye(t) || !Id(t)
                        }),
                        ec.incomplete(n, [], "errors.local.images.disallowed")) : s.response(),
                        bundle: s.bundle()
                    })
                }
                  , t = function(t, e) {
                    var n, r, o, i;
                    !1 === f.allowLocalImages ? c(t) : 0 === e.length ? (r = Sd(n = t),
                    o = Jt(r, function(t) {
                        return t.asset()
                    }),
                    i = q(r, function(t) {
                        return t.image()
                    }),
                    o.get(function(t) {
                        var e = yd(t, i);
                        uc(a, {
                            response: ec.paste(n, e),
                            bundle: s.bundle()
                        })
                    })) : u()
                };
                ec.cata(s.response(), u, t, u, t)
            })
        }
    }
    var _d = function(t) {
        return t.officeStyles().getOr(!0)
    }
      , Nd = function(t) {
        return t.htmlStyles().getOr(!1)
    }
      , Cd = function(t) {
        return t.isWord().getOr(!1)
    }
      , Od = {
        proxyBin: function(n) {
            return {
                handle: function(t, e) {
                    return n.proxyBin().fold(function() {
                        return l.console.error(t),
                        ac({
                            response: ec.cancel(),
                            bundle: oc({})
                        })
                    }, e)
                }
            }
        },
        backgroundAssets: function(t) {
            return zt.nu(function(e) {
                t.backgroundAssets().fold(function() {
                    e([])
                }, function(t) {
                    t.listen(e)
                })
            })
        },
        merging: function(t) {
            var e = Cd(t);
            return e && _d(t) || !e && Nd(t)
        },
        mergeOffice: _d,
        mergeNormal: Nd,
        isWord: Cd,
        isGoogleDocs: function(t) {
            return t.isGoogleDocs().getOr(!1)
        },
        isInternal: function(t) {
            return t.isInternal().getOr(!1)
        }
    }
      , Dd = {
        resolve: mo("ephox-cement").resolve
    };
    function Ad(s, r) {
        var f = r.translations
          , l = function(t, e, n) {
            n(P.some(pt(e, {
                officeStyles: t,
                htmlStyles: t
            })))
        };
        return {
            get: function(t, e) {
                var n = r[t ? "officeStyles" : "htmlStyles"];
                "clean" === n ? l(!1, r, e) : "merge" === n ? l(!0, r, e) : function(t, e) {
                    var n = ln.fromTag("div");
                    Bi(n, Dd.resolve("styles-dialog-content"));
                    var r = ln.fromTag("p")
                      , o = la(f("cement.dialog.paste.instructions"));
                    ya(r, o),
                    ga(n, r);
                    var i = {
                        text: f("cement.dialog.paste.clean"),
                        tabindex: 0,
                        className: Dd.resolve("clean-styles"),
                        click: function() {
                            u(),
                            l(!1, t, e)
                        }
                    }
                      , a = {
                        text: f("cement.dialog.paste.merge"),
                        tabindex: 1,
                        className: Dd.resolve("merge-styles"),
                        click: function() {
                            u(),
                            l(!0, t, e)
                        }
                    }
                      , u = function() {
                        c.destroy()
                    }
                      , c = s(!0);
                    c.setTitle(f("cement.dialog.paste.title")),
                    c.setContent(n),
                    c.setButtons([i, a]),
                    c.events.close.bind(function() {
                        e(P.none()),
                        u()
                    }),
                    c.show()
                }(r, e)
            },
            destroy: L
        }
    }
    var Pd, kd, Md, Rd = function(t, e) {
        var i = Ad(t, e);
        return function(t, r) {
            var e = r.bundle()
              , o = r.response();
            return fc(function(n) {
                i.get(Od.isWord(e), function(t) {
                    var e = t.fold(function() {
                        return {
                            response: ec.cancel(),
                            bundle: r.bundle()
                        }
                    }, function(t) {
                        return {
                            response: o,
                            bundle: oc({
                                officeStyles: t.officeStyles,
                                htmlStyles: t.htmlStyles
                            })
                        }
                    });
                    uc(n, e)
                })
            })
        }
    }, Fd = Rd, jd = function(r, o) {
        return function(t, e) {
            var n = function(t) {
                return ac({
                    response: e.response(),
                    bundle: oc({
                        officeStyles: t,
                        htmlStyles: t
                    })
                })
            };
            return Od.isInternal(e.bundle()) ? n(!0) : Od.isGoogleDocs(e.bundle()) ? n(!1) : Rd(r, o)(t, e)
        }
    }, Ud = function(t) {
        return function(t) {
            var e = t.dom();
            try {
                var n = e.contentWindow ? e.contentWindow.document : e.contentDocument;
                return null != n ? P.some(ln.fromDom(n)) : P.none()
            } catch (t) {
                return l.console.log("Error reading iframe: ", e),
                l.console.log("Error was: " + t),
                P.none()
            }
        }(t).fold(function() {
            return t
        }, function(t) {
            return t
        })
    }, Bd = function(t, e) {
        if (!bo(t))
            throw "Internal error: attempted to write to an iframe that is not in the DOM";
        var n = Ud(t).dom();
        n.open("text/html", "replace"),
        n.writeln(e),
        n.close()
    }, Yd = function(t) {
        var e = t.dom().styleSheets;
        return Array.prototype.slice.call(e)
    }, Wd = no("selector", "style", "raw"), Hd = function(t) {
        var e = t.cssRules;
        return Q(e, function(t) {
            return t.type === l.CSSRule.IMPORT_RULE ? Hd(t.styleSheet) : t.type === l.CSSRule.STYLE_RULE ? [function(t) {
                var e = t.selectorText
                  , n = t.style.cssText;
                if (void 0 === n)
                    throw "WARNING: Browser does not support cssText property";
                return Wd(e, n, t.style)
            }(t)] : []
        })
    }, qd = function(t) {
        return Q(t, Hd)
    }, $d = {}, Vd = {
        exports: $d
    };
    kd = $d,
    Md = Vd,
    Pd = void 0,
    function(t) {
        "object" == typeof kd && void 0 !== Md ? Md.exports = t() : "function" == typeof Pd && Pd.amd ? Pd([], t) : ("undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this).EphoxContactWrapper = t()
    }(function() {
        return function i(a, u, c) {
            function s(e, t) {
                if (!u[e]) {
                    if (!a[e]) {
                        var n = !1;
                        if (!t && n)
                            return n(e, !0);
                        if (f)
                            return f(e, !0);
                        var r = new Error("Cannot find module '" + e + "'");
                        throw r.code = "MODULE_NOT_FOUND",
                        r
                    }
                    var o = u[e] = {
                        exports: {}
                    };
                    a[e][0].call(o.exports, function(t) {
                        return s(a[e][1][t] || t)
                    }, o, o.exports, i, a, u, c)
                }
                return u[e].exports
            }
            for (var f = !1, t = 0; t < c.length; t++)
                s(c[t]);
            return s
        }({
            1: [function(t, e, n) {
                var r, a, o = (r = function(t) {
                    var e, n, r, o, i = [];
                    for (r = 0,
                    o = (e = t.split(",")).length; r < o; r += 1)
                        0 < (n = e[r]).length && i.push(a(n));
                    return i
                }
                ,
                a = function(c) {
                    var t, e, n, s = c, f = {
                        a: 0,
                        b: 0,
                        c: 0
                    }, l = [];
                    return t = function(t, e) {
                        var n, r, o, i, a, u;
                        if (t.test(s))
                            for (r = 0,
                            o = (n = s.match(t)).length; r < o; r += 1)
                                f[e] += 1,
                                i = n[r],
                                a = s.indexOf(i),
                                u = i.length,
                                l.push({
                                    selector: c.substr(a, u),
                                    type: e,
                                    index: a,
                                    length: u
                                }),
                                s = s.replace(i, Array(u + 1).join(" "))
                    }
                    ,
                    (e = function(t) {
                        var e, n, r, o;
                        if (t.test(s))
                            for (n = 0,
                            r = (e = s.match(t)).length; n < r; n += 1)
                                o = e[n],
                                s = s.replace(o, Array(o.length + 1).join("A"))
                    }
                    )(/\\[0-9A-Fa-f]{6}\s?/g),
                    e(/\\[0-9A-Fa-f]{1,5}\s/g),
                    e(/\\./g),
                    (n = /:not\(([^\)]*)\)/g).test(s) && (s = s.replace(n, "     $1 ")),
                    function() {
                        var t, e, n, r, o = /{[^]*/gm;
                        if (o.test(s))
                            for (e = 0,
                            n = (t = s.match(o)).length; e < n; e += 1)
                                r = t[e],
                                s = s.replace(r, Array(r.length + 1).join(" "))
                    }(),
                    t(/(\[[^\]]+\])/g, "b"),
                    t(/(#[^\#\s\+>~\.\[:]+)/g, "a"),
                    t(/(\.[^\s\+>~\.\[:]+)/g, "b"),
                    t(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi, "c"),
                    t(/(:[\w-]+\([^\)]*\))/gi, "b"),
                    t(/(:[^\s\+>~\.\[:]+)/g, "b"),
                    s = (s = s.replace(/[\*\s\+>~]/g, " ")).replace(/[#\.]/g, " "),
                    t(/([^\s\+>~\.\[:]+)/g, "c"),
                    l.sort(function(t, e) {
                        return t.index - e.index
                    }),
                    {
                        selector: c,
                        specificity: "0," + f.a.toString() + "," + f.b.toString() + "," + f.c.toString(),
                        specificityArray: [0, f.a, f.b, f.c],
                        parts: l
                    }
                }
                ,
                {
                    calculate: r,
                    compare: function(t, e) {
                        var n, r, o;
                        if ("string" == typeof t) {
                            if (-1 !== t.indexOf(","))
                                throw "Invalid CSS selector";
                            n = a(t).specificityArray
                        } else {
                            if (!Array.isArray(t))
                                throw "Invalid CSS selector or specificity array";
                            if (4 !== t.filter(function(t) {
                                return "number" == typeof t
                            }).length)
                                throw "Invalid specificity array";
                            n = t
                        }
                        if ("string" == typeof e) {
                            if (-1 !== e.indexOf(","))
                                throw "Invalid CSS selector";
                            r = a(e).specificityArray
                        } else {
                            if (!Array.isArray(e))
                                throw "Invalid CSS selector or specificity array";
                            if (4 !== e.filter(function(t) {
                                return "number" == typeof t
                            }).length)
                                throw "Invalid specificity array";
                            r = e
                        }
                        for (o = 0; o < 4; o += 1) {
                            if (n[o] < r[o])
                                return -1;
                            if (n[o] > r[o])
                                return 1
                        }
                        return 0
                    }
                });
                void 0 !== n && (n.calculate = o.calculate,
                n.compare = o.compare)
            }
            , {}],
            2: [function(t, e, n) {
                var r = t("specificity");
                e.exports = {
                    boltExport: r
                }
            }
            , {
                specificity: 1
            }]
        }, {}, [2])(2)
    });
    var Xd = Vd.exports.boltExport
      , Gd = no("selector", "raw")
      , zd = function(e, t) {
        var n = Q(t, function(i) {
            var t = Yo(e, i.selector());
            return $(t, function(t) {
                var n, r, o, e = (n = i.raw(),
                r = t,
                o = {},
                $(n, function(t) {
                    if (void 0 !== n[t]) {
                        var e = r.dom().style;
                        W(e, t) || (o[t] = n[t])
                    }
                }),
                o);
                vu(t, e)
            }),
            t
        });
        $(n, function(t) {
            Qe(t, "class")
        })
    }
      , Kd = function(t, e) {
        var n = function(t) {
            return -1 !== t.selector().indexOf(",")
        }
          , r = Q(V(t, n), function(n) {
            var t = n.selector().split(",");
            return q(t, function(t) {
                var e = t.trim();
                return Gd(e, n.raw())
            })
        })
          , o = V(t, function(t) {
            return !n(t)
        }).concat(r);
        o.sort(function(t, e) {
            return Xd.compare(t.selector(), e.selector())
        }).reverse(),
        zd(e, o)
    }
      , Zd = function(t, e, r) {
        var n = Yd(t)
          , o = qd(n).map(function(t) {
            var e = t.selector()
              , n = r.hasOwnProperty(e) ? r[e] : e;
            return Gd(n, t.raw())
        });
        Kd(o, e)
    }
      , Jd = function(t, e, n) {
        var r = Yd(t)
          , o = qd(r)
          , i = V(o, function(t) {
            return Ie(t.selector(), n)
        });
        Kd(i, e)
    }
      , Qd = {
        inlineStyles: function(t, e, n) {
            Zd(t, e, n)
        },
        inlinePrefixedStyles: function(t, e, n) {
            Jd(t, e, n)
        }
    }
      , tm = {
        p: "p, li[data-converted-paragraph]"
    }
      , em = L
      , nm = function(l, t) {
        var e = Yo(l, "li[data-converted-paragraph]");
        if ($(e, function(t) {
            Qe(t, "data-converted-paragraph")
        }),
        t) {
            var n = Yo(l, "li");
            $(n, function(t) {
                var e, n, r, o, i, a, u, c = (e = l,
                n = ln.fromTag("span"),
                pa(e, n),
                r = n,
                {
                    convertToPx: function(t) {
                        var e;
                        return gu(r, "margin-left", t),
                        e = hu(r, "margin-left"),
                        parseFloat(e.match(/-?\d+\.?\d*/)[0])
                    },
                    destroy: function() {
                        return Za(r)
                    }
                }), s = (i = c,
                a = Je(o = l, "data-tab-interval") ? Ze(o, "data-tab-interval") : "36pt",
                i.convertToPx(a)), f = rm(t, s, c).getOr({});
                Qe(u = t, "data-list-level"),
                Qe(u, "data-text-indent-alt"),
                Qe(u, "data-border-margin"),
                Tu(u, "margin-left"),
                Tu(u, "text-indent"),
                it(xu(u), function(t, e) {
                    !e.startsWith("border") || "border-image" !== e && "none" !== t.trim() && "initial" !== t.trim() || Tu(u, e)
                }),
                c.destroy(),
                vu(t, f)
            });
            var r = Yo(l, "ol,ul");
            $(r, function(e) {
                var t = Yo(e, "li");
                bu(e, "margin-top").isNone() && P.from(t[0]).each(function(t) {
                    gu(e, "margin-top", hu(t, "margin-top"))
                }),
                bu(e, "margin-bottom").isNone() && P.from(t[t.length - 1]).each(function(t) {
                    gu(e, "margin-bottom", hu(t, "margin-bottom"))
                })
            })
        }
        Qe(l, "data-tab-interval")
    }
      , rm = function(l, d, m) {
        var p = function(t) {
            return Je(t, "data-list-level") ? parseInt(Ze(t, "data-list-level"), 10) : 1
        };
        return bu(l, "text-indent").bind(function(f) {
            return bu(l, "margin-left").map(function(t) {
                var e = bu(l, "list-style").exists(function(t) {
                    return Ee(t, "none")
                })
                  , n = Je(l, "data-border-margin") ? Ze(l, "data-border-margin") : "0px"
                  , r = e ? p(l) + 1 : p(l)
                  , o = m.convertToPx(t) + m.convertToPx(n)
                  , i = d * r
                  , a = Je(l, "data-text-indent-alt") ? m.convertToPx(Ze(l, "data-text-indent-alt")) : m.convertToPx(f)
                  , u = {}
                  , c = d / 2 * -1 - a;
                0 < c && (u["text-indent"] = c + "px");
                var s = o - i - c;
                return u["margin-left"] = 0 < s ? s + "px" : "0px",
                u
            })
        })
    }
      , om = function(t, e, n) {
        var r = n.mergeInline();
        (r ? Qd.inlineStyles : em)(t, e, tm),
        nm(e, r)
    }
      , im = function(n) {
        var t, r = (t = ln.fromDom(l.document.body),
        {
            play: function(i, a, u) {
                var c = ln.fromTag("div")
                  , s = ln.fromTag("iframe");
                vu(c, {
                    display: "none"
                });
                var f = Ra(s, "load", function() {
                    f.unbind(),
                    Bd(s, i);
                    var t = s.dom().contentWindow.document;
                    if (void 0 === t)
                        throw "sandbox iframe load event did not fire correctly";
                    var e = ln.fromDom(t)
                      , n = t.body;
                    if (void 0 === n)
                        throw "sandbox iframe does not have a body";
                    var r = ln.fromDom(n)
                      , o = a(e, r);
                    Za(c),
                    l.setTimeout(y(u, o), 0)
                });
                ga(c, s),
                ga(t, c)
            }
        });
        return function(t, e) {
            r.play(t, function(t, e) {
                return om(t, e, {
                    mergeInline: v(n)
                }),
                wu(e)
            }, e)
        }
    }
      , am = function(t, i, e, c) {
        var n = t.html();
        return fc(function(o) {
            e.cleanDocument(n, i).get(function(t) {
                t.fold(function(t) {
                    uc(o, {
                        response: ec.error("errors.paste.process.failure"),
                        bundle: oc({})
                    })
                }, function(t) {
                    var e, n, a, u, r;
                    null == (r = t) || 0 === r.length ? uc(o, {
                        response: ec.paste([], []),
                        bundle: oc({})
                    }) : (e = o,
                    n = t,
                    a = c,
                    u = function(t) {
                        uc(e, {
                            response: t,
                            bundle: oc({})
                        })
                    }
                    ,
                    im(i)(n, function(t) {
                        var e = la(t)
                          , n = function(t) {
                            u(ec.paste(e, t))
                        }
                          , r = ln.fromTag("div");
                        ya(r, e);
                        var o = So("img[src]", r);
                        if (0 === o.length)
                            n([]);
                        else if (a)
                            $(o, function(t) {
                                return Qe(t, "id")
                            }),
                            bd(o).get(n);
                        else {
                            $(o, Za);
                            var i = Mo(r);
                            u(ec.incomplete(i, [], "errors.local.images.disallowed"))
                        }
                    }))
                })
            })
        })
    }
      , um = function(t) {
        var e = V(t, function(t) {
            return "file" === t.kind && /image/.test(t.type)
        })
          , r = q(e, function(t) {
            return t.getAsFile()
        });
        return fc(function(n) {
            sn.multiple(r).get(function(t) {
                var a, u, e = (a = [],
                u = [],
                $(t, function(i) {
                    return vt.cata(i, function(t, e, n, r) {
                        var o = ln.fromTag("img");
                        ze(o, "src", n),
                        a.push(o),
                        u.push(vd(i, o))
                    }, function(t, e, n) {
                        l.console.error("Internal error: Paste operation produced an image URL instead of a Data URI: ", e)
                    })
                }),
                ec.paste(a, u));
                uc(n, {
                    response: e,
                    bundle: oc({})
                })
            })
        })
    }
      , cm = Pe.detect()
      , sm = function(t) {
        try {
            var e = t()
              , n = null != e && 0 < e.length ? la(e) : [];
            return Qo.value(n)
        } catch (t) {
            return l.console.error(t),
            Qo.error("errors.paste.process.failure")
        }
    }
      , fm = function(t) {
        return t.fold(function(t) {
            return sc(t)
        }, function(t) {
            return ac({
                response: ec.paste(t, []),
                bundle: oc({})
            })
        })
    }
      , lm = function(t, e, n, r) {
        return sm(function() {
            return Wl(t, cm, e, n, r)
        })
    }
      , dm = function(t, e, n) {
        var r = lm(t, e, n, !1);
        return fm(r)
    }
      , mm = function(t, e) {
        var n = sm(function() {
            return ql(t, e)
        });
        return fm(n)
    }
      , pm = function(t, e, n, r, i) {
        return lm(t, e, r, n).fold(function(t) {
            return sc(t)
        }, function(o) {
            return fc(function(r) {
                i.get(function(t) {
                    var e, i, a, n = (e = t,
                    i = [],
                    a = Q(o, function(t) {
                        return "img" === Ye(t) ? [t] : Yo(t, "img")
                    }),
                    $(e, function(o) {
                        vt.cata(o, function(t, e, n, r) {
                            $(a, function(t) {
                                Ze(t, "src") === n && i.push(vd(o, t))
                            })
                        }, L)
                    }),
                    i);
                    uc(r, {
                        response: ec.paste(o, n),
                        bundle: oc({})
                    })
                })
            })
        })
    }
      , gm = function(t, e, n) {
        var r = e.findClipboardTags(Mo(n)).getOr([]);
        $(r, Za);
        var o = zt.nu(function(t) {
            return t([])
        });
        return pm(t, n, !1, !0, o)
    }
      , vm = function(t, e, n, r, o) {
        return pm(t, e, r, n, o)
    }
      , hm = function(t) {
        var e, n = ln.fromTag("div");
        return e = t,
        n.dom().textContent = e,
        wu(n)
    }
      , ym = function(t) {
        var e = t.trim().split(/\n{2,}|(?:\r\n){2,}/)
          , n = q(e, function(t) {
            return t.split(/\n|\r\n/).join("<br />")
        });
        return 1 === n.length ? n[0] : q(n, function(t) {
            return "<p>" + t + "</p>"
        }).join("")
    }
      , bm = function(t) {
        var a = Jl.asText(t).getOrDie("Required text input for Text Handler");
        return fc(function(t) {
            var e, n, r, o, i = 0 < a.text().length ? (e = a.text(),
            n = hm(e),
            r = ym(n),
            o = la(r),
            ec.paste(o, [])) : ec.cancel();
            uc(t, {
                response: i,
                bundle: oc({})
            })
        })
    }
      , xm = function(t, e) {
        return bm(t)
    }
      , Tm = function(t, o) {
        var e = function(t, e) {
            var n = ln.fromTag("div");
            ya(n, t),
            Hl(n);
            var r = Mo(n);
            return ac({
                response: ec.paste(r, e),
                bundle: o.bundle()
            })
        }
          , n = y(cc, o);
        return ec.cata(o.response(), n, e, n, e)
    }
      , Em = function() {
        return function(t, e) {
            return sc("errors.local.images.disallowed")
        }
    }
      , wm = function() {
        return function(t, e) {
            var n = Jl.asImages(t).getOrDie("Must have image data for images handler");
            return um(n.images())
        }
    }
      , Im = function(i) {
        return function(t, e) {
            var n = Jl.asHtml(t).getOrDie("Wrong input type for HTML handler")
              , r = i.findClipboardTags(Mo(n.container()));
            r.each(function(t) {
                $(t, Za)
            });
            var o = r.isSome();
            return ac({
                response: e.response(),
                bundle: oc({
                    isInternal: o
                })
            })
        }
    }
      , Sm = function(a, u) {
        return function(t, e) {
            var n = Jl.asHtml(t).getOrDie("Wrong input type for HTML handler").container()
              , r = Co(u)
              , o = e.bundle();
            if (Od.isInternal(o))
                return mm(r, n);
            a(n);
            var i = Od.merging(o);
            return dm(r, n, i)
        }
    }
      , Lm = function(u, c) {
        return function(t, e) {
            var a = e.bundle();
            return Od.proxyBin(a).handle("There was no proxy bin setup. Ensure you have run proxyStep first.", function(t) {
                var e = Od.merging(a)
                  , n = Od.isWord(a)
                  , r = Od.isInternal(a)
                  , o = Od.backgroundAssets(a)
                  , i = Co(u);
                return r ? gm(i, c, t) : vm(i, t, e, n, o)
            })
        }
    }
      , _m = function(o, i) {
        return function(t, e) {
            var n = Jl.asWord(t).getOrDie("Wrong input type for Word Import handler")
              , r = Od.mergeOffice(e.bundle());
            return am(n, r, o, i)
        }
    }
      , Nm = function(r) {
        return function(t, e) {
            var n = rc(e.bundle(), oc(r));
            return ac({
                response: e.response(),
                bundle: n
            })
        }
    }
      , Cm = function(t, e) {
        return ac({
            response: ec.cancel(),
            bundle: oc({})
        })
    }
      , Om = function(t, e) {
        return Nf(t, function(t) {
            return !!Je(t, "style") && -1 < Ze(t, "style").indexOf("mso-")
        })
    }
      , Dm = function(t, e) {
        var n = wu(t);
        return ns(n, e)
    }
      , Am = function(t, e) {
        var n = t.browser;
        return (n.isIE() && 11 <= n.version.major ? Om : Dm)(e, t)
    }
      , Pm = Dd.resolve("smartpaste-eph-bin")
      , km = {
        binStyle: v(Pm)
    }
      , Mm = Pe.detect();
    function Rm(r, f, o, l, i) {
        return function(t, e) {
            var n = Jl.asEvent(t).getOrDie("Must pass through event type").nativeEvent()
              , c = i()
              , s = e.response();
            return fc(function(u) {
                var t = r(o);
                t.events.after.bind(function(t) {
                    var e = t.container();
                    if (Mm.browser.isSafari() && Zi(e, 'img[src^="webkit-fake-url"]').isSome()) {
                        var n = Mm.deviceType.isWebView() ? "webview.imagepaste" : "safari.imagepaste";
                        uc(u, {
                            response: ec.error(n),
                            bundle: oc({})
                        })
                    } else {
                        f(e),
                        Bi(e, km.binStyle());
                        var r = Am(Mm, e)
                          , o = Mo(e)
                          , i = l.findClipboardTags(o).isSome()
                          , a = H(o, function(t) {
                            return Je(t, "id") && Ie(Ze(t, "id"), "docs-internal-guid")
                        });
                        uc(u, {
                            response: s,
                            bundle: oc({
                                isWord: r,
                                isGoogleDocs: a,
                                isInternal: i,
                                proxyBin: e,
                                backgroundAssets: c
                            })
                        })
                    }
                }),
                c.convert(n),
                t.run()
            })
        }
    }
    var Fm = function(t, e) {
        if (0 === t.length)
            throw "Zero length content passed to Hex conversion";
        return Tt([wt(function(t) {
            for (var e = new Array(t.length / 2), n = 0; n < t.length; n += 2) {
                var r = t.substr(n, 2);
                e[Math.floor(n / 2)] = parseInt(r, 16)
            }
            return e
        }(t))], {
            type: e
        })
    }
      , jm = ft([{
        unsupported: ["id", "message", "isEquation", "attrs"]
    }, {
        supported: ["id", "contentType", "blob", "isEquation", "attrs"]
    }])
      , Um = {
        unsupported: jm.unsupported,
        supported: jm.supported,
        cata: function(t, e, n) {
            return t.fold(e, n)
        }
    }
      , Bm = function(t, e, n) {
        return e.indexOf(t, n)
    }
      , Ym = function(t, e, n, r, o, i, a) {
        return -1 === t || -1 === e ? P.none() : P.some({
            start: t,
            end: e,
            bower: n,
            regex: r,
            idRef: o,
            isEquation: i,
            attrs: a
        })
    }
      , Wm = function(t, e, n) {
        return t.substring(e, n)
    }
      , Hm = function(t, e) {
        if (-1 === e)
            return e;
        var n, r, o = 0, i = t.length;
        do {
            if ((n = t.indexOf("{", e)) < (r = t.indexOf("}", e)) && -1 !== n ? (e = n + 1,
            ++o) : (r < n || n < 0) && -1 !== r && (e = r + 1,
            --o),
            i < e || -1 === r)
                return -1
        } while (0 < o);return e
    }
      , qm = function(t, e, n, r, o) {
        var i, a, u, c = Wm(t, n, r), s = (a = Bm("\\picscalex", i = t, n),
        u = Bm("\\bliptag", i, a),
        -1 < a && a < u ? P.from(i.substring(a, u)) : P.none());
        return Ym(n, r, c, /[^a-fA-F0-9]([a-fA-F0-9]+)\}$/, "i", o, s)
    }
      , $m = function(t, e, n, r, o) {
        var i = Wm(t, n, r);
        return Ym(n, r, i, /([a-fA-F0-9]{64,})(?:\}.*)/, "s", o, P.none())
    }
      , Vm = function(t, e) {
        var n = Bm("{\\pict{", t, e)
          , r = Hm(t, n)
          , o = Bm("{\\shp{", t, e)
          , i = Hm(t, o)
          , a = Bm("{\\mmathPict{", t, e)
          , u = Hm(t, a)
          , c = -1 !== a && (a < n && r < u || a < o && i < u)
          , s = y($m, t, e, o, i, c)
          , f = y(qm, t, e, n, r, c);
        return -1 === n && -1 === o ? P.none() : -1 === n ? s() : -1 === o ? f() : o < n && r < i ? f() : n < o && i < r ? s() : n < o ? f() : o < n ? s() : P.none()
    }
      , Xm = function(t, e) {
        return Vm(t, e)
    }
      , Gm = function(t) {
        return 0 <= t.indexOf("\\pngblip") ? Qo.value("image/png") : 0 <= t.indexOf("\\jpegblip") ? Qo.value("image/jpeg") : Qo.error("errors.imageimport.unsupported")
    }
      , zm = function(t, e) {
        var n = t.match(e);
        return n && n[1] && n[1].length % 2 == 0 ? Qo.value(n[1]) : Qo.error("errors.imageimport.invalid")
    }
      , Km = function(t) {
        var e = t.match(/\\shplid(\d+)/);
        return null !== e ? P.some(e[1]) : P.none()
    }
      , Zm = function(t) {
        for (var u = [], e = function() {
            return t.length
        }, n = function(t) {
            var e, r, o, i, a, n = (r = (e = t).bower,
            o = e.regex,
            i = e.isEquation,
            a = e.attrs,
            Km(r).map(function(t) {
                var n = e.idRef + t;
                return Gm(r).fold(function(t) {
                    return Um.unsupported(n, t, i, a)
                }, function(e) {
                    return zm(r, o).fold(function(t) {
                        return Um.unsupported(n, t, i, a)
                    }, function(t) {
                        return Um.supported(n, e, Fm(t, e), i, a)
                    })
                })
            }));
            return u = u.concat(n.toArray()),
            t.end
        }, r = 0; r < t.length; )
            r = Xm(t, r).fold(e, n);
        return u
    }
      , Jm = function(t) {
        var e = t.replace(/\r/g, "").replace(/\n/g, "");
        return Zm(e)
    }
      , Qm = {
        images: function(t) {
            return Jm(t)
        },
        toId: function(t) {
            return Um.cata(t, function(t, e, n) {
                return t
            }, function(t, e, n, r, o) {
                return t
            })
        },
        isEquation: function(t) {
            return Um.cata(t, function(t, e, n) {
                return n
            }, function(t, e, n, r, o) {
                return r
            })
        },
        toBlob: function(t) {
            return Um.cata(t, function(t, e, n) {
                return Qo.error(e)
            }, function(t, e, n, r, o) {
                return Qo.value(n)
            })
        },
        getAttrs: function(t) {
            return Um.cata(t, function(t, e, n) {
                return Qo.error(e)
            }, function(t, e, n, r, o) {
                return o
            })
        }
    };
    function tp(a, u, c, s, f) {
        return a.toCanvas().then(function(t) {
            return e = t,
            n = a.getType(),
            r = u,
            o = c,
            _t(i = St(s, f)).drawImage(e, -r, -o),
            jt(i, n);
            var e, n, r, o, i
        })
    }
    var ep, np, rp, op = {}, ip = {
        exports: op
    };
    np = op,
    rp = ip,
    ep = void 0,
    function(t) {
        "object" == typeof np && void 0 !== rp ? rp.exports = t() : "function" == typeof ep && ep.amd ? ep([], t) : ("undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this).EphoxContactWrapper = t()
    }(function() {
        return function i(a, u, c) {
            function s(e, t) {
                if (!u[e]) {
                    if (!a[e]) {
                        var n = !1;
                        if (!t && n)
                            return n(e, !0);
                        if (f)
                            return f(e, !0);
                        var r = new Error("Cannot find module '" + e + "'");
                        throw r.code = "MODULE_NOT_FOUND",
                        r
                    }
                    var o = u[e] = {
                        exports: {}
                    };
                    a[e][0].call(o.exports, function(t) {
                        return s(a[e][1][t] || t)
                    }, o, o.exports, i, a, u, c)
                }
                return u[e].exports
            }
            for (var f = !1, t = 0; t < c.length; t++)
                s(c[t]);
            return s
        }({
            1: [function(t, e, n) {
                var r, o, i = e.exports = {};
                function a() {
                    throw new Error("setTimeout has not been defined")
                }
                function u() {
                    throw new Error("clearTimeout has not been defined")
                }
                function c(e) {
                    if (r === setTimeout)
                        return setTimeout(e, 0);
                    if ((r === a || !r) && setTimeout)
                        return r = setTimeout,
                        setTimeout(e, 0);
                    try {
                        return r(e, 0)
                    } catch (t) {
                        try {
                            return r.call(null, e, 0)
                        } catch (t) {
                            return r.call(this, e, 0)
                        }
                    }
                }
                !function() {
                    try {
                        r = "function" == typeof setTimeout ? setTimeout : a
                    } catch (t) {
                        r = a
                    }
                    try {
                        o = "function" == typeof clearTimeout ? clearTimeout : u
                    } catch (t) {
                        o = u
                    }
                }();
                var s, f = [], l = !1, d = -1;
                function m() {
                    l && s && (l = !1,
                    s.length ? f = s.concat(f) : d = -1,
                    f.length && p())
                }
                function p() {
                    if (!l) {
                        var t = c(m);
                        l = !0;
                        for (var e = f.length; e; ) {
                            for (s = f,
                            f = []; ++d < e; )
                                s && s[d].run();
                            d = -1,
                            e = f.length
                        }
                        s = null,
                        l = !1,
                        function(e) {
                            if (o === clearTimeout)
                                return clearTimeout(e);
                            if ((o === u || !o) && clearTimeout)
                                return o = clearTimeout,
                                clearTimeout(e);
                            try {
                                o(e)
                            } catch (t) {
                                try {
                                    return o.call(null, e)
                                } catch (t) {
                                    return o.call(this, e)
                                }
                            }
                        }(t)
                    }
                }
                function g(t, e) {
                    this.fun = t,
                    this.array = e
                }
                function v() {}
                i.nextTick = function(t) {
                    var e = new Array(arguments.length - 1);
                    if (1 < arguments.length)
                        for (var n = 1; n < arguments.length; n++)
                            e[n - 1] = arguments[n];
                    f.push(new g(t,e)),
                    1 !== f.length || l || c(p)
                }
                ,
                g.prototype.run = function() {
                    this.fun.apply(null, this.array)
                }
                ,
                i.title = "browser",
                i.browser = !0,
                i.env = {},
                i.argv = [],
                i.version = "",
                i.versions = {},
                i.on = v,
                i.addListener = v,
                i.once = v,
                i.off = v,
                i.removeListener = v,
                i.removeAllListeners = v,
                i.emit = v,
                i.prependListener = v,
                i.prependOnceListener = v,
                i.listeners = function(t) {
                    return []
                }
                ,
                i.binding = function(t) {
                    throw new Error("process.binding is not supported")
                }
                ,
                i.cwd = function() {
                    return "/"
                }
                ,
                i.chdir = function(t) {
                    throw new Error("process.chdir is not supported")
                }
                ,
                i.umask = function() {
                    return 0
                }
            }
            , {}],
            2: [function(t, l, e) {
                (function(n) {
                    !function(t) {
                        var e = setTimeout;
                        function r() {}
                        function i(t) {
                            if ("object" != typeof this)
                                throw new TypeError("Promises must be constructed via new");
                            if ("function" != typeof t)
                                throw new TypeError("not a function");
                            this._state = 0,
                            this._handled = !1,
                            this._value = void 0,
                            this._deferreds = [],
                            f(t, this)
                        }
                        function o(n, r) {
                            for (; 3 === n._state; )
                                n = n._value;
                            0 !== n._state ? (n._handled = !0,
                            i._immediateFn(function() {
                                var t = 1 === n._state ? r.onFulfilled : r.onRejected;
                                if (null !== t) {
                                    var e;
                                    try {
                                        e = t(n._value)
                                    } catch (t) {
                                        return void u(r.promise, t)
                                    }
                                    a(r.promise, e)
                                } else
                                    (1 === n._state ? a : u)(r.promise, n._value)
                            })) : n._deferreds.push(r)
                        }
                        function a(e, t) {
                            try {
                                if (t === e)
                                    throw new TypeError("A promise cannot be resolved with itself.");
                                if (t && ("object" == typeof t || "function" == typeof t)) {
                                    var n = t.then;
                                    if (t instanceof i)
                                        return e._state = 3,
                                        e._value = t,
                                        void c(e);
                                    if ("function" == typeof n)
                                        return void f((r = n,
                                        o = t,
                                        function() {
                                            r.apply(o, arguments)
                                        }
                                        ), e)
                                }
                                e._state = 1,
                                e._value = t,
                                c(e)
                            } catch (t) {
                                u(e, t)
                            }
                            var r, o
                        }
                        function u(t, e) {
                            t._state = 2,
                            t._value = e,
                            c(t)
                        }
                        function c(t) {
                            2 === t._state && 0 === t._deferreds.length && i._immediateFn(function() {
                                t._handled || i._unhandledRejectionFn(t._value)
                            });
                            for (var e = 0, n = t._deferreds.length; e < n; e++)
                                o(t, t._deferreds[e]);
                            t._deferreds = null
                        }
                        function s(t, e, n) {
                            this.onFulfilled = "function" == typeof t ? t : null,
                            this.onRejected = "function" == typeof e ? e : null,
                            this.promise = n
                        }
                        function f(t, e) {
                            var n = !1;
                            try {
                                t(function(t) {
                                    n || (n = !0,
                                    a(e, t))
                                }, function(t) {
                                    n || (n = !0,
                                    u(e, t))
                                })
                            } catch (t) {
                                if (n)
                                    return;
                                n = !0,
                                u(e, t)
                            }
                        }
                        i.prototype.catch = function(t) {
                            return this.then(null, t)
                        }
                        ,
                        i.prototype.then = function(t, e) {
                            var n = new this.constructor(r);
                            return o(this, new s(t,e,n)),
                            n
                        }
                        ,
                        i.all = function(t) {
                            var u = Array.prototype.slice.call(t);
                            return new i(function(r, o) {
                                if (0 === u.length)
                                    return r([]);
                                var i = u.length;
                                function a(e, t) {
                                    try {
                                        if (t && ("object" == typeof t || "function" == typeof t)) {
                                            var n = t.then;
                                            if ("function" == typeof n)
                                                return void n.call(t, function(t) {
                                                    a(e, t)
                                                }, o)
                                        }
                                        u[e] = t,
                                        0 == --i && r(u)
                                    } catch (t) {
                                        o(t)
                                    }
                                }
                                for (var t = 0; t < u.length; t++)
                                    a(t, u[t])
                            }
                            )
                        }
                        ,
                        i.resolve = function(e) {
                            return e && "object" == typeof e && e.constructor === i ? e : new i(function(t) {
                                t(e)
                            }
                            )
                        }
                        ,
                        i.reject = function(n) {
                            return new i(function(t, e) {
                                e(n)
                            }
                            )
                        }
                        ,
                        i.race = function(o) {
                            return new i(function(t, e) {
                                for (var n = 0, r = o.length; n < r; n++)
                                    o[n].then(t, e)
                            }
                            )
                        }
                        ,
                        i._immediateFn = "function" == typeof n ? function(t) {
                            n(t)
                        }
                        : function(t) {
                            e(t, 0)
                        }
                        ,
                        i._unhandledRejectionFn = function(t) {
                            "undefined" != typeof console && console && console.warn("Possible Unhandled Promise Rejection:", t)
                        }
                        ,
                        i._setImmediateFn = function(t) {
                            i._immediateFn = t
                        }
                        ,
                        i._setUnhandledRejectionFn = function(t) {
                            i._unhandledRejectionFn = t
                        }
                        ,
                        void 0 !== l && l.exports ? l.exports = i : t.Promise || (t.Promise = i)
                    }(this)
                }
                ).call(this, t("timers").setImmediate)
            }
            , {
                timers: 3
            }],
            3: [function(c, t, s) {
                (function(t, e) {
                    var r = c("process/browser.js").nextTick
                      , n = Function.prototype.apply
                      , o = Array.prototype.slice
                      , i = {}
                      , a = 0;
                    function u(t, e) {
                        this._id = t,
                        this._clearFn = e
                    }
                    s.setTimeout = function() {
                        return new u(n.call(setTimeout, window, arguments),clearTimeout)
                    }
                    ,
                    s.setInterval = function() {
                        return new u(n.call(setInterval, window, arguments),clearInterval)
                    }
                    ,
                    s.clearTimeout = s.clearInterval = function(t) {
                        t.close()
                    }
                    ,
                    u.prototype.unref = u.prototype.ref = function() {}
                    ,
                    u.prototype.close = function() {
                        this._clearFn.call(window, this._id)
                    }
                    ,
                    s.enroll = function(t, e) {
                        clearTimeout(t._idleTimeoutId),
                        t._idleTimeout = e
                    }
                    ,
                    s.unenroll = function(t) {
                        clearTimeout(t._idleTimeoutId),
                        t._idleTimeout = -1
                    }
                    ,
                    s._unrefActive = s.active = function(t) {
                        clearTimeout(t._idleTimeoutId);
                        var e = t._idleTimeout;
                        0 <= e && (t._idleTimeoutId = setTimeout(function() {
                            t._onTimeout && t._onTimeout()
                        }, e))
                    }
                    ,
                    s.setImmediate = "function" == typeof t ? t : function(t) {
                        var e = a++
                          , n = !(arguments.length < 2) && o.call(arguments, 1);
                        return i[e] = !0,
                        r(function() {
                            i[e] && (n ? t.apply(null, n) : t.call(null),
                            s.clearImmediate(e))
                        }),
                        e
                    }
                    ,
                    s.clearImmediate = "function" == typeof e ? e : function(t) {
                        delete i[t]
                    }
                }
                ).call(this, c("timers").setImmediate, c("timers").clearImmediate)
            }
            , {
                "process/browser.js": 1,
                timers: 3
            }],
            4: [function(t, e, n) {
                var r = t("promise-polyfill")
                  , o = "undefined" != typeof window ? window : Function("return this;")();
                e.exports = {
                    boltExport: o.Promise || r
                }
            }
            , {
                "promise-polyfill": 2
            }]
        }, {}, [4])(4)
    });
    var ap = ip.exports.boltExport
      , up = function(t, e) {
        var n = new RegExp("\\\\pic" + e + "(\\d+)\\\\")
          , r = t.match(n)[1];
        return parseInt(r, 10)
    }
      , cp = function(t, e, n) {
        var r = y(up, t)
          , o = r("wgoal")
          , i = r("hgoal")
          , a = o / e
          , u = i / n
          , c = r("cropl")
          , s = r("cropt");
        return {
            cropl: c / a,
            cropt: s / u,
            cropw: (o - c - r("cropr")) / a,
            croph: (i - s - r("cropb")) / u
        }
    }
      , sp = function(t, e) {
        return e.fold(function() {
            return t
        }, function(l) {
            return vt.cata(t, function(s, f, t) {
                return f.toCanvas().then(function(t) {
                    var e, n, r, o, i, a = parseInt(Ze(ln.fromDom(t), "width"), 10) || 1, u = parseInt(Ze(ln.fromDom(t), "height"), 10) || 1, c = cp(l, a, u);
                    return (e = f,
                    n = c.cropl,
                    r = c.cropt,
                    o = c.cropw,
                    i = c.croph,
                    tp(e, n, r, o, i)).then(function(t) {
                        return vt.blob(s, t, t.toDataURL())
                    })
                })
            })
        })
    }
      , fp = function(t, n) {
        return t.length === n.length ? ap.all(q(t, function(t, e) {
            return sp(t, n[e])
        })) : ap.resolve(t)
    }
      , lp = {
        convert: function(t, e, n, o) {
            var i = X(e, function(e, n) {
                var r = Qm.toId(n)
                  , o = Qm.isEquation(n);
                return z(e, function(t) {
                    return Qm.toId(t) === r && Qm.isEquation(t) === o
                }).fold(function() {
                    return e.concat([n])
                }, function(t) {
                    return Qm.toBlob(e[t]).isValue() ? e : e.slice(0, t).concat(e.slice(t + 1)).concat([n])
                })
            }, [])
              , a = []
              , u = []
              , c = !1
              , r = Q(t, function(n) {
                var e = Ze(n, "data-image-id")
                  , r = "true" === Ze(n, "data-ms-equation");
                return Qe(n, "rtf-data-image"),
                Qe(n, "data-image-id"),
                Qe(n, "data-ms-equation"),
                "unsupported" === e ? (c = !0,
                ze(n, "alt", o("errors.imageimport.unsupported")),
                []) : G(i, function(t) {
                    return Qm.toId(t) === e && Qm.isEquation(t) === r
                }).fold(function() {
                    return l.console.log("WARNING: unable to find data for image ", n.dom()),
                    c = !0,
                    ze(n, "alt", o("errors.imageimport.unsupported")),
                    []
                }, function(e) {
                    return Qm.toBlob(e).fold(function(t) {
                        return c = !0,
                        ze(n, "alt", o(t)),
                        []
                    }, function(t) {
                        return a.push(n),
                        u.push(Qm.getAttrs(e)),
                        [t]
                    })
                })
            });
            sn.multiple(r).get(function(t) {
                fp(t, u).then(function(t) {
                    var e = yd(t, a);
                    n(e, c)
                })
            })
        }
    }
      , dp = function(t) {
        return Yo(t, "[rtf-data-image]")
    }
      , mp = {
        exists: function(t) {
            return 0 < dp(t).length
        },
        find: dp
    };
    function pp(o) {
        var r, a, i = (r = o.translations,
        {
            events: (a = so.create({
                insert: co(["elements", "correlated"]),
                incomplete: co(["elements", "correlated", "message"])
            })).registry,
            processRtf: function(o, i, t) {
                var e = Qm.images(t)
                  , n = mp.find(o);
                lp.convert(n, e, function(t, e) {
                    var n = Mo(o)
                      , r = t.concat(i);
                    e ? a.trigger.incomplete(n, r, "errors.imageimport.failed") : a.trigger.insert(n, r)
                }, r)
            }
        }), u = nf(P.none()), c = function(e) {
            u.get().each(function(t) {
                uc(t, {
                    response: e,
                    bundle: oc({})
                })
            })
        };
        return i.events.insert.bind(function(t) {
            c(ec.paste(t.elements(), t.correlated()))
        }),
        i.events.incomplete.bind(function(t) {
            c(ec.incomplete(t.elements(), t.correlated(), t.message()))
        }),
        function(t, r) {
            var e = Jl.asWord(t).getOrDie("Word input required for rtf data")
              , n = function(o) {
                return fc(function(e) {
                    var t = function() {
                        uc(e, {
                            response: r.response(),
                            bundle: r.bundle()
                        })
                    }
                      , n = function(t, n) {
                        u.set(P.some(e));
                        var r = ln.fromTag("div");
                        ya(r, t),
                        o.fold(function() {
                            var t, e = mp.find(r);
                            return 0 < e.length ? function() {
                                $(e, Za);
                                var t = Mo(r);
                                c(ec.incomplete(t, n, "errors.local.images.disallowed"))
                            }() : (t = Mo(r),
                            void c(ec.paste(t, n)))
                        }, function(t) {
                            i.processRtf(r, n, t)
                        })
                    };
                    ec.cata(r.response(), t, n, t, n)
                })
            };
            return zl.match(e.rtf(), {
                disabled: function() {
                    return n(P.none())
                },
                fromClipboard: function(t) {
                    return n(!0 === o.allowLocalImages ? P.some(t.rtf()) : P.none())
                }
            })
        }
    }
    var gp = function(o) {
        var i = function() {
            return zt.pure(o)
        };
        return vt.cata(o.asset(), function(t, e, n) {
            return /tiff$/.test(e.getType()) ? (r = e,
            zt.nu(function(e) {
                var t = Ht(r, "image/png").then(function(t) {
                    sn.single(t).map(P.some).get(e)
                });
                return t.catch.call(t, function(t) {
                    return l.console.warn(t),
                    e(P.none()),
                    t
                })
            })).map(function(t) {
                return t.map(function(t) {
                    var e = o.image();
                    return Re(n),
                    hd(t, e),
                    vd(t, e)
                }).getOr(o)
            }) : i();
            var r
        }, i)
    };
    function vp() {
        return function(t, o) {
            return fc(function(n) {
                var t = function() {
                    uc(n, {
                        response: o.response(),
                        bundle: o.bundle()
                    })
                }
                  , r = function(t, e) {
                    Jt(t, gp).get(function(t) {
                        uc(n, {
                            response: e(t),
                            bundle: o.bundle()
                        })
                    })
                };
                ec.cata(o.response(), t, function(e, t) {
                    r(t, function(t) {
                        return ec.paste(e, t)
                    })
                }, t, function(e, t, n) {
                    r(t, function(t) {
                        return ec.incomplete(e, t, n)
                    })
                })
            })
        }
    }
    var hp = function(t) {
        return v(t)
    }
      , yp = function(t, e) {
        return t.isSupported() ? e.getWordData() : P.none()
    }
      , bp = function(t) {
        return t.getNative()
    }
      , xp = function(t) {
        return t.getImage()
    }
      , Tp = function(t) {
        return t.getHtml()
    }
      , Ep = function(t) {
        return t.getText()
    }
      , wp = function(t) {
        return t.getOnlyText()
    }
      , Ip = function(t) {
        return t.getGoogleDocsData()
    }
      , Sp = function(t) {
        return t.getVoid()
    }
      , Lp = function(t, e, n, r) {
        return {
            _label: t,
            label: v(t),
            getAvailable: e,
            steps: v(n),
            capture: v(r)
        }
    }
      , _p = function(t, e, n, r) {
        return {
            _label: t,
            label: v(t),
            getAvailable: e,
            steps: v(n),
            capture: v(r)
        }
    }
      , Np = function(t, e, n, r) {
        return Lp("Outside of Textbox.io pasting HTML5 API (could be internal)", Tp, [hp(Im(e.intraFlag)), hp(jd(t, e)), hp(Sm(n, r)), hp(Ld(e)), hp(vp())], !0)
    }
      , Cp = function(t, e, n, r, o) {
        return _p("Outside of Textbox.io pasting offscreen (could be internal)", bp, [hp(Rm(r, n, o, e.intraFlag, gd)), hp(jd(t, e)), hp(Lm(o, e.intraFlag)), hp(Ld(e)), hp(vp())], !1)
    }
      , Op = function(t, e, n) {
        return Lp("Word Import pasting", y(yp, t), [hp(Nm({
            isWord: !0
        })), hp(Fd(e, n)), hp(_m(t, n.allowLocalImages)), (r = pp(n),
        function(n) {
            return function(t, e) {
                return n.block(),
                r(t, e).map(function(t) {
                    return n.unblock(),
                    t
                })
            }
        }
        ), hp(vp())], !0);
        var r
    }
      , Dp = function(t, e, n) {
        return Lp(" pasting", Ip, [hp(Nm({
            officeStyles: !1,
            htmlStyles: !1
        })), hp(Sm(e, n)), hp(Ld(t)), hp(vp())], !0)
    }
      , Ap = function(t) {
        return Lp("Image pasting", xp, [hp(!1 === t.allowLocalImages ? Em() : wm()), hp(vp())], !0)
    }
      , Pp = function() {
        return Lp("Only plain text is available to paste", wp, [hp(xm), hp(Tm)], !0)
    }
      , kp = function() {
        return Lp("Plain text pasting", Ep, [hp(xm), hp(Tm)], !0)
    }
      , Mp = function() {
        return _p("There is no valid way to paste", Sp, [hp(Cm)], !1)
    }
      , Rp = "powerpaste-styles"
      , Fp = "#" + Rp
      , jp = {
        injectStyles: function(t) {
            if (!Ml(Fp)) {
                var e = "<style>.ephox-cement-flashbin-helpcopy-kbd {font-size: 3em !important; text-align: center !important; vertical-align: middle !important; margin: .5em 0} .ephox-cement-flashbin-helpcopy-kbd .ephox-polish-help-kbd {font-size: 3em !important; vertical-align: middle !important;} .ephox-cement-flashbin-helpcopy a {text-decoration: underline} .ephox-cement-flashbin-loading-spinner {background-image: url(" + t + ") !important; width: 96px !important; height:96px !important; display: block; margin-left: auto !important; margin-right: auto !important; margin-top: 2em !important; margin-bottom: 2em !important;} .ephox-cement-flashbin-loading p {text-align: center !important; margin: 2em 0 !important} .ephox-cement-flashbin-target {height: 1px !important;} .ephox-cement-flashbin-target.ephox-cement-flash-activate {height: 150px !important; width: 100% !important;} .ephox-cement-flashbin-target object {height: 1px !important;} .ephox-cement-flashbin-target.ephox-cement-flash-activate object {height: 150px !important; width: 100% !important;} .ephox-cement-flashbin-helpcopy p {white-space: normal;}</style>"
                  , n = ln.fromHtml(e);
                ze(n, "type", "text/css"),
                ze(n, "id", Rp);
                var r = zi("head").getOrDie("Head element could not be found.");
                ga(r, n)
            }
        },
        removeStyles: function() {
            if (Ml(Fp)) {
                var t = zi("head").getOrDie("Head element could not be found.")
                  , e = Zi(t, Fp).getOrDie("The style element could not be removed");
                Za(e)
            }
        }
    }
      , Up = "x-tinymce/html"
      , Bp = "\x3c!-- " + Up + " --\x3e"
      , Yp = {
        mark: function(t) {
            return Bp + t
        },
        unmark: function(t) {
            return t.replace(Bp, "")
        },
        isMarked: function(t) {
            return -1 !== t.indexOf(Bp)
        },
        retainContentEditable: function(t) {
            return t.replace(/ contenteditable="([^"]+)"/g, ' data-mce-contenteditable="$1"')
        },
        restoreContentEditable: function(t) {
            return t.replace(/ data-mce-contenteditable="([^"]+)"/g, ' contenteditable="$1"')
        },
        internalHtmlMime: v(Up)
    }
      , Wp = function() {}
      , Hp = function(t, e, n) {
        if (r = t,
        !1 !== tinymce.Env.iOS || void 0 === r || "function" != typeof r.setData)
            return !1;
        try {
            return t.clearData(),
            t.setData("text/html", e),
            t.setData("text/plain", n),
            t.setData(Yp.internalHtmlMime(), e),
            !0
        } catch (t) {
            return !1
        }
        var r
    }
      , qp = function(t, e, n, r) {
        Hp(t.clipboardData, e.html, e.text) ? (t.preventDefault(),
        r()) : n(e.html, r)
    }
      , $p = function(a) {
        return function(t, e) {
            var n = a.dom.create("div", {
                contenteditable: "false",
                "data-mce-bogus": "all"
            })
              , r = a.dom.create("div", {
                contenteditable: "true",
                "data-mce-bogus": "all"
            }, t);
            a.dom.setStyles(n, {
                position: "fixed",
                top: "50%",
                left: "-3000px",
                width: "1000px",
                overflow: "hidden"
            }),
            n.appendChild(r),
            a.dom.add(a.getBody(), n);
            var o = a.selection.getRng();
            r.focus();
            var i = a.dom.createRng();
            i.selectNodeContents(r),
            a.selection.setRng(i),
            setTimeout(function() {
                a.selection.setRng(o),
                n.parentNode.removeChild(n),
                e()
            }, 0)
        }
    }
      , Vp = function(t) {
        var e = Yp.retainContentEditable(t.selection.getContent({
            contextual: !0
        }));
        return {
            html: Yp.mark(e),
            text: t.selection.getContent({
                format: "text"
            })
        }
    }
      , Xp = {
        register: function(t) {
            var e, n;
            t.on("cut", (e = t,
            function(t) {
                !1 === e.selection.isCollapsed() && qp(t, Vp(e), $p(e), function() {
                    setTimeout(function() {
                        e.execCommand("Delete")
                    }, 0)
                })
            }
            )),
            t.on("copy", (n = t,
            function(t) {
                !1 === n.selection.isCollapsed() && qp(t, Vp(n), $p(n), Wp)
            }
            ))
        }
    }
      , Gp = {
        nodeToString: function(t) {
            var e = document.createElement("div");
            e.appendChild(t.cloneNode(!0));
            var n = e.innerHTML;
            return e = t = null,
            n
        },
        restoreStyleAttrs: function(t) {
            $(q(t.getElementsByTagName("*"), ln.fromDom), function(t) {
                Je(t, "data-mce-style") && !Je(t, "style") && ze(t, "style", Ze(t, "data-mce-style"))
            })
        }
    }
      , zp = {
        showDialog: function(t, e) {
            var n = {
                title: "Error",
                body: {
                    type: "panel",
                    items: [{
                        type: "htmlpanel",
                        name: "errorpanel",
                        html: e
                    }]
                },
                initialData: {},
                buttons: [{
                    text: "OK",
                    type: "cancel",
                    name: "ok",
                    primary: !0
                }]
            };
            t.windowManager.open(n)
        }
    }
      , Kp = {
        init: function() {
            var r = nf([{
                text: "Close",
                name: "close",
                type: "custom",
                primary: !0
            }])
              , o = nf({});
            return {
                setButtons: function(t) {
                    var n = {}
                      , e = q(t, function(t) {
                        var e = t.text;
                        return n[e.toLowerCase()] = t.click,
                        {
                            text: e,
                            name: e.toLowerCase(),
                            type: "custom"
                        }
                    });
                    o.set(n),
                    r.set(e)
                },
                getButtons: r.get,
                getAction: function(t) {
                    var e = o.get();
                    return e.hasOwnProperty(t) ? P.some(e[t]) : P.none()
                }
            }
        }
    }
      , Zp = no("url", "html")
      , Jp = function(t) {
        return /^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(t)
    }
      , Qp = Jp
      , tg = function(t) {
        return Jp(t) && /.(gif|jpe?g|png)$/.test(t)
    }
      , eg = function(n) {
        var t = /^<a href="([^"]+)">([^<]+)<\/a>$/.exec(n);
        return P.from(t).bind(function(t) {
            var e = Zp(t[1], n);
            return t[1] === t[2] ? P.some(e) : P.none()
        })
    }
      , ng = function(t, e, n) {
        return "extra"in t.undoManager ? (t.undoManager.extra(function() {
            rg(t, e)
        }, n),
        P.some(!0)) : P.none()
    }
      , rg = function(t, e) {
        return t.insertContent(e, {
            merge: !1 !== t.settings.paste_merge_formats,
            paste: !0
        }),
        P.some(!0)
    }
      , og = {
        until: function(e, n, t) {
            return Bu(t, function(t) {
                return t(e, n)
            })
        },
        linkSelection: function(r, t) {
            return eg(t).bind(function(t) {
                var e, n;
                return !1 === r.selection.isCollapsed() && Qp(t.url()) ? ng(e = r, (n = t).html(), function() {
                    e.execCommand("mceInsertLink", !1, n.url())
                }) : P.none()
            })
        },
        insertImage: function(r, t) {
            return eg(t).bind(function(t) {
                return tg(t.url()) ? ng(e = r, (n = t).html(), function() {
                    e.insertContent('<img src="' + n.url() + '">')
                }) : P.none();
                var e, n
            })
        },
        insertContent: rg
    }
      , ig = function(t, e) {
        return t.hasEventListeners(e)
    }
      , ag = function(t) {
        return t.plugins.powerpaste
    }
      , ug = {
        process: function(t, e, n) {
            var r, o, i, a, u, c, s, f, l, d, m, p, g, v = Yp.unmark(e);
            return d = v,
            m = n,
            o = ig(l = r = t, "PastePreProcess") ? (p = d,
            g = m,
            l.fire("PastePreProcess", {
                internal: g,
                content: p
            }).content) : d,
            i = n,
            ig(r, "PastePostProcess") ? (u = o,
            c = i,
            s = (a = r).dom.add(a.getBody(), "div", {
                style: "display:none"
            }, u),
            f = a.fire("PastePostProcess", {
                internal: c,
                node: s
            }).node.innerHTML,
            a.dom.remove(s),
            f) : o
        },
        registerEvents: function(e) {
            var n = e.settings;
            n.paste_preprocess && e.on("PastePreProcess", function(t) {
                n.paste_preprocess.call(e, ag(e), t)
            }),
            n.paste_postprocess && e.on("PastePostProcess", function(t) {
                n.paste_postprocess.call(e, ag(e), t)
            })
        }
    };
    function cg(g, v, t, e, h, y) {
        var b, x, T, E, w = nf(P.none()), n = function(t, e) {
            return t.replace(/\/$/, "") + "/" + e.replace(/^\//, "")
        };
        E = n(e ? e.jsUrl : t, "/js"),
        x = n(e ? e.swfUrl : t, "/flash/textboxpaste.swf"),
        T = n(e ? e.imgUrl : t, "/img/spinner_96.gif");
        var I = function(t, e, n) {
            var r, o = !1 !== t.settings.smart_paste ? [og.linkSelection, og.insertImage] : [];
            og.until(t, e, o.concat([(r = n,
            function(t, e) {
                return t.undoManager.transact(function() {
                    og.insertContent(t, e),
                    Gp.restoreStyleAttrs(t.getBody()),
                    h.prepareImages(r)
                }),
                P.some(!0)
            }
            )]))
        }
          , S = function() {
            b && g.selection.moveToBookmark(b),
            b = null
        };
        g.on("init", function(t) {
            jp.injectStyles(T);
            var s, a, e, n, r, o, i, u, c = {
                baseUrl: E,
                swf: x,
                officeStyles: g.settings.powerpaste_word_import || Zr.officeStyles,
                htmlStyles: g.settings.powerpaste_html_import || Zr.htmlStyles,
                translations: mn.translate,
                allowLocalImages: !1 !== g.settings.powerpaste_allow_local_images,
                enableFlashImport: !1 !== g.settings.powerpaste_enable_flash_import,
                pasteBinAttrs: {
                    "data-mce-bogus": "all"
                },
                intraFlag: {
                    clipboardType: Yp.internalHtmlMime,
                    findClipboardTags: function(t) {
                        var e = V(t, function(t) {
                            return $e(t) && Ee(Mf(t), Yp.internalHtmlMime())
                        });
                        return e.length ? P.some(e) : P.none()
                    }
                },
                preprocessor: function(t) {
                    return zt.pure(t)
                }
            }, f = y ? (a = g,
            {
                createDialog: function() {
                    var n = ""
                      , r = null
                      , o = Kp.init()
                      , e = so.create({
                        close: co([])
                    })
                      , i = function(t) {
                        e.trigger.close()
                    };
                    return {
                        events: e.registry,
                        setTitle: function(t) {
                            return n = t
                        },
                        setContent: function(t) {
                            return r = t
                        },
                        setButtons: function(t) {
                            o.setButtons(t)
                        },
                        show: function() {
                            var t = Gp.nodeToString(r.dom())
                              , e = {
                                title: n,
                                body: {
                                    type: "panel",
                                    items: [{
                                        type: "htmlpanel",
                                        name: "contentPanel",
                                        html: t
                                    }]
                                },
                                initialData: {},
                                buttons: o.getButtons(),
                                onCancel: i,
                                onAction: function(e, t) {
                                    o.getAction(t.name).each(function(t) {
                                        return t(e)
                                    }),
                                    e.close()
                                }
                            };
                            a.windowManager.open(e)
                        },
                        destroy: L,
                        reflow: function() {}
                    }
                }
            }) : (s = g,
            {
                createDialog: function() {
                    var r, o = "", i = "", a = [], u = null, e = so.create({
                        close: co([])
                    }), c = function(t) {
                        e.trigger.close()
                    }, t = function() {
                        r.off("close", c),
                        r.close("close")
                    };
                    return {
                        events: e.registry,
                        setTitle: function(t) {
                            o = t
                        },
                        setContent: function(t) {
                            var e = Gp.nodeToString(t.dom());
                            i = [{
                                type: "container",
                                html: e
                            }],
                            u = t
                        },
                        setButtons: function(t) {
                            var r = [];
                            t.forEach(function(t, e, n) {
                                r.push({
                                    text: t.text,
                                    ariaLabel: t.text,
                                    onclick: t.click
                                })
                            }),
                            a = r
                        },
                        show: function() {
                            0 === a.length && (a = [{
                                text: "Close",
                                onclick: function() {
                                    r.close()
                                }
                            }]);
                            var t = {
                                title: o,
                                spacing: 10,
                                padding: 10,
                                minWidth: 300,
                                minHeight: 100,
                                layout: "flex",
                                items: i,
                                buttons: a
                            };
                            r = s.windowManager.open(t);
                            var e = ln.fromDom(r.getEl())
                              , n = Zi(e, "." + Ze(u, "class")).getOrDie("We must find this element or we cannot continue");
                            da(n, u),
                            Za(n),
                            r.on("close", c)
                        },
                        hide: function() {
                            t()
                        },
                        destroy: function() {
                            t()
                        },
                        reflow: function() {}
                    }
                }
            }), l = ln.fromDom(g.getBody()), d = (e = l,
            n = f.createDialog,
            r = L,
            i = Va((o = c).baseUrl),
            u = Ju(void 0 !== o.pasteBinAttrs ? o.pasteBinAttrs : {}),
            pd([Pp(), Op(i, n, o), Dp(o, r, e), Np(n, o, r, e), Ap(o)], Cp(n, o, r, u, e))), m = pd([kp()], Mp());
            $([d, m], function(t) {
                t.events.cancel.bind(function() {
                    S()
                }),
                t.events.error.bind(function(t) {
                    S(),
                    g.notificationManager ? g.notificationManager.open({
                        text: mn.translate(t.message()),
                        type: "error"
                    }) : (y ? zp : Ea).showDialog(g, mn.translate(t.message()))
                }),
                t.events.insert.bind(function(t) {
                    var e = q(t.elements(), function(t) {
                        return Gp.nodeToString(t.dom())
                    }).join("")
                      , n = Yp.restoreContentEditable(e);
                    g.focus(),
                    h.importImages(t.assets()).get(function() {
                        S(),
                        I(g, ug.process(g, n, t.isInternal()), t.assets()),
                        h.uploadImages(t.assets())
                    })
                })
            }),
            g.addCommand("mceInsertClipboardContent", function(t, e) {
                void 0 !== e.content ? d.pasteCustom(ld(e.content)) : void 0 !== e.text && m.pasteCustom(dd(e.text))
            });
            var p = Ra(l, "paste", function(t) {
                b || (b = g.selection.getBookmark(1)),
                (v.isText() ? m : d).paste(t.raw()),
                v.reset()
            });
            w.set(P.some(p)),
            Xp.register(g)
        }),
        g.on("remove", function(t) {
            1 === tinymce.editors.length && jp.removeStyles(),
            w.get().each(function(t) {
                return t.unbind()
            })
        })
    }
    var sg = function(t) {
        return tinymce.util.VK.metaKeyPressed(t) && 86 === t.keyCode && t.shiftKey
    };
    function fg(u) {
        return c(tinymce, "4.0.28") ? (e.error('The "powerpaste" plugin requires at least 4.0.28 version of TinyMCE.'),
        function() {}
        ) : function(n, t) {
            var e, r = !c(tinymce, "5.0.0"), o = function(e, n) {
                var r = nf(d(e))
                  , o = nf(!1);
                e.on("keydown", function(t) {
                    sg(t) && (o.set(!0),
                    tinymce.Env.ie && tinymce.Env.ie < 10 && (t.preventDefault(),
                    e.fire("paste", {})))
                });
                var i = function() {
                    var t = !r.get();
                    r.set(t),
                    e.fire("PastePlainTextToggle", {
                        state: t
                    }),
                    e.focus()
                };
                return {
                    buttonToggle: function(t) {
                        var e = !r.get();
                        n ? t.setActive(e) : this.active(e),
                        i()
                    },
                    toggle: i,
                    reset: function() {
                        o.set(!1)
                    },
                    isText: function() {
                        return o.get() || r.get()
                    }
                }
            }(n, r), i = function(e) {
                e.setActive(o.isText());
                var t = function(t) {
                    e.setActive(t.state)
                };
                return n.on("PastePlainTextToggle", t),
                function() {
                    return n.off("PastePlainTextToggle", t)
                }
            }, a = function() {
                var e = this;
                e.active(o.isText()),
                n.on("PastePlainTextToggle", function(t) {
                    e.active(t.state)
                })
            };
            tinymce.Env.ie && tinymce.Env.ie < 10 ? function(e, t, n) {
                var r, o, i = this, a = to(e, mn.translate, !1), u = function(e) {
                    return function(t) {
                        e(t)
                    }
                };
                r = _a.getOnPasteFunction(e, a.showDialog, t),
                e.on("paste", u(r)),
                o = _a.getOnKeyDownFunction(e, a.showDialog, t),
                e.on("keydown", u(o)),
                e.addCommand("mceInsertClipboardContent", function(t, e) {
                    a.showDialog(e.content || e)
                }),
                e.settings.paste_preprocess && e.on("PastePreProcess", function(t) {
                    e.settings.paste_preprocess.call(i, i, t)
                })
            }(n, o) : (e = Sa(n),
            cg(n, o, t, u, e, r),
            f(n) ? m(n) : eo(n, 0, 0, e, r)),
            ug.registerEvents(n),
            r ? (n.ui.registry.addToggleButton("pastetext", {
                icon: "paste-text",
                tooltip: "Paste as text",
                onAction: o.buttonToggle,
                onSetup: i
            }),
            n.ui.registry.addToggleMenuItem("pastetext", {
                icon: "paste-text",
                text: "Paste as text",
                selectable: !0,
                onAction: o.buttonToggle,
                onSetup: i
            })) : (n.addButton("pastetext", {
                icon: "pastetext",
                tooltip: "Paste as text",
                onclick: o.buttonToggle,
                onPostRender: a
            }),
            n.addMenuItem("pastetext", {
                text: "Paste as text",
                selectable: !0,
                onclick: o.buttonToggle,
                onPostRender: a
            })),
            s.register(n, o)
        }
    }
    return function(t) {
        tinymce.PluginManager.requireLangPack("powerpaste", "ar,ca,cs,da,de,el,es,fa,fi,fr_FR,he_IL,hr,hu_HU,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW"),
        tinymce.PluginManager.add("powerpaste", fg(t))
    }
}(window)();
