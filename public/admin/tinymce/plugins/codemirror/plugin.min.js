tinymce.PluginManager.requireLangPack("codemirror"),tinymce.PluginManager.add("codemirror",function(e,o){function r(){e.focus(),e.selection.collapse(!0),e.settings.codemirror.saveCursorPosition&&e.selection.setContent('<span style="display: none;" class="CmCaReT">&#x0;</span>'),codemirrorWidth=800,e.settings.codemirror.width&&(codemirrorWidth=e.settings.codemirror.width),codemirrorHeight=550,e.settings.codemirror.width&&(codemirrorHeight=e.settings.codemirror.height);var r={title:"HTML source code",url:o+"/source.html",width:codemirrorWidth,height:codemirrorHeight,resizable:!0,maximizable:!0,fullScreen:e.settings.codemirror.fullscreen,saveCursorPosition:!1,buttons:[{text:"Ok",type:"custom",name:"custom_ok",subtype:"primary"},{text:"Cancel",onclick:"close",type:"cancel"}],onAction:function(e,o){"custom_ok"===o.name&&(document.querySelectorAll(".tox-dialog__body-iframe iframe")[0].contentWindow.submit(),t.close())}},t=e.windowManager.openUrl(r);e.settings.codemirror.fullscreen&&t.fullscreen(!0)}e.ui.registry.addButton("code",{title:"Source code",icon:"sourcecode",onAction:r}),e.ui.registry.addMenuItem("code",{icon:"sourcecode",text:"Source code",context:"tools",onAction:r})});